"use strict";(self.webpackChunkmyadminhn=self.webpackChunkmyadminhn||[]).push([[4017],{4017:(V,g,d)=>{d.r(g),d.d(g,{ModulosModule:()=>j});var l=d(1180),y=d(7246),_=d(1380),c=d(805),D=d(7579),S=d(2722),x=d(4004),p=d(5698),e=d(4650),N=d(2340),F=d(529),h=d(629);let v=(()=>{class i{constructor(o,t,n){(0,l.Z)(this,"http",void 0),(0,l.Z)(this,"authS",void 0),(0,l.Z)(this,"router",void 0),(0,l.Z)(this,"_prefix",N.H+"/api/modulos"),this.http=o,this.authS=t,this.router=n}getAll(){return this.authS.refreshToken(),this.http.post(this._prefix+"/getall",{})}save(o){const t={...o,...this.authS.getUsuarioLog()};return this.http.post(this._prefix+"/save",t)}setSts(o){return this.http.post(this._prefix+"/setsts/"+o.modu_nid,{modu_nsts:o.modu_nsts,...this.authS.getUsuarioLog()})}setBulkSts(o){return this.http.post(this._prefix+"/setbullksts",{data:o,...this.authS.getUsuarioLog()})}}return(0,l.Z)(i,"\u0275fac",function(o){return new(o||i)(e.LFG(F.eN),e.LFG(h.e),e.LFG(_.F0))}),(0,l.Z)(i,"\u0275prov",e.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"})),i})();var f=d(1168),b=d(6895),m=d(99),k=d(3388),Z=d(5593),C=d(1795),w=d(2453),I=d(1383),T=d(1740),J=d(1493),a=d(4006);let U=(()=>{class i{constructor(o,t,n,s){(0,l.Z)(this,"dbapi",void 0),(0,l.Z)(this,"_builder",void 0),(0,l.Z)(this,"authS",void 0),(0,l.Z)(this,"skNsCore",void 0),(0,l.Z)(this,"createForm",void 0),(0,l.Z)(this,"monedas",[]),(0,l.Z)(this,"guardando",!1),(0,l.Z)(this,"itemDialog",!1),(0,l.Z)(this,"submitted",!1),(0,l.Z)(this,"modulo",{}),(0,l.Z)(this,"edit",new e.vpe),this.dbapi=o,this._builder=t,this.authS=n,this.skNsCore=s,this.createForm=t.group({modu_nid:[0],modu_vnombre:["",a.kI.required],modu_vdescripcion:["",a.kI.required],modu_nsts:[""]})}ngOnInit(){}ngOnChanges(){this.modulo&&this.modulo?.modu_nid&&this.modulo?.modu_nid>0&&(this.modu_nid?.setValue(this.modulo?.modu_nid),this.modu_vnombre?.setValue(this.modulo?.modu_vnombre),this.modu_vdescripcion?.setValue(this.modulo?.modu_vdescripcion))}save(){if(this.createForm.valid&&!this.guardando){this.guardando=!0;const o={modu_nid:this.modu_nid?.value>0?this.modu_nid?.value:null,modu_vnombre:this.modu_vnombre?.value.trim().toUpperCase(),modu_vdescripcion:this.modu_vdescripcion?.value.trim().toUpperCase(),modu_nsts:1};this.dbapi.save(o).pipe((0,p.q)(1)).subscribe({next:t=>{"success"==t.type&&(this.skNsCore.notificarUpsert("/admin/modulos",this.authS.isValidCia(!1).toString(),this.authS.usuario.user_nid.toString(),!0),this.limpiarForm()),this.guardando=!1,this.edit.emit(t)},error:t=>{console.log(t),this.guardando=!1,this.edit.emit({type:"error",title:"Ha ocurrido un error",message:t})}})}}limpiarForm(){this.createForm.reset(),this.modu_nid?.setValue(0)}hideDialog(){this.itemDialog=!1,this.submitted=!1}searchById(o,t){for(let n=0;n<t.length;n++){const s=t[n];if(s.id==o)return s}return""}get modu_nid(){return this.createForm.get("modu_nid")}get modu_vnombre(){return this.createForm.get("modu_vnombre")}get modu_vdescripcion(){return this.createForm.get("modu_vdescripcion")}get modu_nsts(){return this.createForm.get("modu_nsts")}}return(0,l.Z)(i,"\u0275fac",function(o){return new(o||i)(e.Y36(v),e.Y36(a.qu),e.Y36(h.e),e.Y36(f.pP))}),(0,l.Z)(i,"\u0275cmp",e.Xpm({type:i,selectors:[["app-create-modulos"]],inputs:{modulo:"modulo"},outputs:{edit:"edit"},features:[e.TTD],decls:20,vars:16,consts:[[1,"row"],[1,"col-12"],[1,"card"],[1,"form-horizontal",3,"formGroup","ngSubmit"],[1,"field","grid"],["htmlFor","name3",1,"col-12","mb-2","md:col-2","md:mb-0","text-900"],[1,"col-12","md:col-10"],["pInputText","","formControlName","modu_vnombre","type","text","required","",2,"text-transform","uppercase"],["pInputText","","formControlName","modu_vdescripcion","type","text","required","",2,"text-transform","uppercase"],[1,"col-5"],[1,"p-buttonset"],["pButton","","pRipple","","icon","pi pi-save","type","submit",1,"p-button-success","mr-1","btn-sm",3,"disabled","loading","label"],["pButton","","pRipple","","label","Limpiar","icon","pi pi-trash","type","button",1,"p-button-danger","btn-sm",3,"click"]],template:function(o,t){1&o&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"form",3),e.NdJ("ngSubmit",function(){return t.save()}),e.TgZ(4,"div",4)(5,"label",5),e._uU(6,"Nombre"),e.qZA(),e.TgZ(7,"div",6),e._UZ(8,"input",7),e.qZA()(),e.TgZ(9,"div",4)(10,"label",5),e._uU(11,"Descripci\xf3n"),e.qZA(),e.TgZ(12,"div",6),e._UZ(13,"input",8),e.qZA()(),e._UZ(14,"hr"),e.TgZ(15,"div",4)(16,"div",9)(17,"span",10),e._UZ(18,"button",11),e.TgZ(19,"button",12),e.NdJ("click",function(){return t.limpiarForm()}),e.qZA()()()()()()()()),2&o&&(e.xp6(3),e.Q6J("formGroup",t.createForm),e.xp6(5),e.ekj("ng-invalid",(null==t.modu_vnombre?null:t.modu_vnombre.invalid)&&(null==t.modu_vnombre?null:t.modu_vnombre.touched))("ng-dirty",(null==t.modu_vnombre?null:t.modu_vnombre.invalid)&&(null==t.modu_vnombre?null:t.modu_vnombre.touched))("ng-valid",(null==t.modu_vnombre?null:t.modu_vnombre.valid)&&((null==t.modu_vnombre?null:t.modu_vnombre.touched)||(null==t.modu_vnombre?null:t.modu_vnombre.dirty))),e.xp6(5),e.ekj("ng-invalid",(null==t.modu_vdescripcion?null:t.modu_vdescripcion.invalid)&&(null==t.modu_vdescripcion?null:t.modu_vdescripcion.touched))("ng-dirty",(null==t.modu_vdescripcion?null:t.modu_vdescripcion.invalid)&&(null==t.modu_vdescripcion?null:t.modu_vdescripcion.touched))("ng-valid",(null==t.modu_vdescripcion?null:t.modu_vdescripcion.valid)&&((null==t.modu_vdescripcion?null:t.modu_vdescripcion.touched)||(null==t.modu_vdescripcion?null:t.modu_vdescripcion.dirty))),e.xp6(5),e.Q6J("disabled",!t.createForm.valid)("loading",t.guardando)("label",t.modulo&&t.modulo.modu_nid?"Editar":"Guardar"))},dependencies:[a._Y,a.Fj,a.JJ,a.JL,a.Q7,a.sg,a.u,Z.Hq,C.H,T.o],styles:[".ng-valid[_ngcontent-%COMP%]{border-color:#2ecc71!important}"]})),i})();function q(i,r){1&i&&(e.TgZ(0,"div",22)(1,"h3",23),e._uU(2,"Listado de m\xf3dulos"),e.qZA()())}function E(i,r){if(1&i){const o=e.EpF();e._UZ(0,"p-fileUpload",24),e.TgZ(1,"button",25),e.NdJ("click",function(){e.CHM(o),e.oxw();const n=e.MAs(8);return e.KtG(n.exportCSV())}),e.qZA()}2&i&&e.Q6J("maxFileSize",1e6)}function H(i,r){if(1&i){const o=e.EpF();e.TgZ(0,"div",26)(1,"span",27)(2,"input",28),e.NdJ("input",function(n){e.CHM(o);const s=e.oxw(),u=e.MAs(8);return e.KtG(s.onGlobalFilter(u,n))}),e.qZA(),e.TgZ(3,"button",29),e.NdJ("click",function(){e.CHM(o);const n=e.oxw();return e.KtG(n.getData())}),e.qZA(),e.TgZ(4,"button",30),e.NdJ("click",function(){e.CHM(o);const n=e.oxw();return e.KtG(n.openNew())}),e.qZA(),e.TgZ(5,"button",31),e.NdJ("click",function(){e.CHM(o);const n=e.oxw();return e.KtG(n.deleteSelectedItems())}),e.qZA()()()}if(2&i){const o=e.oxw();e.xp6(5),e.Q6J("disabled",!o.selectedData||!o.selectedData.length)}}function G(i,r){if(1&i&&(e.TgZ(0,"th",34),e._uU(1),e._UZ(2,"p-sortIcon",35),e.qZA()),2&i){const o=r.$implicit;e.ekj("rowStyle","ID"!==o.header)("rowStyleId","ID"===o.header),e.Q6J("pSortableColumn",o.field),e.xp6(1),e.hij(" ",o.header," "),e.xp6(1),e.Q6J("field",o.field)}}function Y(i,r){if(1&i&&(e.TgZ(0,"tr")(1,"th",32),e._UZ(2,"p-tableHeaderCheckbox"),e.qZA(),e.TgZ(3,"th"),e._uU(4,"Acciones"),e.qZA(),e.YNc(5,G,3,7,"th",33),e.qZA()),2&i){const o=e.oxw();e.xp6(5),e.Q6J("ngForOf",o.cols)}}function B(i,r){if(1&i&&(e.TgZ(0,"td")(1,"span",41),e._uU(2),e.qZA(),e._uU(3),e.qZA()),2&i){const o=r.$implicit,t=e.oxw().$implicit;e.xp6(2),e.Oqu(o.header),e.xp6(1),e.hij(" ",t[o.field]," ")}}function O(i,r){if(1&i){const o=e.EpF();e.TgZ(0,"tr")(1,"td"),e._UZ(2,"p-tableCheckbox",36),e.qZA(),e.TgZ(3,"td")(4,"div",37)(5,"button",38),e.NdJ("click",function(){const s=e.CHM(o).$implicit,u=e.oxw();return e.KtG(u.editRow(s))}),e.qZA(),e.TgZ(6,"button",39),e.NdJ("click",function(){const s=e.CHM(o).$implicit,u=e.oxw();return e.KtG(u.deleteRow(s))}),e.qZA()()(),e.YNc(7,B,4,2,"td",40),e.qZA()}if(2&i){const o=r.$implicit,t=e.oxw();e.xp6(2),e.Q6J("value",o),e.xp6(5),e.Q6J("ngForOf",t.cols)}}function R(i,r){if(1&i&&(e.TgZ(0,"span"),e._uU(1,"Estas seguro que quieres eliminar "),e.TgZ(2,"b"),e._uU(3),e.qZA(),e._uU(4,"?"),e.qZA()),2&i){const o=e.oxw();e.xp6(3),e.Oqu(o.item.modu_vnombre)}}function Q(i,r){if(1&i){const o=e.EpF();e.TgZ(0,"button",42),e.NdJ("click",function(){e.CHM(o);const n=e.oxw();return e.KtG(n.deleteItemDialog=!1)}),e.qZA(),e.TgZ(1,"button",43),e.NdJ("click",function(){e.CHM(o);const n=e.oxw();return e.KtG(n.confirmDelete())}),e.qZA()}}function L(i,r){if(1&i){const o=e.EpF();e.TgZ(0,"button",42),e.NdJ("click",function(){e.CHM(o);const n=e.oxw();return e.KtG(n.deleteItemsDialog=!1)}),e.qZA(),e.TgZ(1,"button",43),e.NdJ("click",function(){e.CHM(o);const n=e.oxw();return e.KtG(n.confirmDeleteSelected())}),e.qZA()}}const P=function(){return[10,20,30]},A=function(){return{width:"750px"}},M=function(){return{width:"450px"}},K=[{path:"",component:(()=>{class i{constructor(o,t,n,s){(0,l.Z)(this,"dbapi",void 0),(0,l.Z)(this,"messageService",void 0),(0,l.Z)(this,"authS",void 0),(0,l.Z)(this,"skNsCore",void 0),(0,l.Z)(this,"createDialog",!1),(0,l.Z)(this,"editDialog",!1),(0,l.Z)(this,"deleteItemDialog",!1),(0,l.Z)(this,"deleteItemsDialog",!1),(0,l.Z)(this,"isLoadingTable",!1),(0,l.Z)(this,"data",[]),(0,l.Z)(this,"item",{}),(0,l.Z)(this,"selectedData",[]),(0,l.Z)(this,"submitted",!1),(0,l.Z)(this,"cols",[]),(0,l.Z)(this,"statuses",[]),(0,l.Z)(this,"rowsPerPageOptions",[5,10,20]),(0,l.Z)(this,"$destroy",new D.x),this.dbapi=o,this.messageService=t,this.authS=n,this.skNsCore=s,s.fromEvent("/admin/modulos").pipe((0,S.R)(this.$destroy)).subscribe(u=>{this.skNsCore.socketId!=u&&(console.log("Event socket: tipos pagos"),this.getData())}),this.cols=[{field:"modu_nid",header:"ID"},{field:"modu_vnombre",header:"Nombre"},{field:"modu_vdescripcion",header:"Descripci\xf3n"},{field:"modu_vsts",header:"Estado"}],this.getData()}getData(){this.isLoadingTable=!0,this.dbapi.getAll().pipe((0,x.U)(o=>(o.forEach(t=>{t.modu_vsts=1==t.modu_nsts?"ACTIVO":"ELIMINADO"}),o)),(0,p.q)(1)).subscribe({next:o=>{this.data=[...o],this.isLoadingTable=!1},error:o=>{console.log(o),this.isLoadingTable=!1,this.editEvent({type:"error",title:"Ha ocurrido un error",message:o})}})}ngOnInit(){}openNew(){this.item={},this.submitted=!1,this.createDialog=!0}deleteSelectedData(){this.deleteItemsDialog=!0}editRow(o){this.item={...o},this.editDialog=!0}deleteRow(o){this.deleteItemDialog=!0,this.item={...o}}confirmDeleteSelected(){const o=[];this.selectedData.forEach(t=>{o.push({modu_nid:t.modu_nid,modu_nsts:0})}),this.dbapi.setBulkSts(o).pipe((0,p.q)(1)).subscribe({next:t=>{this.messageService.add({severity:t.type,summary:t.title,detail:t.message,life:3e3}),"success"==t.type&&(this.skNsCore.notificarUpsert("/admin/modulos",this.authS.isValidCia(!1).toString(),this.authS.usuario.user_nid.toString(),!0),this.deleteItemsDialog=!1,this.selectedData=[],this.getData())},error:t=>{console.log(t),this.editEvent({type:"error",title:"Ha ocurrido un error",message:t})}})}confirmDelete(){this.dbapi.setSts({modu_nid:this.item.modu_nid,modu_nsts:0}).pipe((0,p.q)(1)).subscribe({next:t=>{this.skNsCore.notificarUpsert("/admin/modulos",this.authS.isValidCia(!1).toString(),this.authS.usuario.user_nid.toString(),!0),this.messageService.add({severity:t.type,summary:t.title,detail:t.message,life:3e3}),this.deleteItemDialog=!1,this.item={},this.getData()},error:t=>{console.log(t),this.editEvent({type:"error",title:"Ha ocurrido un error",message:t})}})}findIndexById(o){let t=-1;for(let n=0;n<this.data.length;n++)if(this.data[n].modu_nid===o){t=n;break}return t}onGlobalFilter(o,t){o.filterGlobal(t.target.value,"contains")}deleteSelectedItems(){this.deleteItemsDialog=!0}editEvent(o){this.messageService.add({severity:o.type,summary:o.title,detail:o.message,life:3e3}),"success"==o.type&&(this.getData(),this.createDialog=!1,this.editDialog=!1)}ngOnDestroy(){this.$destroy.next(),this.$destroy.complete()}}return(0,l.Z)(i,"\u0275fac",function(o){return new(o||i)(e.Y36(v),e.Y36(c.ez),e.Y36(h.e),e.Y36(f.pP))}),(0,l.Z)(i,"\u0275cmp",e.Xpm({type:i,selectors:[["ng-component"]],features:[e._Bn([c.ez])],decls:27,vars:34,consts:[[1,"grid"],[1,"col-12"],[1,"card","px-6","py-6"],["position","bottom-right"],["styleClass","mb-4"],["pTemplate","left"],["pTemplate","right"],["responsiveLayout","scroll","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries","selectionMode","multiple","dataKey","modu_nid",3,"value","columns","rows","globalFilterFields","paginator","loading","rowsPerPageOptions","showCurrentPageReport","selection","rowHover","selectionChange"],["dt",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["header","Crear modulo",1,"p-fluid",3,"visible","modal","visibleChange"],[3,"edit"],["header","Editar modulo",1,"p-fluid",3,"visible","modal","visibleChange"],[3,"modulo","edit"],["header","Confirmar...",3,"visible","modal","visibleChange"],[1,"flex","align-items-center","justify-content-center"],[1,"pi","pi-exclamation-triangle","mr-3",2,"font-size","2rem"],[4,"ngIf"],["pTemplate","footer"],["header","Confirmar",3,"visible","modal","visibleChange"],[1,"my-2"],[1,"mb-2"],["mode","basic","accept","image/*","label","Import","chooseLabel","Import",1,"mr-2","inline-block",3,"maxFileSize"],["pButton","","pRipple","","label","Export","icon","pi pi-upload",1,"p-button-help",3,"click"],[1,"flex","flex-column","md:flex-row","md:justify-content-between","md:align-items-center"],[1,"block","mt-2","md:mt-0","p-input-icon-rigth"],["pInputText","","type","text","placeholder","Buscar...",1,"w-full","sm:w-auto","mr-1",3,"input"],["pButton","","pRipple","","label","","icon","pi pi-sync",1,"p-button-secondary","mr-1","ml-1",3,"click"],["pButton","","pRipple","","label","Crear","icon","pi pi-plus",1,"p-button-success","mr-1","ml-1",3,"click"],["pButton","","pRipple","","label","Eliminar","icon","pi pi-trash",1,"p-button-danger","mr-1","ml-1",3,"disabled","click"],[2,"width","3rem"],["style","width: 100rem",3,"pSortableColumn","rowStyle","rowStyleId",4,"ngFor","ngForOf"],[2,"width","100rem",3,"pSortableColumn"],[3,"field"],[3,"value"],[1,"flex"],["pButton","","pRipple","","icon","pi pi-pencil",1,"p-button-success","mr-1",3,"click"],["pButton","","pRipple","","icon","pi pi-trash",1,"p-button-danger",3,"click"],[4,"ngFor","ngForOf"],[1,"p-column-title"],["pButton","","pRipple","","icon","pi pi-times","label","No",1,"p-button-outlined","p-button-secondary",3,"click"],["pButton","","pRipple","","icon","pi pi-check","label","Si",1,"p-button-outlined","p-button-danger",3,"click"]],template:function(o,t){1&o&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e._UZ(3,"p-toast",3),e.TgZ(4,"p-toolbar",4),e.YNc(5,q,3,0,"ng-template",5),e.YNc(6,E,2,1,"ng-template",6),e.qZA(),e.TgZ(7,"p-table",7,8),e.NdJ("selectionChange",function(s){return t.selectedData=s}),e.YNc(9,H,6,1,"ng-template",9),e.YNc(10,Y,6,1,"ng-template",10),e.YNc(11,O,8,2,"ng-template",11),e.qZA()(),e.TgZ(12,"p-dialog",12),e.NdJ("visibleChange",function(s){return t.createDialog=s}),e.TgZ(13,"app-create-modulos",13),e.NdJ("edit",function(s){return t.editEvent(s)}),e.qZA()(),e.TgZ(14,"p-dialog",14),e.NdJ("visibleChange",function(s){return t.editDialog=s}),e.TgZ(15,"app-create-modulos",15),e.NdJ("edit",function(s){return t.editEvent(s)}),e.qZA()(),e.TgZ(16,"p-dialog",16),e.NdJ("visibleChange",function(s){return t.deleteItemDialog=s}),e.TgZ(17,"div",17),e._UZ(18,"i",18),e.YNc(19,R,5,1,"span",19),e.qZA(),e.YNc(20,Q,2,0,"ng-template",20),e.qZA(),e.TgZ(21,"p-dialog",21),e.NdJ("visibleChange",function(s){return t.deleteItemsDialog=s}),e.TgZ(22,"div",17),e._UZ(23,"i",18),e.TgZ(24,"span"),e._uU(25,"\xbfEst\xe1 seguro de que desea eliminar los elementos seleccionados?"),e.qZA()(),e.YNc(26,L,2,0,"ng-template",20),e.qZA()()()),2&o&&(e.xp6(7),e.Q6J("value",t.data)("columns",t.cols)("rows",10)("globalFilterFields",t.cols)("rows",10)("paginator",!0)("loading",t.isLoadingTable)("rowsPerPageOptions",e.DdM(29,P))("showCurrentPageReport",!0)("selection",t.selectedData)("rowHover",!0),e.xp6(5),e.Akn(e.DdM(30,A)),e.Q6J("visible",t.createDialog)("modal",!0),e.xp6(2),e.Akn(e.DdM(31,A)),e.Q6J("visible",t.editDialog)("modal",!0),e.xp6(1),e.Q6J("modulo",t.item),e.xp6(1),e.Akn(e.DdM(32,M)),e.Q6J("visible",t.deleteItemDialog)("modal",!0),e.xp6(3),e.Q6J("ngIf",t.item),e.xp6(2),e.Akn(e.DdM(33,M)),e.Q6J("visible",t.deleteItemsDialog)("modal",!0))},dependencies:[b.sg,b.O5,m.iA,c.jx,m.lQ,m.fz,m.UA,m.Mo,k.p,Z.Hq,C.H,w.FN,I.o,T.o,J.V,U],styles:[".rowStyle[_ngcontent-%COMP%]{width:14%;min-width:10rem}.rowStyleId[_ngcontent-%COMP%]{width:10%;min-width:6rem}"]})),i})()}];let j=(()=>{class i{}return(0,l.Z)(i,"\u0275fac",function(o){return new(o||i)}),(0,l.Z)(i,"\u0275mod",e.oAB({type:i})),(0,l.Z)(i,"\u0275inj",e.cJS({imports:[y.m,_.Bz.forChild(K)]})),i})()}}]);