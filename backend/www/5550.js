"use strict";(self.webpackChunkmyadminhn=self.webpackChunkmyadminhn||[]).push([[5550],{5550:(Ue,w,u)=>{u.r(w),u.d(w,{UsuarioModule:()=>Te});var n=u(1180),x=u(7246),k=u(1380),m=u(805),y=u(7579),A=u(2722),T=u(4004),c=u(5698),e=u(4650),S=u(2340),D=u(529),C=u(629);let _=(()=>{class o{constructor(t,i,s){(0,n.Z)(this,"http",void 0),(0,n.Z)(this,"authS",void 0),(0,n.Z)(this,"router",void 0),(0,n.Z)(this,"_prefix",S.H+"/api/usuarios"),this.http=t,this.authS=i,this.router=s}getAll(t=[1,2]){return this.authS.refreshToken(),this.http.post(this._prefix+"/getall",{user_nsts:t})}save(t){const i={...t,...this.authS.getUsuarioLog()};return this.http.post(this._prefix+"/save",i)}setSts(t){return this.http.post(this._prefix+"/setsts/"+t.user_nid,{user_nsts:t.user_nsts,...this.authS.getUsuarioLog()})}setBulkSts(t){return this.http.post(this._prefix+"/setbullksts",{data:t,...this.authS.getUsuarioLog()})}changePassword(t,i){const s={...i,...this.authS.getUsuarioLog()};return this.http.post(this._prefix+"/changepassword/"+t.toString(),s)}getMonedas(){return this.http.post(this._prefix+"/getallmonedas",{})}getAsigUsuarioAcceso(t){return this.http.post(this._prefix+"/asigusuariosaccesos/getall/"+t,{})}saveAsigUsuarioAcceso(t,i){const s={asig:i,...this.authS.getUsuarioLog()};return this.http.post(this._prefix+"/asigusuariosaccesos/save/"+t,s)}getAccesos(){return this.authS.refreshToken(),this.http.post(this._prefix+"/getallaccesos",{})}getEmpleados(){const t={cia_nids:this.authS.isValidCia(!1)};return this.http.post(this._prefix+"/getallempleados",t)}getAsigUsuarioCia(t){return this.http.post(this._prefix+"/asigusuarioscias/getall/"+t,{})}saveAsigUsuarioCia(t,i){const s={asig:i,...this.authS.getUsuarioLog()};return this.http.post(this._prefix+"/asigusuarioscias/save/"+t,s)}getCias(){return this.authS.refreshToken(),this.http.post(this._prefix+"/getallcias",{})}}return(0,n.Z)(o,"\u0275fac",function(t){return new(t||o)(e.LFG(D.eN),e.LFG(C.e),e.LFG(k.F0))}),(0,n.Z)(o,"\u0275prov",e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"})),o})();var U=u(1168),g=u(6895),l=u(433),d=u(99),J=u(3388),h=u(5593),N=u(5362),f=u(1795),I=u(2453),F=u(1383),v=u(1740),q=u(1493),M=u(2210);let E=(()=>{class o{constructor(t,i,s,a){(0,n.Z)(this,"dbapi",void 0),(0,n.Z)(this,"_builder",void 0),(0,n.Z)(this,"authS",void 0),(0,n.Z)(this,"skNsCore",void 0),(0,n.Z)(this,"createForm",void 0),(0,n.Z)(this,"tiempos",[]),(0,n.Z)(this,"empleados",[]),(0,n.Z)(this,"guardando",!1),(0,n.Z)(this,"itemDialog",!1),(0,n.Z)(this,"submitted",!1),(0,n.Z)(this,"$destroy",new y.x),(0,n.Z)(this,"usuario",{}),(0,n.Z)(this,"edit",new e.vpe),this.dbapi=t,this._builder=i,this.authS=s,this.skNsCore=a,this.createForm=i.group({user_nid:[0],user_vmail:["",l.kI.required],user_vtelefono:["",l.kI.required],user_vpass:[""],emp_nid:[""],user_vtiemposesion:["",l.kI.required],user_nsts:[""]}),this.tiempos=[{id:"",text:"...",obj:{}},{id:"30m",text:"30 minutos",obj:{}},{id:"1h",text:"1 hora",obj:{}},{id:"2h",text:"2 horas",obj:{}},{id:"6h",text:"6 horas",obj:{}},{id:"12h",text:"12 horas",obj:{}},{id:"24h",text:"24 horas",obj:{}}],s.\u00f8bserverCompanySelected.pipe((0,A.R)(this.$destroy)).subscribe(p=>{this.emp_nid?.setValue(""),this.getEmpleados()}),a.fromEvent("/rrhh/empleados+"+this.authS.isValidCia(!1).toString()).pipe((0,A.R)(this.$destroy)).subscribe(p=>{this.skNsCore.socketId!=p&&(console.log("Event socket: empleados"),this.getEmpleados())})}ngOnInit(){}ngOnChanges(){this.usuario&&this.usuario?.user_nid&&this.usuario?.user_nid>0&&(this.user_nid?.setValue(this.usuario?.user_nid),this.user_vmail?.setValue(this.usuario?.user_vmail),this.user_vtelefono?.setValue(this.usuario?.user_vtelefono),this.user_vpass?.setValue(this.usuario?.user_vpass),this.user_vtiemposesion?.setValue(this.usuario?.user_vtiemposesion),this.emp_nid?.setValue(this.searchById(this.usuario?.emp_nid,this.tiempos)),this.user_vtiemposesion?.setValue(this.searchById(this.usuario?.user_vtiemposesion,this.tiempos)))}getEmpleados(){this.empleados=[{id:"0",text:"...",obj:{}}],this.dbapi.getEmpleados().pipe((0,c.q)(1)).subscribe({next:t=>{if(t&&null!=t&&""!==t){console.log(t);for(const i in t)this.empleados=[...this.empleados,{id:t[i].emp_nid,text:t[i].emp_videntidad+" - "+t[i].emp_vnombre+" "+t[i].emp_vapellido,obj:t[i]}];1==this.empleados.length&&this.emp_nid?.setValue(this.empleados[0])}else console.log("Error consultando empleados")},error:t=>{console.log(t),this.edit.emit({type:"error",title:"Ha ocurrido un error",message:t})}})}save(){if(this.createForm.valid&&!this.guardando){this.guardando=!0;const t={user_nid:this.user_nid?.value>0?this.user_nid?.value:null,user_vmail:this.user_vmail?.value.trim().toLowerCase(),user_vtelefono:this.user_vtelefono?.value.toString().trim(),user_vpass:"",emp_nid:this.emp_nid?.value.id>0?this.emp_nid?.value.id:0,user_vtiemposesion:this.user_vtiemposesion?.value.id,user_nsts:this.usuario&&this.usuario?.user_nid?this.usuario?.user_nsts:2};this.dbapi.save(t).pipe((0,c.q)(1)).subscribe({next:i=>{"success"==i.type&&(this.skNsCore.notificarUpsert("/admin/usuarios",this.authS.isValidCia(!1).toString(),this.authS.usuario.user_nid.toString()),this.limpiarForm()),this.guardando=!1,this.edit.emit(i)},error:i=>{console.log(i),this.guardando=!1,this.edit.emit({type:"error",title:"Ha ocurrido un error",message:i})}})}}limpiarForm(){this.createForm.reset(),this.user_nid?.setValue(0)}hideDialog(){this.itemDialog=!1,this.submitted=!1}searchById(t,i){for(let s=0;s<i.length;s++){const a=i[s];if(a.id==t)return a}return""}ngOnDestroy(){this.$destroy.next(),this.$destroy.complete()}get user_nid(){return this.createForm.get("user_nid")}get user_vmail(){return this.createForm.get("user_vmail")}get user_vtelefono(){return this.createForm.get("user_vtelefono")}get user_vpass(){return this.createForm.get("user_vpass")}get emp_nid(){return this.createForm.get("emp_nid")}get user_vtiemposesion(){return this.createForm.get("user_vtiemposesion")}get user_nsts(){return this.createForm.get("user_nsts")}}return(0,n.Z)(o,"\u0275fac",function(t){return new(t||o)(e.Y36(_),e.Y36(l.qu),e.Y36(C.e),e.Y36(U.pP))}),(0,n.Z)(o,"\u0275cmp",e.Xpm({type:o,selectors:[["app-create-usuario"]],inputs:{usuario:"usuario"},outputs:{edit:"edit"},features:[e.TTD],decls:31,vars:36,consts:[[1,"row"],[1,"col-12"],[1,"card","pt-3","pb-3"],[1,"form-horizontal",3,"formGroup","ngSubmit"],[1,"field","grid"],["htmlFor","name3",1,"col-12","mb-2","md:col-2","md:mb-0","text-900"],[1,"col-12","md:col-10"],["pInputText","","formControlName","user_vmail","type","text","required","",2,"text-transform","lowercase"],["pInputText","","formControlName","user_vtelefono","type","number","required",""],["optionLabel","text","formControlName","emp_nid","filterBy","text",3,"options","filter","virtualScroll","virtualScrollItemSize"],["optionLabel","text","formControlName","user_vtiemposesion","filterBy","text",3,"options","filter","virtualScroll","virtualScrollItemSize"],[1,"col-5"],[1,"p-buttonset"],["pButton","","pRipple","","icon","pi pi-save","type","submit",1,"p-button-success","mr-1","btn-sm",3,"disabled","loading","label"],["pButton","","pRipple","","label","Limpiar","icon","pi pi-trash","type","button",1,"p-button-danger","btn-sm",3,"click"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"form",3),e.NdJ("ngSubmit",function(){return i.save()}),e.TgZ(4,"div",4)(5,"label",5),e._uU(6,"Correo electr\xf3nico"),e.qZA(),e.TgZ(7,"div",6),e._UZ(8,"input",7),e.qZA()(),e.TgZ(9,"div",4)(10,"label",5),e._uU(11,"Tel\xe9fono"),e.qZA(),e.TgZ(12,"div",6),e._UZ(13,"input",8),e.qZA()(),e.TgZ(14,"div",4)(15,"label",5),e._uU(16,"Empleado"),e.qZA(),e.TgZ(17,"div",6),e._UZ(18,"p-dropdown",9),e.qZA()(),e.TgZ(19,"div",4)(20,"label",5),e._uU(21,"Tiempo de sesi\xf3n"),e.qZA(),e.TgZ(22,"div",6),e._UZ(23,"p-dropdown",10),e.qZA()(),e._UZ(24,"hr")(25,"br"),e.TgZ(26,"div",4)(27,"div",11)(28,"span",12),e._UZ(29,"button",13),e.TgZ(30,"button",14),e.NdJ("click",function(){return i.limpiarForm()}),e.qZA()()()()()()()()),2&t&&(e.xp6(3),e.Q6J("formGroup",i.createForm),e.xp6(5),e.ekj("ng-invalid",(null==i.user_vmail?null:i.user_vmail.invalid)&&(null==i.user_vmail?null:i.user_vmail.touched))("ng-dirty",(null==i.user_vmail?null:i.user_vmail.invalid)&&(null==i.user_vmail?null:i.user_vmail.touched))("ng-valid",(null==i.user_vmail?null:i.user_vmail.valid)&&((null==i.user_vmail?null:i.user_vmail.touched)||(null==i.user_vmail?null:i.user_vmail.dirty))),e.xp6(5),e.ekj("ng-invalid",(null==i.user_vtelefono?null:i.user_vtelefono.invalid)&&(null==i.user_vtelefono?null:i.user_vtelefono.touched))("ng-dirty",(null==i.user_vtelefono?null:i.user_vtelefono.invalid)&&(null==i.user_vtelefono?null:i.user_vtelefono.touched))("ng-valid",(null==i.user_vtelefono?null:i.user_vtelefono.valid)&&((null==i.user_vtelefono?null:i.user_vtelefono.touched)||(null==i.user_vtelefono?null:i.user_vtelefono.dirty))),e.xp6(5),e.ekj("ng-invalid",(null==i.emp_nid?null:i.emp_nid.invalid)&&(null==i.emp_nid?null:i.emp_nid.touched))("ng-dirty",(null==i.emp_nid?null:i.emp_nid.invalid)&&(null==i.emp_nid?null:i.emp_nid.touched))("ng-valid",(null==i.emp_nid?null:i.emp_nid.valid)&&((null==i.emp_nid?null:i.emp_nid.touched)||(null==i.emp_nid?null:i.emp_nid.dirty))),e.Q6J("options",i.empleados)("filter",!0)("virtualScroll",i.empleados.length>5)("virtualScrollItemSize",38),e.xp6(5),e.ekj("ng-invalid",(null==i.user_vtiemposesion?null:i.user_vtiemposesion.invalid)&&(null==i.user_vtiemposesion?null:i.user_vtiemposesion.touched))("ng-dirty",(null==i.user_vtiemposesion?null:i.user_vtiemposesion.invalid)&&(null==i.user_vtiemposesion?null:i.user_vtiemposesion.touched))("ng-valid",(null==i.user_vtiemposesion?null:i.user_vtiemposesion.valid)&&((null==i.user_vtiemposesion?null:i.user_vtiemposesion.touched)||(null==i.user_vtiemposesion?null:i.user_vtiemposesion.dirty))),e.Q6J("options",i.tiempos)("filter",!1)("virtualScroll",i.tiempos.length>5)("virtualScrollItemSize",38),e.xp6(6),e.Q6J("disabled",!i.createForm.valid)("loading",i.guardando)("label",i.usuario&&i.usuario.user_nid?"Editar":"Guardar"))},dependencies:[l._Y,l.Fj,l.wV,l.JJ,l.JL,l.Q7,l.sg,l.u,h.Hq,f.H,v.o,M.Lt],styles:[".ng-valid[_ngcontent-%COMP%]{border-color:#2ecc71!important}"]})),o})(),H=(()=>{class o{constructor(t,i,s,a){(0,n.Z)(this,"dbapi",void 0),(0,n.Z)(this,"_builder",void 0),(0,n.Z)(this,"authS",void 0),(0,n.Z)(this,"skNsCore",void 0),(0,n.Z)(this,"createForm",void 0),(0,n.Z)(this,"tiempos",[]),(0,n.Z)(this,"guardando",!1),(0,n.Z)(this,"itemDialog",!1),(0,n.Z)(this,"submitted",!1),(0,n.Z)(this,"usuario",{}),(0,n.Z)(this,"edit",new e.vpe),this.dbapi=t,this._builder=i,this.authS=s,this.skNsCore=a,this.createForm=i.group({user_nid:["",l.kI.required],user_vmail:["",l.kI.required],user_vpass:["",l.kI.required]})}ngOnInit(){}ngOnChanges(){this.usuario&&this.usuario?.user_nid&&this.usuario?.user_nid>0&&(this.user_nid?.setValue(this.usuario?.user_nid),this.user_vmail?.setValue(this.usuario?.user_vmail),this.user_vpass?.setValue(""))}save(){this.createForm.valid&&!this.guardando&&(this.guardando=!0,this.dbapi.changePassword(this.user_nid?.value,{user_vpass:this.user_vpass?.value,user_nsts:2}).pipe((0,c.q)(1)).subscribe({next:i=>{"success"==i.type&&(this.skNsCore.notificarUpsert("/admin/usuarios",this.authS.isValidCia(!1).toString(),this.authS.usuario.user_nid.toString()),this.limpiarForm()),this.guardando=!1,this.edit.emit(i)},error:i=>{console.log(i),this.guardando=!1,this.edit.emit({type:"error",title:"Ha ocurrido un error",message:i})}}))}limpiarForm(){this.createForm.reset(),this.user_nid?.setValue(0)}hideDialog(){this.itemDialog=!1,this.submitted=!1}searchById(t,i){for(let s=0;s<i.length;s++){const a=i[s];if(a.id==t)return a}return""}get user_nid(){return this.createForm.get("user_nid")}get user_vmail(){return this.createForm.get("user_vmail")}get user_vpass(){return this.createForm.get("user_vpass")}get user_nsts(){return this.createForm.get("user_nsts")}}return(0,n.Z)(o,"\u0275fac",function(t){return new(t||o)(e.Y36(_),e.Y36(l.qu),e.Y36(C.e),e.Y36(U.pP))}),(0,n.Z)(o,"\u0275cmp",e.Xpm({type:o,selectors:[["app-cambiar-contrasena-usuario"]],inputs:{usuario:"usuario"},outputs:{edit:"edit"},features:[e.TTD],decls:20,vars:16,consts:[[1,"row"],[1,"col-12"],[1,"card"],[1,"form-horizontal",3,"formGroup","ngSubmit"],[1,"field","grid"],["htmlFor","name3",1,"col-12","mb-2","md:col-2","md:mb-0"],[1,"col-12","md:col-10"],["pInputText","","formControlName","user_vmail","type","text","readonly","",1,"form-control",2,"text-transform","lowercase"],["pInputText","","formControlName","user_vpass","type","password","required","",1,"form-control"],[1,"col-5"],[1,"p-buttonset"],["pButton","","pRipple","","icon","pi pi-save","type","submit",1,"p-button-success","mr-1","btn-sm",3,"disabled","loading","label"],["pButton","","pRipple","","label","Limpiar","icon","pi pi-trash","type","button",1,"p-button-danger","btn-sm",3,"click"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"form",3),e.NdJ("ngSubmit",function(){return i.save()}),e.TgZ(4,"div",4)(5,"label",5),e._uU(6,"Correo electr\xf3nico"),e.qZA(),e.TgZ(7,"div",6),e._UZ(8,"input",7),e.qZA()(),e.TgZ(9,"div",4)(10,"label",5),e._uU(11,"Contrase\xf1a"),e.qZA(),e.TgZ(12,"div",6),e._UZ(13,"input",8),e.qZA()(),e._UZ(14,"hr"),e.TgZ(15,"div",4)(16,"div",9)(17,"span",10),e._UZ(18,"button",11),e.TgZ(19,"button",12),e.NdJ("click",function(){return i.limpiarForm()}),e.qZA()()()()()()()()),2&t&&(e.xp6(3),e.Q6J("formGroup",i.createForm),e.xp6(5),e.ekj("ng-invalid",(null==i.user_vmail?null:i.user_vmail.invalid)&&(null==i.user_vmail?null:i.user_vmail.touched))("ng-dirty",(null==i.user_vmail?null:i.user_vmail.invalid)&&(null==i.user_vmail?null:i.user_vmail.touched))("ng-valid",(null==i.user_vmail?null:i.user_vmail.valid)&&((null==i.user_vmail?null:i.user_vmail.touched)||(null==i.user_vmail?null:i.user_vmail.dirty))),e.xp6(5),e.ekj("ng-invalid",(null==i.user_vpass?null:i.user_vpass.invalid)&&(null==i.user_vpass?null:i.user_vpass.touched))("ng-dirty",(null==i.user_vpass?null:i.user_vpass.invalid)&&(null==i.user_vpass?null:i.user_vpass.touched))("ng-valid",(null==i.user_vpass?null:i.user_vpass.valid)&&((null==i.user_vpass?null:i.user_vpass.touched)||(null==i.user_vpass?null:i.user_vpass.dirty))),e.xp6(5),e.Q6J("disabled",!i.createForm.valid)("loading",i.guardando)("label",i.usuario&&i.usuario.user_nid?"Editar":"Guardar"))},dependencies:[l._Y,l.Fj,l.JJ,l.JL,l.Q7,l.sg,l.u,h.Hq,f.H,v.o],styles:[".ng-valid[_ngcontent-%COMP%]{border-color:#2ecc71!important}"]})),o})();function R(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"div",12)(1,"span",13)(2,"input",14),e.NdJ("input",function(s){e.CHM(t);const a=e.oxw(),p=e.MAs(4);return e.KtG(a.onGlobalFilter(p,s))}),e.qZA(),e.TgZ(3,"button",15),e.NdJ("click",function(s){e.CHM(t);const a=e.oxw();return e.KtG(a.cambiarBtn(s,1))}),e.qZA(),e.TgZ(4,"button",16),e.NdJ("click",function(s){e.CHM(t);const a=e.oxw();return e.KtG(a.cambiarBtn(s,0))}),e.qZA(),e.TgZ(5,"button",17),e.NdJ("click",function(s){e.CHM(t);const a=e.oxw();return e.KtG(a.cambiarBtn(s,-1))}),e.qZA(),e.TgZ(6,"button",18),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.getCias())}),e.qZA()()()}}function B(o,r){if(1&o&&(e.TgZ(0,"th",22),e._uU(1),e._UZ(2,"p-sortIcon",20),e.qZA()),2&o){const t=r.$implicit;e.ekj("rowStyle","ID"!==t.header)("rowStyleId","ID"===t.header),e.Q6J("pSortableColumn",t.field),e.xp6(1),e.hij(" ",t.header," "),e.xp6(1),e.Q6J("field",t.field)}}function Q(o,r){if(1&o&&(e.TgZ(0,"tr")(1,"th",19),e._uU(2," CHK "),e._UZ(3,"p-sortIcon",20),e.qZA(),e.YNc(4,B,3,7,"th",21),e.TgZ(5,"th",19),e._uU(6," Principal "),e._UZ(7,"p-sortIcon",20),e.qZA()()),2&o){const t=e.oxw();e.xp6(3),e.Q6J("field","checked"),e.xp6(1),e.Q6J("ngForOf",t.cols),e.xp6(3),e.Q6J("field","usecia_npricipal")}}function G(o,r){if(1&o&&(e.TgZ(0,"td")(1,"span",28),e._uU(2),e.qZA(),e._uU(3),e.qZA()),2&o){const t=r.$implicit,i=e.oxw().$implicit;e.xp6(2),e.Oqu(t.header),e.xp6(1),e.hij(" ",i[t.field]," ")}}function O(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"tr")(1,"td")(2,"div",23)(3,"label")(4,"input",24),e.NdJ("ngModelChange",function(s){const p=e.CHM(t).$implicit;return e.KtG(p.checked=s)}),e.qZA(),e._UZ(5,"span",25),e.qZA()()(),e.YNc(6,G,4,2,"td",26),e.TgZ(7,"td")(8,"div",23)(9,"label")(10,"input",27),e.NdJ("ngModelChange",function(s){const p=e.CHM(t).$implicit;return e.KtG(p.usecia_npricipal=s)})("change",function(){const a=e.CHM(t).$implicit,p=e.oxw();return e.KtG(p.setPrincipal(a))}),e.qZA(),e._UZ(11,"span",25),e.qZA()()()()}if(2&o){const t=r.$implicit,i=e.oxw();e.xp6(4),e.Q6J("ngModel",t.checked),e.xp6(2),e.Q6J("ngForOf",i.cols),e.xp6(4),e.Q6J("ngModel",t.usecia_npricipal)}}const P=function(){return[10,20,30]};let Y=(()=>{class o{constructor(t){(0,n.Z)(this,"dbapi",void 0),(0,n.Z)(this,"guardando",!1),(0,n.Z)(this,"isLoadingTable",!1),(0,n.Z)(this,"selectedData",[]),(0,n.Z)(this,"data",[]),(0,n.Z)(this,"cols",[]),(0,n.Z)(this,"usuario",{}),(0,n.Z)(this,"edit",new e.vpe),this.dbapi=t,this.cols=[{field:"cia_nid",header:"ID"},{field:"cia_vnombre",header:"Nombre"},{field:"cia_vtelefono",header:"Tel\xe9fono"},{field:"cia_vcorreo",header:"Correo"}],this.getCias()}getCias(){this.isLoadingTable=!0,this.dbapi.getCias().pipe((0,T.U)(t=>(t.forEach(i=>{i.checked=!1,i["x.usecia_npricipal"]=!1}),t)),(0,c.q)(1)).subscribe({next:t=>{this.data=[...t],this.getAsigUsuarioCia(),this.isLoadingTable=!1},error:t=>{console.log(t),this.isLoadingTable=!1,this.edit.emit({type:"error",title:"Ha ocurrido un error",message:t})}})}ngOnInit(){}findIndexById(t){let i=-1;for(let s=0;s<this.data.length;s++)if(this.data[s].user_nid===t){i=s;break}return i}onGlobalFilter(t,i){t.filterGlobal(i.target.value,"contains")}cambiarBtn(t,i){t&&t.preventDefault(),i=1*i||0,this.data.forEach(s=>{s.checked=-1==i?!s.checked:1==i})}ngOnChanges(){this.getAsigUsuarioCia()}getAsigUsuarioCia(){this.usuario&&this.usuario?.user_nid&&this.usuario?.user_nid>0&&(this.data.forEach(t=>{t.checked=!1}),this.dbapi.getAsigUsuarioCia(this.usuario.user_nid).pipe((0,c.q)(1)).subscribe({next:t=>{this.data.forEach(i=>{i.usecia_npricipal=!1,t.forEach(s=>{i.cia_nid===s.cia_nid&&(i.checked=!0,i.usecia_npricipal=s.usecia_npricipal>0)})})},error:t=>{console.log(t),this.edit.emit({type:"error",title:"Ha ocurrido un error",message:t})}}))}saveAsignacion(){const t=[],i=this.usuario.user_nid?this.usuario.user_nid:0;this.data.forEach(s=>{s.checked&&t.push({user_nid:i,cia_nid:s.cia_nid,usecia_npricipal:s.usecia_npricipal?1:0})}),this.dbapi.saveAsigUsuarioCia(i,t).pipe((0,c.q)(1)).subscribe({next:s=>{this.edit.emit(s)},error:s=>{console.log(s),this.edit.emit({type:"error",title:"Ha ocurrido un error",message:s})}})}setPrincipal(t){for(let i=0;i<this.data.length;i++)this.data[i].cia_nid!=t.cia_nid&&(this.data[i].usecia_npricipal=!1)}}return(0,n.Z)(o,"\u0275fac",function(t){return new(t||o)(e.Y36(_))}),(0,n.Z)(o,"\u0275cmp",e.Xpm({type:o,selectors:[["app-asig-cias-usuarios"]],inputs:{usuario:"usuario"},outputs:{edit:"edit"},features:[e.TTD],decls:13,vars:14,consts:[[1,"grid"],[1,"col-12"],[1,"card","px-6","py-6"],["responsiveLayout","scroll","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries","selectionMode","multiple","dataKey","cia_nid",3,"value","columns","rows","globalFilterFields","paginator","loading","rowsPerPageOptions","showCurrentPageReport","selection","rowHover","selectionChange"],["dt",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],[1,"field","grid"],[1,"col-3"],[1,"p-buttonset"],["pButton","","pRipple","","icon","pi pi-save","type","button",1,"p-button-success","mr-1","btn-sm",3,"loading","label","click"],[1,"flex","flex-column","md:flex-row","md:justify-content-between","md:align-items-center"],[1,"block","mt-2","md:mt-0","p-input-icon-rigth"],["pInputText","","type","text","placeholder","Buscar...",1,"w-full","sm:w-auto","mr-1",3,"input"],["pButton","","pRipple","","title","Todos","icon","pi pi-check",1,"p-button-primary","ml-1",3,"click"],["pButton","","pRipple","","title","Ninguno","icon","pi pi-times",1,"p-button-primary",3,"click"],["pButton","","pRipple","","title","Invertir","icon","pi pi-circle",1,"p-button-primary",3,"click"],["pButton","","pRipple","","title","Recargar","icon","pi pi-sync",1,"p-button-secondary","ml-1",3,"click"],[2,"width","3rem"],[3,"field"],["style","width: 100rem",3,"pSortableColumn","rowStyle","rowStyleId",4,"ngFor","ngForOf"],[2,"width","100rem",3,"pSortableColumn"],[1,"checkbox","c-checkbox"],["type","checkbox",3,"ngModel","ngModelChange"],[1,"fa","fa-check"],[4,"ngFor","ngForOf"],["type","checkbox",3,"ngModel","ngModelChange","change"],[1,"p-column-title"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"p-table",3,4),e.NdJ("selectionChange",function(a){return i.selectedData=a}),e.YNc(5,R,7,0,"ng-template",5),e.YNc(6,Q,8,3,"ng-template",6),e.YNc(7,O,12,3,"ng-template",7),e.qZA(),e._UZ(8,"hr"),e.TgZ(9,"div",8)(10,"div",9)(11,"span",10)(12,"button",11),e.NdJ("click",function(){return i.saveAsignacion()}),e.qZA()()()()()()()),2&t&&(e.xp6(3),e.Q6J("value",i.data)("columns",i.cols)("rows",10)("globalFilterFields",i.cols)("rows",10)("paginator",!0)("loading",i.isLoadingTable)("rowsPerPageOptions",e.DdM(13,P))("showCurrentPageReport",!0)("selection",i.selectedData)("rowHover",!0),e.xp6(9),e.Q6J("loading",i.guardando)("label","Guardar"))},dependencies:[g.sg,l.Wl,l.JJ,l.On,d.iA,m.jx,d.lQ,d.fz,h.Hq,f.H,v.o],styles:[".rowStyle[_ngcontent-%COMP%]{width:14%;min-width:10rem}.rowStyleId[_ngcontent-%COMP%]{width:10%;min-width:6rem}"]})),o})();function K(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"div",12)(1,"span",13)(2,"input",14),e.NdJ("input",function(s){e.CHM(t);const a=e.oxw(),p=e.MAs(4);return e.KtG(a.onGlobalFilter(p,s))}),e.qZA(),e.TgZ(3,"button",15),e.NdJ("click",function(s){e.CHM(t);const a=e.oxw();return e.KtG(a.cambiarBtn(s,1))}),e.qZA(),e.TgZ(4,"button",16),e.NdJ("click",function(s){e.CHM(t);const a=e.oxw();return e.KtG(a.cambiarBtn(s,0))}),e.qZA(),e.TgZ(5,"button",17),e.NdJ("click",function(s){e.CHM(t);const a=e.oxw();return e.KtG(a.cambiarBtn(s,-1))}),e.qZA(),e.TgZ(6,"button",18),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.getAccesos())}),e.qZA()()()}}function L(o,r){if(1&o&&(e.TgZ(0,"th",22),e._uU(1),e._UZ(2,"p-sortIcon",20),e.qZA()),2&o){const t=r.$implicit;e.ekj("rowStyle","ID"!==t.header)("rowStyleId","ID"===t.header),e.Q6J("pSortableColumn",t.field),e.xp6(1),e.hij(" ",t.header," "),e.xp6(1),e.Q6J("field",t.field)}}function V(o,r){if(1&o&&(e.TgZ(0,"tr")(1,"th",19),e._uU(2," CHK "),e._UZ(3,"p-sortIcon",20),e.qZA(),e.YNc(4,L,3,7,"th",21),e.qZA()),2&o){const t=e.oxw();e.xp6(3),e.Q6J("field","checked"),e.xp6(1),e.Q6J("ngForOf",t.cols)}}function j(o,r){if(1&o&&(e.TgZ(0,"td")(1,"span",27),e._uU(2),e.qZA(),e._uU(3),e.qZA()),2&o){const t=r.$implicit,i=e.oxw().$implicit;e.xp6(2),e.Oqu(t.header),e.xp6(1),e.hij(" ",i[t.field]," ")}}function $(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"tr")(1,"td")(2,"div",23)(3,"label")(4,"input",24),e.NdJ("ngModelChange",function(s){const p=e.CHM(t).$implicit;return e.KtG(p.checked=s)}),e.qZA(),e._UZ(5,"span",25),e.qZA()()(),e.YNc(6,j,4,2,"td",26),e.qZA()}if(2&o){const t=r.$implicit,i=e.oxw();e.xp6(4),e.Q6J("ngModel",t.checked),e.xp6(2),e.Q6J("ngForOf",i.cols)}}const z=function(){return[10,20,30]};let X=(()=>{class o{constructor(t){(0,n.Z)(this,"dbapi",void 0),(0,n.Z)(this,"guardando",!1),(0,n.Z)(this,"isLoadingTable",!1),(0,n.Z)(this,"selectedData",[]),(0,n.Z)(this,"data",[]),(0,n.Z)(this,"cols",[]),(0,n.Z)(this,"usuario",{}),(0,n.Z)(this,"edit",new e.vpe),this.dbapi=t,this.cols=[{field:"acce_nid",header:"ID"},{field:"acce_vnombre",header:"Nombre"},{field:"acce_vdescripcion",header:"Descripci\xf3n"},{field:"modu_vnombre",header:"Modulo"},{field:"acce_vclave",header:"Clave"}],this.getAccesos()}getAccesos(){this.isLoadingTable=!0,this.dbapi.getAccesos().pipe((0,T.U)(t=>(t.forEach(i=>{i.checked=!1}),t)),(0,c.q)(1)).subscribe({next:t=>{this.data=[...t],this.getAsigUsuarioAcceso(),this.isLoadingTable=!1},error:t=>{console.log(t),this.isLoadingTable=!1,this.edit.emit({type:"error",title:"Ha ocurrido un error",message:t})}})}ngOnInit(){}findIndexById(t){let i=-1;for(let s=0;s<this.data.length;s++)if(this.data[s].user_nid===t){i=s;break}return i}onGlobalFilter(t,i){t.filterGlobal(i.target.value,"contains")}cambiarBtn(t,i){t&&t.preventDefault(),i=1*i||0,this.data.forEach(s=>{s.checked=-1==i?!s.checked:1==i})}ngOnChanges(){this.getAsigUsuarioAcceso()}getAsigUsuarioAcceso(){this.usuario&&this.usuario?.user_nid&&this.usuario?.user_nid>0&&(this.data.forEach(t=>{t.checked=!1}),this.dbapi.getAsigUsuarioAcceso(this.usuario.user_nid).pipe((0,c.q)(1)).subscribe({next:t=>{this.data.forEach(i=>{t.forEach(s=>{i.acce_nid===s.acce_nid&&(i.checked=!0)})})},error:t=>{console.log(t),this.edit.emit({type:"error",title:"Ha ocurrido un error",message:t})}}))}saveAsignacion(){const t=[],i=this.usuario.user_nid?this.usuario.user_nid:0;this.data.forEach(s=>{s.checked&&t.push({user_nid:i,acce_nid:s.acce_nid})}),this.dbapi.saveAsigUsuarioAcceso(i,t).pipe((0,c.q)(1)).subscribe({next:s=>{this.edit.emit(s)},error:s=>{console.log(s),this.guardando=!1,this.edit.emit({type:"error",title:"Ha ocurrido un error",message:s})}})}}return(0,n.Z)(o,"\u0275fac",function(t){return new(t||o)(e.Y36(_))}),(0,n.Z)(o,"\u0275cmp",e.Xpm({type:o,selectors:[["app-asig-accesos-usuarios"]],inputs:{usuario:"usuario"},outputs:{edit:"edit"},features:[e.TTD],decls:13,vars:14,consts:[[1,"grid"],[1,"col-12"],[1,"card","px-6","py-6"],["responsiveLayout","scroll","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries","selectionMode","multiple","dataKey","acce_nid",3,"value","columns","rows","globalFilterFields","paginator","loading","rowsPerPageOptions","showCurrentPageReport","selection","rowHover","selectionChange"],["dt",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],[1,"field","grid"],[1,"col-3"],[1,"p-buttonset"],["pButton","","pRipple","","icon","pi pi-save","type","button",1,"p-button-success","mr-1","btn-sm",3,"loading","label","click"],[1,"flex","flex-column","md:flex-row","md:justify-content-between","md:align-items-center"],[1,"block","mt-2","md:mt-0","p-input-icon-rigth"],["pInputText","","type","text","placeholder","Buscar...",1,"w-full","sm:w-auto","mr-1",3,"input"],["pButton","","pRipple","","title","Todos","icon","pi pi-check",1,"p-button-primary","ml-1",3,"click"],["pButton","","pRipple","","title","Ninguno","icon","pi pi-times",1,"p-button-primary",3,"click"],["pButton","","pRipple","","title","Invertir","icon","pi pi-circle",1,"p-button-primary",3,"click"],["pButton","","pRipple","","title","Recargar","icon","pi pi-sync",1,"p-button-secondary","ml-1",3,"click"],[2,"width","3rem"],[3,"field"],["style","width: 100rem",3,"pSortableColumn","rowStyle","rowStyleId",4,"ngFor","ngForOf"],[2,"width","100rem",3,"pSortableColumn"],[1,"checkbox","c-checkbox"],["type","checkbox","name","nada",3,"ngModel","ngModelChange"],[1,"fa","fa-check"],[4,"ngFor","ngForOf"],[1,"p-column-title"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"p-table",3,4),e.NdJ("selectionChange",function(a){return i.selectedData=a}),e.YNc(5,K,7,0,"ng-template",5),e.YNc(6,V,5,2,"ng-template",6),e.YNc(7,$,7,2,"ng-template",7),e.qZA(),e._UZ(8,"hr"),e.TgZ(9,"div",8)(10,"div",9)(11,"span",10)(12,"button",11),e.NdJ("click",function(){return i.saveAsignacion()}),e.qZA()()()()()()()),2&t&&(e.xp6(3),e.Q6J("value",i.data)("columns",i.cols)("rows",10)("globalFilterFields",i.cols)("rows",10)("paginator",!0)("loading",i.isLoadingTable)("rowsPerPageOptions",e.DdM(13,z))("showCurrentPageReport",!0)("selection",i.selectedData)("rowHover",!0),e.xp6(9),e.Q6J("loading",i.guardando)("label","Guardar"))},dependencies:[g.sg,l.Wl,l.JJ,l.On,d.iA,m.jx,d.lQ,d.fz,h.Hq,f.H,v.o],styles:[".rowStyle[_ngcontent-%COMP%]{width:14%;min-width:10rem}.rowStyleId[_ngcontent-%COMP%]{width:10%;min-width:6rem}"]})),o})();function W(o,r){1&o&&(e.TgZ(0,"div",25)(1,"h3",26),e._uU(2,"Listado de usuarios"),e.qZA()())}function ee(o,r){if(1&o){const t=e.EpF();e._UZ(0,"p-fileUpload",27),e.TgZ(1,"button",28),e.NdJ("click",function(){e.CHM(t),e.oxw();const s=e.MAs(8);return e.KtG(s.exportCSV())}),e.qZA()}2&o&&e.Q6J("maxFileSize",1e6)}function te(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"button",37),e.NdJ("click",function(){e.CHM(t);const s=e.oxw(2);return e.KtG(s.deleteSelectedItems())}),e.qZA()}if(2&o){const t=e.oxw(2);e.Q6J("disabled",!t.selectedData||!t.selectedData.length)}}function ie(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"button",38),e.NdJ("click",function(){e.CHM(t);const s=e.oxw(2);return e.KtG(s.restartSelectedItems())}),e.qZA()}if(2&o){const t=e.oxw(2);e.Q6J("disabled",!t.selectedData||!t.selectedData.length)}}const se=function(){return{float:"right"}};function oe(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"div",29)(1,"span",30)(2,"input",31),e.NdJ("input",function(s){e.CHM(t);const a=e.oxw(),p=e.MAs(8);return e.KtG(a.onGlobalFilter(p,s))}),e.qZA(),e.TgZ(3,"button",32),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.getData())}),e.qZA(),e.TgZ(4,"button",33),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.openNew())}),e.qZA(),e.YNc(5,te,1,1,"button",34),e.YNc(6,ie,1,1,"button",35),e.TgZ(7,"p-selectButton",36),e.NdJ("ngModelChange",function(s){e.CHM(t);const a=e.oxw();return e.KtG(a.dataValue=s)})("click",function(){e.CHM(t);const s=e.oxw();return s.getData(),e.KtG(s.clearDataSelected())}),e.qZA()()()}if(2&o){const t=e.oxw();e.xp6(5),e.Q6J("ngIf",t.dataValue&&t.dataValue[0]>0),e.xp6(1),e.Q6J("ngIf",t.dataValue&&0===t.dataValue[0]),e.xp6(1),e.Q6J("options",t.dataOptions)("ngModel",t.dataValue)("ngStyle",e.DdM(5,se))}}function ne(o,r){if(1&o&&(e.TgZ(0,"th",41),e._uU(1),e._UZ(2,"p-sortIcon",42),e.qZA()),2&o){const t=r.$implicit;e.ekj("rowStyle","ID"!==t.header)("rowStyleId","ID"===t.header),e.Q6J("pSortableColumn",t.field),e.xp6(1),e.hij(" ",t.header," "),e.xp6(1),e.Q6J("field",t.field)}}function ae(o,r){if(1&o&&(e.TgZ(0,"tr")(1,"th",39),e._UZ(2,"p-tableHeaderCheckbox"),e.qZA(),e.TgZ(3,"th"),e._uU(4,"Acciones"),e.qZA(),e.YNc(5,ne,3,7,"th",40),e.qZA()),2&o){const t=e.oxw();e.xp6(5),e.Q6J("ngForOf",t.cols)}}function re(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"button",52),e.NdJ("click",function(){e.CHM(t);const s=e.oxw().$implicit,a=e.oxw();return e.KtG(a.editRow(s))}),e.qZA()}}function le(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"button",53),e.NdJ("click",function(){e.CHM(t);const s=e.oxw().$implicit,a=e.oxw();return e.KtG(a.asignacionCias(s))}),e.qZA()}}function ue(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"button",54),e.NdJ("click",function(){e.CHM(t);const s=e.oxw().$implicit,a=e.oxw();return e.KtG(a.asignacionAccesos(s))}),e.qZA()}}function pe(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"button",55),e.NdJ("click",function(){e.CHM(t);const s=e.oxw().$implicit,a=e.oxw();return e.KtG(a.changePasswordRow(s))}),e.qZA()}}function ce(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"button",56),e.NdJ("click",function(){e.CHM(t);const s=e.oxw().$implicit,a=e.oxw();return e.KtG(a.deleteRow(s))}),e.qZA()}}function de(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"button",57),e.NdJ("click",function(){e.CHM(t);const s=e.oxw().$implicit,a=e.oxw();return e.KtG(a.restartRow(s))}),e.qZA()}}function me(o,r){if(1&o&&(e.TgZ(0,"td")(1,"span",58),e._uU(2),e.qZA(),e._uU(3),e.qZA()),2&o){const t=r.$implicit,i=e.oxw().$implicit;e.xp6(2),e.Oqu(t.header),e.xp6(1),e.hij(" ",i[t.field]," ")}}function _e(o,r){if(1&o&&(e.TgZ(0,"tr")(1,"td"),e._UZ(2,"p-tableCheckbox",43),e.qZA(),e.TgZ(3,"td")(4,"div",44),e.YNc(5,re,1,0,"button",45),e.YNc(6,le,1,0,"button",46),e.YNc(7,ue,1,0,"button",47),e.YNc(8,pe,1,0,"button",48),e.YNc(9,ce,1,0,"button",49),e.YNc(10,de,1,0,"button",50),e.qZA()(),e.YNc(11,me,4,2,"td",51),e.qZA()),2&o){const t=r.$implicit,i=e.oxw();e.xp6(2),e.Q6J("value",t),e.xp6(3),e.Q6J("ngIf",t.user_nsts>0),e.xp6(1),e.Q6J("ngIf",t.user_nsts>0),e.xp6(1),e.Q6J("ngIf",t.user_nsts>0),e.xp6(1),e.Q6J("ngIf",t.user_nsts>0),e.xp6(1),e.Q6J("ngIf",t.user_nsts>0),e.xp6(1),e.Q6J("ngIf",t.user_nsts<1),e.xp6(1),e.Q6J("ngForOf",i.cols)}}function ge(o,r){if(1&o&&(e.TgZ(0,"span"),e._uU(1,"Estas seguro que quieres eliminar "),e.TgZ(2,"b"),e._uU(3),e.qZA(),e._uU(4,"?"),e.qZA()),2&o){const t=e.oxw();e.xp6(3),e.Oqu(t.item.user_vmail)}}function he(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"button",59),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.deleteItemDialog=!1)}),e.qZA(),e.TgZ(1,"button",60),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.confirmDelete())}),e.qZA()}}function fe(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"button",59),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.deleteItemsDialog=!1)}),e.qZA(),e.TgZ(1,"button",60),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.confirmDeleteSelected())}),e.qZA()}}function ve(o,r){if(1&o&&(e.TgZ(0,"span"),e._uU(1,"Estas seguro que quieres restaurar "),e.TgZ(2,"b"),e._uU(3),e.qZA(),e._uU(4,"?"),e.qZA()),2&o){const t=e.oxw();e.xp6(3),e.Oqu(t.item.user_vmail)}}function be(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"button",59),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.restartItemDialog=!1)}),e.qZA(),e.TgZ(1,"button",61),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.confirmRestart())}),e.qZA()}}function Ce(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"button",59),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.restartItemsDialog=!1)}),e.qZA(),e.TgZ(1,"button",61),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.confirmRestartSelected())}),e.qZA()}}const Ze=function(){return[10,20,30]},b=function(){return{width:"750px"}},Z=function(){return{width:"450px"}},Ae=[{path:"",component:(()=>{class o{constructor(t,i,s,a){(0,n.Z)(this,"dbapi",void 0),(0,n.Z)(this,"messageService",void 0),(0,n.Z)(this,"authS",void 0),(0,n.Z)(this,"skNsCore",void 0),(0,n.Z)(this,"createDialog",!1),(0,n.Z)(this,"editDialog",!1),(0,n.Z)(this,"changePasswordDialog",!1),(0,n.Z)(this,"deleteItemDialog",!1),(0,n.Z)(this,"deleteItemsDialog",!1),(0,n.Z)(this,"restartItemDialog",!1),(0,n.Z)(this,"restartItemsDialog",!1),(0,n.Z)(this,"asigAccesosDialog",!1),(0,n.Z)(this,"asigCiasDialog",!1),(0,n.Z)(this,"isLoadingTable",!1),(0,n.Z)(this,"data",[]),(0,n.Z)(this,"item",{}),(0,n.Z)(this,"itemChangePass",{}),(0,n.Z)(this,"itemAsigAccesos",{}),(0,n.Z)(this,"itemAsigCias",{}),(0,n.Z)(this,"selectedData",[]),(0,n.Z)(this,"dataOptions",[]),(0,n.Z)(this,"dataValue",[1]),(0,n.Z)(this,"submitted",!1),(0,n.Z)(this,"cols",[]),(0,n.Z)(this,"statuses",[]),(0,n.Z)(this,"rowsPerPageOptions",[5,10,20]),(0,n.Z)(this,"$destroy",new y.x),this.dbapi=t,this.messageService=i,this.authS=s,this.skNsCore=a,a.fromEvent("/admin/usuarios+"+this.authS.isValidCia(!1).toString()).pipe((0,A.R)(this.$destroy)).subscribe(p=>{this.skNsCore.socketId!=p&&(console.log("Event socket: clientes"),this.getData())}),this.getData(),this.cols=[{field:"user_nid",header:"ID"},{field:"user_vmail",header:"Correo"},{field:"user_vtelefono",header:"Tel\xe9fono"},{field:"user_vtiemposesion",header:"Tiempo sesi\xf3n"},{field:"user_vsts",header:"Estado"}],this.dataOptions=[{name:"ACTIVOS",value:[1]},{name:"PENDIENTES",value:[2]},{name:"ELIMINADOS",value:[0]},{name:"TODOS",value:[-1,0,1,2]}]}getData(){this.isLoadingTable=!0,this.dbapi.getAll(this.dataValue).pipe((0,T.U)(t=>(t.forEach(i=>{i.user_vsts=1==i.user_nsts?"ACTIVO":2==i.user_nsts?"PENDIENTE":"ELIMINADO"}),t)),(0,c.q)(1)).subscribe({next:t=>{this.data=[...t],this.isLoadingTable=!1},error:t=>{console.log(t),this.isLoadingTable=!1,this.editEvent({type:"error",title:"Ha ocurrido un error",message:t})}})}ngOnInit(){}asignacionAccesos(t){this.itemAsigAccesos={...t},this.asigAccesosDialog=!0}asignacionCias(t){this.itemAsigCias={...t},this.asigCiasDialog=!0}openNew(){this.item={},this.submitted=!1,this.createDialog=!0}deleteSelectedData(){this.deleteItemsDialog=!0}editRow(t){this.item={...t},this.editDialog=!0}changePasswordRow(t){this.itemChangePass={...t},this.changePasswordDialog=!0}deleteRow(t){this.deleteItemDialog=!0,this.item={...t}}restartRow(t){this.restartItemDialog=!0,this.item={...t}}confirmDeleteSelected(){this.selectedData.forEach(t=>{t.user_nsts=0}),this.item.user_nsts=0,this.dbapi.setBulkSts(this.selectedData).pipe((0,c.q)(1)).subscribe({next:t=>{this.messageService.add({severity:t.type,summary:t.title,detail:t.message,life:3e3}),"success"==t.type&&(this.skNsCore.notificarUpsert("/admin/usuarios",this.authS.isValidCia(!1).toString(),this.authS.usuario.user_nid.toString()),this.deleteItemsDialog=!1,this.selectedData=[],this.getData())},error:t=>{console.log(t),this.editEvent({type:"error",title:"Ha ocurrido un error",message:t})}})}confirmDelete(){this.item.user_nsts=0,this.dbapi.setSts(this.item).pipe((0,c.q)(1)).subscribe({next:t=>{this.skNsCore.notificarUpsert("/admin/usuarios",this.authS.isValidCia(!1).toString(),this.authS.usuario.user_nid.toString()),this.messageService.add({severity:t.type,summary:t.title,detail:t.message,life:3e3}),this.deleteItemDialog=!1,this.item={},this.getData()},error:t=>{console.log(t),this.editEvent({type:"error",title:"Ha ocurrido un error",message:t})}})}confirmRestart(){this.item.user_nsts=2,this.dbapi.setSts(this.item).pipe((0,c.q)(1)).subscribe({next:t=>{this.skNsCore.notificarUpsert("/admin/usuarios",this.authS.isValidCia(!1).toString(),this.authS.usuario.user_nid.toString()),this.messageService.add({severity:t.type,summary:t.title,detail:t.message,life:3e3}),this.restartItemDialog=!1,this.item={},this.getData()},error:t=>{console.log(t),this.editEvent({type:"error",title:"Ha ocurrido un error",message:t})}})}confirmRestartSelected(){this.selectedData.forEach(t=>{t.user_nsts=2}),this.item.user_nsts=2,this.dbapi.setBulkSts(this.selectedData).pipe((0,c.q)(1)).subscribe({next:t=>{this.messageService.add({severity:t.type,summary:t.title,detail:t.message,life:3e3}),"success"==t.type&&(this.skNsCore.notificarUpsert("/admin/usuarios",this.authS.isValidCia(!1).toString(),this.authS.usuario.user_nid.toString()),this.restartItemsDialog=!1,this.selectedData=[],this.getData())},error:t=>{console.log(t),this.editEvent({type:"error",title:"Ha ocurrido un error",message:t})}})}findIndexById(t){let i=-1;for(let s=0;s<this.data.length;s++)if(this.data[s].user_nid===t){i=s;break}return i}onGlobalFilter(t,i){t.filterGlobal(i.target.value,"contains")}deleteSelectedItems(){this.deleteItemsDialog=!0}restartSelectedItems(){this.restartItemsDialog=!0}editEvent(t){this.messageService.add({severity:t.type,summary:t.title,detail:t.message,life:3e3}),"success"==t.type&&(this.getData(),this.createDialog=!1,this.editDialog=!1,this.changePasswordDialog=!1,this.asigAccesosDialog=!1,this.asigCiasDialog=!1)}clearDataSelected(){this.selectedData=[]}ngOnDestroy(){this.$destroy.next(),this.$destroy.complete()}}return(0,n.Z)(o,"\u0275fac",function(t){return new(t||o)(e.Y36(_),e.Y36(m.ez),e.Y36(C.e),e.Y36(U.pP))}),(0,n.Z)(o,"\u0275cmp",e.Xpm({type:o,selectors:[["ng-component"]],features:[e._Bn([m.ez])],decls:44,vars:63,consts:[[1,"grid"],[1,"col-12"],[1,"card","px-6","py-6"],["position","bottom-right"],["styleClass","mb-4"],["pTemplate","left"],["pTemplate","right"],["responsiveLayout","scroll","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries","selectionMode","multiple","dataKey","user_nid",3,"value","columns","rows","globalFilterFields","paginator","loading","rowsPerPageOptions","showCurrentPageReport","selection","rowHover","selectionChange"],["dt",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["header","Crear usuario",1,"p-fluid",3,"visible","modal","visibleChange"],[3,"edit"],["header","Editar usuario",1,"p-fluid",3,"visible","modal","visibleChange"],[3,"usuario","edit"],["header","Cambiar contrase\xf1a",1,"p-fluid",3,"visible","modal","visibleChange"],["header","Asignar compa\xf1\xedas",1,"p-fluid",3,"visible","modal","visibleChange"],["header","Asignar accesos",1,"p-fluid",3,"visible","modal","visibleChange"],["header","Confirmar...",3,"visible","modal","visibleChange"],[1,"flex","align-items-center","justify-content-center"],[1,"pi","pi-exclamation-triangle","mr-3",2,"font-size","2rem"],[4,"ngIf"],["pTemplate","footer"],["header","Confirmar",3,"visible","modal","visibleChange"],[1,"my-2"],[1,"mb-2"],["mode","basic","accept","image/*","label","Import","chooseLabel","Import",1,"mr-2","inline-block",3,"maxFileSize"],["pButton","","pRipple","","label","Export","icon","pi pi-upload",1,"p-button-help",3,"click"],[1,"flex","flex-column","md:flex-row","md:justify-content-between","md:align-items-center"],[1,"block","mt-2","md:mt-0","p-input-icon-rigth"],["pInputText","","type","text","placeholder","Buscar...",1,"w-full","sm:w-auto","mr-1","mt-1",3,"input"],["pButton","","pRipple","","label","","icon","pi pi-sync",1,"p-button-secondary","mr-1","ml-1","mt-1",3,"click"],["pButton","","pRipple","","label","Crear","icon","pi pi-plus",1,"p-button-success","mr-1","ml-1","mt-1",3,"click"],["pButton","","pRipple","","label","Eliminar","icon","pi pi-trash","class","p-button-danger mr-1 ml-1 mt-1",3,"disabled","click",4,"ngIf"],["pButton","","pRipple","","label","Restaurar","icon","pi pi-replay","class","p-button-help mr-1 ml-1 mt-1",3,"disabled","click",4,"ngIf"],["optionLabel","name","optionValue","value",1,"ml-3","mt-1",3,"options","ngModel","ngStyle","ngModelChange","click"],["pButton","","pRipple","","label","Eliminar","icon","pi pi-trash",1,"p-button-danger","mr-1","ml-1","mt-1",3,"disabled","click"],["pButton","","pRipple","","label","Restaurar","icon","pi pi-replay",1,"p-button-help","mr-1","ml-1","mt-1",3,"disabled","click"],[2,"width","3rem"],[3,"pSortableColumn","rowStyle","rowStyleId",4,"ngFor","ngForOf"],[3,"pSortableColumn"],[3,"field"],[3,"value"],[1,"flex"],["pButton","","pRipple","","icon","pi pi-pencil","title","Editar","class","p-button-success mr-1",3,"click",4,"ngIf"],["pButton","","title","Asignar compa\xf1\xedas","pRipple","","icon","pi pi-building","class","p-button-info mr-1",3,"click",4,"ngIf"],["pButton","","title","Asignar accesos","pRipple","","icon","pi pi-lock","class","p-button-green mr-1",3,"click",4,"ngIf"],["pButton","","pRipple","","icon","pi pi-user-edit","title","Cambiar contrase\xf1a","class","p-button-warning mr-1",3,"click",4,"ngIf"],["pButton","","pRipple","","icon","pi pi-trash","title","Eliminar","class","p-button-danger",3,"click",4,"ngIf"],["pButton","","pRipple","","icon","pi pi-replay","title","Restaurar","class","p-button-help",3,"click",4,"ngIf"],[4,"ngFor","ngForOf"],["pButton","","pRipple","","icon","pi pi-pencil","title","Editar",1,"p-button-success","mr-1",3,"click"],["pButton","","title","Asignar compa\xf1\xedas","pRipple","","icon","pi pi-building",1,"p-button-info","mr-1",3,"click"],["pButton","","title","Asignar accesos","pRipple","","icon","pi pi-lock",1,"p-button-green","mr-1",3,"click"],["pButton","","pRipple","","icon","pi pi-user-edit","title","Cambiar contrase\xf1a",1,"p-button-warning","mr-1",3,"click"],["pButton","","pRipple","","icon","pi pi-trash","title","Eliminar",1,"p-button-danger",3,"click"],["pButton","","pRipple","","icon","pi pi-replay","title","Restaurar",1,"p-button-help",3,"click"],[1,"p-column-title"],["pButton","","pRipple","","icon","pi pi-times","label","No",1,"p-button-outlined","p-button-secondary",3,"click"],["pButton","","pRipple","","icon","pi pi-check","label","Si",1,"p-button-outlined","p-button-danger",3,"click"],["pButton","","pRipple","","icon","pi pi-check","label","Si",1,"p-button-outlined","p-button-help",3,"click"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e._UZ(3,"p-toast",3),e.TgZ(4,"p-toolbar",4),e.YNc(5,W,3,0,"ng-template",5),e.YNc(6,ee,2,1,"ng-template",6),e.qZA(),e.TgZ(7,"p-table",7,8),e.NdJ("selectionChange",function(a){return i.selectedData=a}),e.YNc(9,oe,8,6,"ng-template",9),e.YNc(10,ae,6,1,"ng-template",10),e.YNc(11,_e,12,8,"ng-template",11),e.qZA()(),e.TgZ(12,"p-dialog",12),e.NdJ("visibleChange",function(a){return i.createDialog=a}),e.TgZ(13,"app-create-usuario",13),e.NdJ("edit",function(a){return i.editEvent(a)}),e.qZA()(),e.TgZ(14,"p-dialog",14),e.NdJ("visibleChange",function(a){return i.editDialog=a}),e.TgZ(15,"app-create-usuario",15),e.NdJ("edit",function(a){return i.editEvent(a)}),e.qZA()(),e.TgZ(16,"p-dialog",16),e.NdJ("visibleChange",function(a){return i.changePasswordDialog=a}),e.TgZ(17,"app-cambiar-contrasena-usuario",15),e.NdJ("edit",function(a){return i.editEvent(a)}),e.qZA()(),e.TgZ(18,"p-dialog",17),e.NdJ("visibleChange",function(a){return i.asigCiasDialog=a}),e.TgZ(19,"app-asig-cias-usuarios",15),e.NdJ("edit",function(a){return i.editEvent(a)}),e.qZA()(),e.TgZ(20,"p-dialog",18),e.NdJ("visibleChange",function(a){return i.asigAccesosDialog=a}),e.TgZ(21,"app-asig-accesos-usuarios",15),e.NdJ("edit",function(a){return i.editEvent(a)}),e.qZA()(),e.TgZ(22,"p-dialog",19),e.NdJ("visibleChange",function(a){return i.deleteItemDialog=a}),e.TgZ(23,"div",20),e._UZ(24,"i",21),e.YNc(25,ge,5,1,"span",22),e.qZA(),e.YNc(26,he,2,0,"ng-template",23),e.qZA(),e.TgZ(27,"p-dialog",24),e.NdJ("visibleChange",function(a){return i.deleteItemsDialog=a}),e.TgZ(28,"div",20),e._UZ(29,"i",21),e.TgZ(30,"span"),e._uU(31,"\xbfEst\xe1 seguro de que desea eliminar los elementos seleccionados?"),e.qZA()(),e.YNc(32,fe,2,0,"ng-template",23),e.qZA(),e.TgZ(33,"p-dialog",19),e.NdJ("visibleChange",function(a){return i.restartItemDialog=a}),e.TgZ(34,"div",20),e._UZ(35,"i",21),e.YNc(36,ve,5,1,"span",22),e.qZA(),e.YNc(37,be,2,0,"ng-template",23),e.qZA(),e.TgZ(38,"p-dialog",24),e.NdJ("visibleChange",function(a){return i.restartItemsDialog=a}),e.TgZ(39,"div",20),e._UZ(40,"i",21),e.TgZ(41,"span"),e._uU(42,"\xbfEst\xe1 seguro de que desea restaurar los elementos seleccionados?"),e.qZA()(),e.YNc(43,Ce,2,0,"ng-template",23),e.qZA()()()),2&t&&(e.xp6(7),e.Q6J("value",i.data)("columns",i.cols)("rows",10)("globalFilterFields",i.cols)("rows",10)("paginator",!0)("loading",i.isLoadingTable)("rowsPerPageOptions",e.DdM(53,Ze))("showCurrentPageReport",!0)("selection",i.selectedData)("rowHover",!0),e.xp6(5),e.Akn(e.DdM(54,b)),e.Q6J("visible",i.createDialog)("modal",!0),e.xp6(2),e.Akn(e.DdM(55,b)),e.Q6J("visible",i.editDialog)("modal",!0),e.xp6(1),e.Q6J("usuario",i.item),e.xp6(1),e.Akn(e.DdM(56,b)),e.Q6J("visible",i.changePasswordDialog)("modal",!0),e.xp6(1),e.Q6J("usuario",i.itemChangePass),e.xp6(1),e.Akn(e.DdM(57,b)),e.Q6J("visible",i.asigCiasDialog)("modal",!0),e.xp6(1),e.Q6J("usuario",i.itemAsigCias),e.xp6(1),e.Akn(e.DdM(58,b)),e.Q6J("visible",i.asigAccesosDialog)("modal",!0),e.xp6(1),e.Q6J("usuario",i.itemAsigAccesos),e.xp6(1),e.Akn(e.DdM(59,Z)),e.Q6J("visible",i.deleteItemDialog)("modal",!0),e.xp6(3),e.Q6J("ngIf",i.item),e.xp6(2),e.Akn(e.DdM(60,Z)),e.Q6J("visible",i.deleteItemsDialog)("modal",!0),e.xp6(6),e.Akn(e.DdM(61,Z)),e.Q6J("visible",i.restartItemDialog)("modal",!0),e.xp6(3),e.Q6J("ngIf",i.item),e.xp6(2),e.Akn(e.DdM(62,Z)),e.Q6J("visible",i.restartItemsDialog)("modal",!0))},dependencies:[g.sg,g.O5,g.PC,l.JJ,l.On,d.iA,m.jx,d.lQ,d.fz,d.UA,d.Mo,J.p,h.Hq,N.UN,f.H,I.FN,F.o,v.o,q.V,E,H,Y,X],styles:[".rowStyle[_ngcontent-%COMP%]{width:14%;min-width:10rem}.rowStyleId[_ngcontent-%COMP%]{width:10%;min-width:6rem}"]})),o})()}];let Te=(()=>{class o{}return(0,n.Z)(o,"\u0275fac",function(t){return new(t||o)}),(0,n.Z)(o,"\u0275mod",e.oAB({type:o})),(0,n.Z)(o,"\u0275inj",e.cJS({imports:[x.m,k.Bz.forChild(Ae)]})),o})()}}]);