"use strict";(self.webpackChunkmyadminhn=self.webpackChunkmyadminhn||[]).push([[4795],{4795:(mt,v,r)=>{r.r(v),r.d(v,{FacturasModule:()=>_t});var a=r(1180),y=r(1380),S=r(7246),f=r(805),b=r(7579),g=r(2722),q=r(4004),u=r(5698),t=r(4650),I=r(2340),D=r(529),h=r(629);let Z=(()=>{class l{constructor(i,e){(0,a.Z)(this,"http",void 0),(0,a.Z)(this,"authS",void 0),(0,a.Z)(this,"_prefix",I.H+"/api/facturas"),this.http=i,this.authS=e}getAll(i=[1]){this.authS.refreshToken();const e={cia_nids:this.authS.isValidCia(!1),fact_nsts:i};return this.http.post(this._prefix+"/getall",e)}save(i){const e={...i,...this.authS.getUsuarioLog()};return this.http.post(this._prefix+"/save",e)}setSts(i){return this.http.post(this._prefix+"/setsts/"+i.fact_nid,{fact_nsts:i.fact_nsts,...this.authS.getUsuarioLog()})}setBulkSts(i){return this.http.post(this._prefix+"/setbullksts",{data:i,...this.authS.getUsuarioLog()})}getPuntosEmision(){const i={cia_nids:this.authS.isValidCia(!1),sucu_nids:this.authS.getSucursalSelected()};return this.http.post(this._prefix+"/getallpuntosemision",i)}getClientes(){return this.http.post(this._prefix+"/getallclientes",{cia_nids:this.authS.isValidCia(!1)})}getAgentes(){return this.http.post(this._prefix+"/getallagentes",{cia_nids:this.authS.isValidCia(!1)})}getFormasPagos(){return this.http.post(this._prefix+"/getallformaspagos",{cia_nids:this.authS.isValidCia(!1)})}getMateriales(){return this.http.post(this._prefix+"/getallmateriales",{cia_nids:this.authS.isValidCia(!1)})}getRegistrosFiscalesByPuntoEmision(i){return this.http.post(this._prefix+"/getallregistrosfiscalesbypuntoemision",{punemi_nids:i})}getMonedas(){return this.http.post(this._prefix+"/getallmonedas",{})}}return(0,a.Z)(l,"\u0275fac",function(i){return new(i||l)(t.LFG(D.eN),t.LFG(h.e))}),(0,a.Z)(l,"\u0275prov",t.Yz7({token:l,factory:l.\u0275fac,providedIn:"root"})),l})();var C=r(1168),_=r(6895),d=r(433),p=r(99),k=r(3388),T=r(5593),N=r(5362),A=r(1795),U=r(2453),J=r(1383),F=r(1740),w=r(1493),V=r(2210);function E(l,s){1&l&&(t.TgZ(0,"label",17),t._uU(1,"Factor cambio"),t.qZA())}function M(l,s){1&l&&(t.TgZ(0,"div",6),t._UZ(1,"input",45),t.qZA())}function B(l,s){1&l&&(t.TgZ(0,"label",17),t._uU(1,"Vencimiento factura"),t.qZA())}function R(l,s){if(1&l&&(t.TgZ(0,"div",46),t._UZ(1,"input",47),t.qZA()),2&l){const i=t.oxw();t.xp6(1),t.ekj("ng-invalid",(null==i.fact_dcredito?null:i.fact_dcredito.invalid)&&(null==i.fact_dcredito?null:i.fact_dcredito.touched))("ng-dirty",(null==i.fact_dcredito?null:i.fact_dcredito.invalid)&&(null==i.fact_dcredito?null:i.fact_dcredito.touched))("ng-valid",(null==i.fact_dcredito?null:i.fact_dcredito.valid)&&((null==i.fact_dcredito?null:i.fact_dcredito.touched)||(null==i.fact_dcredito?null:i.fact_dcredito.dirty)))}}function j(l,s){1&l&&(t.TgZ(0,"div",48),t._UZ(1,"input",49),t.qZA())}function H(l,s){1&l&&(t.TgZ(0,"tr")(1,"th"),t._uU(2,"Acciones"),t.qZA(),t.TgZ(3,"th"),t._uU(4,"Material"),t.qZA(),t.TgZ(5,"th"),t._uU(6,"Cant."),t.qZA(),t.TgZ(7,"th"),t._uU(8,"Precio"),t.qZA(),t.TgZ(9,"th"),t._uU(10,"Descuento"),t.qZA(),t.TgZ(11,"th"),t._uU(12,"ISV"),t.qZA(),t.TgZ(13,"th"),t._uU(14,"Total"),t.qZA()())}function Q(l,s){if(1&l&&(t.TgZ(0,"tr")(1,"td")(2,"div",50),t._UZ(3,"button",51)(4,"button",52),t.qZA()(),t.TgZ(5,"td")(6,"span",53),t._uU(7,"Material"),t.qZA(),t._uU(8),t.qZA(),t.TgZ(9,"td")(10,"span",53),t._uU(11,"Cant."),t.qZA(),t._uU(12),t.qZA(),t.TgZ(13,"td")(14,"span",53),t._uU(15,"Precio"),t.qZA(),t._uU(16),t.qZA(),t.TgZ(17,"td")(18,"span",53),t._uU(19,"Descuento"),t.qZA(),t._uU(20),t.qZA(),t.TgZ(21,"td")(22,"span",53),t._uU(23,"ISV"),t.qZA(),t._uU(24),t.qZA(),t.TgZ(25,"td")(26,"span",53),t._uU(27,"Total"),t.qZA(),t._uU(28),t.qZA()()),2&l){const i=s.$implicit;t.xp6(8),t.hij(" ",i.mater_vdescripcion," "),t.xp6(4),t.hij(" ",i.facdet_fcantidad," "),t.xp6(4),t.hij(" ",i.facdet_fcosto," "),t.xp6(4),t.hij(" ",i.facdet_fdescuentosaplicados,"% "),t.xp6(4),t.hij(" ",i.facdet_fimpuestosaplicados,"% "),t.xp6(4),t.hij(" ",i.facdet_nsubtotal," ")}}let P=(()=>{class l{constructor(i,e,n,o){(0,a.Z)(this,"dbapi",void 0),(0,a.Z)(this,"_builder",void 0),(0,a.Z)(this,"authS",void 0),(0,a.Z)(this,"skNsCore",void 0),(0,a.Z)(this,"createForm",void 0),(0,a.Z)(this,"puntosEmision",[]),(0,a.Z)(this,"registrosFiscales",[]),(0,a.Z)(this,"monedas",[]),(0,a.Z)(this,"agentesVenta",[]),(0,a.Z)(this,"agentesCobro",[]),(0,a.Z)(this,"clientes",[]),(0,a.Z)(this,"formasPagos",[]),(0,a.Z)(this,"tiposFacturas",[]),(0,a.Z)(this,"materiales",[]),(0,a.Z)(this,"data",[]),(0,a.Z)(this,"subtotal",0),(0,a.Z)(this,"descuento",0),(0,a.Z)(this,"isv",0),(0,a.Z)(this,"total",0),(0,a.Z)(this,"guardando",!1),(0,a.Z)(this,"itemDialog",!1),(0,a.Z)(this,"submitted",!1),(0,a.Z)(this,"$destroy",new b.x),(0,a.Z)(this,"factura",{}),(0,a.Z)(this,"edit",new t.vpe),this.dbapi=i,this._builder=e,this.authS=n,this.skNsCore=o,this.createForm=e.group({fact_nid:[0],punemi_nid:["",d.kI.required],cli_nid:["",d.kI.required],forpag_nid:["",d.kI.required],regfis_nid:["",d.kI.required],docfis_nid:["",d.kI.required],mone_nid:["",d.kI.required],mone_nidlocal:["",d.kI.required],fact_nfactorcambio:["",d.kI.required],fact_nvendedor:["",d.kI.required],fact_ncobrador:["",d.kI.required],fact_ntipo:[""],fact_dfecha:[""],fact_dcredito:[""],fact_dfechavencimiento:[""],cli_vrtn:[""],cli_vdireccion:[""],cli_vtelefono:[""],cli_nsts:[""],mater_nid:[""],facdet_fcosto:[""],facdet_fcantidad:[""],facdet_fdescuentosaplicados:[""],facdet_fimpuestosaplicados:[""],facdet_fsubtotal:[""]}),this.tiposFacturas=[{id:"1",text:"CONTADO",obj:{}},{id:"2",text:"CREDITO",obj:{}}],n.\u00f8bserverCompanySelected.pipe((0,g.R)(this.$destroy)).subscribe(c=>{this.getMonedas(),this.getPuntosEmision(),this.getClientes(),this.getAgentes(),this.getFormasPagos(),this.getMateriales()})}ngOnInit(){}ngOnChanges(){}getPuntosEmision(){this.puntosEmision=[],this.punemi_nid?.setValue(""),this.dbapi.getPuntosEmision().pipe((0,u.q)(1)).subscribe({next:i=>{if(i&&null!=i&&""!==i){for(const e in i)this.puntosEmision=[...this.puntosEmision,{id:i[e].punemi_nid,text:i[e].punemi_vcodigo+" "+i[e].punemi_vdireccion+" "+i[e].sucus.sucu_vnombre+" "+i[e].sucus.cias.cia_vnombre,obj:i[e]}];1==this.puntosEmision.length&&(this.punemi_nid?.setValue(this.puntosEmision[0]),this.mone_nidlocal?.setValue(i[0].sucus.cias.mone_nid),this.getRegistrosFiscalesByPuntoEmision(),this.setFactorCambio())}else console.log("Error consultando compa\xf1\xedas")},error:i=>{console.log(i),this.guardando=!1,this.edit.emit({type:"error",title:"Ha ocurrido un error",message:i})}})}getRegistrosFiscalesByPuntoEmision(){this.registrosFiscales=[],this.regfis_nid?.setValue(""),this.punemi_nid?.value&&this.punemi_nid?.value.id>0&&this.dbapi.getRegistrosFiscalesByPuntoEmision(this.punemi_nid?.value.id).pipe((0,u.q)(1)).subscribe({next:i=>{if(i&&null!=i&&""!==i){for(const e in i)this.registrosFiscales=[...this.registrosFiscales,{id:i[e].regfis_nid,text:i[e].docfiss.docfis_vcodigo+" "+i[e].docfiss.docfis_vdescripcion+" "+i[e].regfis_vcai,obj:i[e]}];1==this.registrosFiscales.length&&(this.regfis_nid?.setValue(this.registrosFiscales[0]),this.docfis_nid?.setValue(i[0].docfis_nid))}else console.log("Error consultando registros fiscales")},error:i=>{console.log(i),this.guardando=!1,this.edit.emit({type:"error",title:"Ha ocurrido un error",message:i})}})}getClientes(){this.clientes=[{id:"",text:"...",obj:{}}],this.fact_nid?.setValue(""),this.dbapi.getClientes().pipe((0,u.q)(1)).subscribe({next:i=>{if(i&&null!=i&&""!==i)for(const e in i)this.clientes=[...this.clientes,{id:i[e].fact_nid,text:i[e].cli_videntidad+" - "+i[e].cli_vnombre,obj:i[e]}];else console.log("Error consultando unidades de medida")},error:i=>{console.log(i),this.edit.emit({type:"error",title:"Ha ocurrido un error",message:i})}})}getMonedas(){this.monedas=[],this.mone_nid?.setValue(""),this.dbapi.getMonedas().pipe((0,u.q)(1)).subscribe({next:i=>{if(i&&null!=i&&""!==i){for(const e in i)this.monedas=[...this.monedas,{id:i[e].mone_nid,text:i[e].mone_vnombre,obj:i[e]}];1==this.monedas.length&&(this.mone_nid?.setValue(this.monedas[0]),this.setFactorCambio())}else console.log("Error consultando monedas")},error:i=>{console.log(i),this.edit.emit({type:"error",title:"Ha ocurrido un error",message:i})}})}getFormasPagos(){this.formasPagos=[],this.forpag_nid?.setValue(""),this.dbapi.getFormasPagos().pipe((0,u.q)(1)).subscribe({next:i=>{if(i&&null!=i&&""!==i){for(const e in i)this.formasPagos=[...this.formasPagos,{id:i[e].forpag_nid,text:i[e].forpag_vdescripcion,obj:i[e]}];1==this.formasPagos.length&&(this.forpag_nid?.setValue(this.formasPagos[0]),this.setFactorCambio())}else console.log("Error consultando formas pagos")},error:i=>{console.log(i),this.edit.emit({type:"error",title:"Ha ocurrido un error",message:i})}})}getMateriales(){this.materiales=[{id:"",text:"...",obj:{}}],this.mater_nid?.setValue(""),this.dbapi.getMateriales().pipe((0,u.q)(1)).subscribe({next:i=>{if(i&&null!=i&&""!==i)for(const e in i)this.materiales=[...this.materiales,{id:i[e].mater_nid,text:i[e].mater_vcodigo+" - "+i[e].mater_vnombre+(i[e].mater_vcodbar&&""!=i[e].mater_vcodbar&&i[e].mater_vcodigo!=i[e].mater_vcodbar?" - "+i[e].mater_vcodbar:""),obj:i[e]}];else console.log("Error consultando materiales")},error:i=>{console.log(i),this.edit.emit({type:"error",title:"Ha ocurrido un error",message:i})}})}getAgentes(){this.agentesVenta=[],this.agentesCobro=[],this.fact_nvendedor?.setValue(null),this.fact_ncobrador?.setValue(null),this.dbapi.getAgentes().pipe((0,u.q)(1)).subscribe({next:i=>{if(i&&null!=i&&""!==i){for(const e in i){const n={id:i[e].agen_nid,text:i[e].agen_vcodigo+" - "+i[e].agen_vnombre,obj:i[e]};3===i[e].agen_ntipo?(this.agentesVenta=[...this.agentesVenta,n],this.agentesCobro=[...this.agentesCobro,n]):1===i[e].agen_ntipo?this.agentesVenta=[...this.agentesVenta,n]:2===i[e].agen_ntipo&&(this.agentesCobro=[...this.agentesCobro,n])}1==this.agentesVenta.length&&this.fact_nvendedor?.setValue(this.agentesVenta[0]),1==this.agentesCobro.length&&this.fact_ncobrador?.setValue(this.agentesCobro[0])}else console.log("Error consultando unidades de medida")},error:i=>{console.log(i),this.edit.emit({type:"error",title:"Ha ocurrido un error",message:i})}})}setFactorCambio(){this.fact_nfactorcambio?.setValue(this.mone_nid?.value&&this.mone_nid?.value.id>0&&this.mone_nid.value.id===this.mone_nidlocal?.value?1:"")}save(){this.createForm.valid&&!this.guardando&&(this.guardando=!0,this.dbapi.save({fact_nid:this.fact_nid?.value>0?this.fact_nid?.value:null,punemi_nid:this.punemi_nid?.value.id,fact_nsts:1}).pipe((0,u.q)(1)).subscribe({next:e=>{"success"==e.type&&(this.skNsCore.notificarUpsert("/ventas/clientes",this.authS.isValidCia(!1).toString(),this.authS.usuario.user_nid.toString()),this.limpiarForm()),this.guardando=!1,this.edit.emit(e)},error:e=>{console.log(e),this.guardando=!1,this.edit.emit({type:"error",title:"Ha ocurrido un error",message:e})}}))}limpiarForm(){this.createForm.reset(),this.fact_nid?.setValue(0)}hideDialog(){this.itemDialog=!1,this.submitted=!1}searchById(i,e){for(let n=0;n<e.length;n++){const o=e[n];if(o.id==i)return o}return""}setMaterial(i){console.log("material",i),i&&i.id>0?(this.facdet_fimpuestosaplicados?.setValue(i.obj.mater_nisv),this.facdet_fcosto?.setValue(i.obj.mater_nisvincluido>0&&i.obj.mater_nisv>0?i.obj.mater_nprecio/(1+i.obj.mater_nisv/100):i.obj.mater_nprecio)):(this.facdet_fcosto?.setValue(0),this.facdet_fimpuestosaplicados?.setValue(0)),this.calcularDetalle()}calcularDetalle(){this.facdet_fcosto?.value>0||this.facdet_fcosto?.setValue(0),this.facdet_fcantidad?.value>0||this.facdet_fcantidad?.setValue(0),console.log("facdet_fdescuentosaplicados",this.facdet_fdescuentosaplicados?.value>0),this.facdet_fdescuentosaplicados?.value>0||(console.log("etrooo"),this.facdet_fdescuentosaplicados?.setValue(0)),this.facdet_fimpuestosaplicados?.value>0||this.facdet_fimpuestosaplicados?.setValue(0);const e=this.facdet_fcosto?.value*this.facdet_fcantidad?.value-this.facdet_fdescuentosaplicados?.value;this.facdet_fsubtotal?.setValue(e+e*(this.facdet_fimpuestosaplicados?.value/100))}calcularTotales(){let i=0,e=0,n=0,o=0;this.data.forEach(c=>{i+=c.facdet_fcosto*c.facdet_fcantidad,e+=c.facdet_fdescuentovalor,n+=c.facdet_fimpuestosvalor,o+=c.facdet_nsubtotal}),this.subtotal=i,this.descuento=e,this.isv=n,this.total=o}agregarDetalle(){const i=this.facdet_fcosto?.value*this.facdet_fcantidad?.value,e=i*(this.facdet_fdescuentosaplicados?.value/100),n=i-e,o=n*(this.facdet_fimpuestosaplicados?.value/100);this.data.push({facdet_nid:null,fact_nid:null,mater_vdescripcion:this.mater_nid?.value.text,mater_nid:this.mater_nid?.value.id,facdet_fcantidad:this.facdet_fcantidad?.value,facdet_fcosto:this.facdet_fcosto?.value,facdet_fdescuentosaplicados:this.facdet_fdescuentosaplicados?.value,facdet_fdescuentovalor:e,facdet_fimpuestosaplicados:this.facdet_fimpuestosaplicados?.value,facdet_fimpuestosvalor:o,facdet_vdescripcion:"",facdet_nsubtotal:n+o}),this.calcularTotales()}ngOnDestroy(){this.$destroy.next(),this.$destroy.complete()}get fact_nid(){return this.createForm.get("fact_nid")}get punemi_nid(){return this.createForm.get("punemi_nid")}get cli_nid(){return this.createForm.get("cli_nid")}get forpag_nid(){return this.createForm.get("forpag_nid")}get regfis_nid(){return this.createForm.get("regfis_nid")}get docfis_nid(){return this.createForm.get("docfis_nid")}get mone_nid(){return this.createForm.get("mone_nid")}get mone_nidlocal(){return this.createForm.get("mone_nidlocal")}get fact_nfactorcambio(){return this.createForm.get("fact_nfactorcambio")}get fact_nvendedor(){return this.createForm.get("fact_nvendedor")}get fact_ncobrador(){return this.createForm.get("fact_ncobrador")}get fact_ntipo(){return this.createForm.get("fact_ntipo")}get fact_dfecha(){return this.createForm.get("fact_dfecha")}get fact_dcredito(){return this.createForm.get("fact_dcredito")}get fact_dfechavencimiento(){return this.createForm.get("fact_dfechavencimiento")}get cli_nsts(){return this.createForm.get("cli_nsts")}get mater_nid(){return this.createForm.get("mater_nid")}get facdet_fcosto(){return this.createForm.get("facdet_fcosto")}get facdet_fcantidad(){return this.createForm.get("facdet_fcantidad")}get facdet_fdescuentosaplicados(){return this.createForm.get("facdet_fdescuentosaplicados")}get facdet_fimpuestosaplicados(){return this.createForm.get("facdet_fimpuestosaplicados")}get facdet_fsubtotal(){return this.createForm.get("facdet_fsubtotal")}}return(0,a.Z)(l,"\u0275fac",function(i){return new(i||l)(t.Y36(Z),t.Y36(d.qu),t.Y36(h.e),t.Y36(C.pP))}),(0,a.Z)(l,"\u0275cmp",t.Xpm({type:l,selectors:[["app-create-facturas"]],inputs:{factura:"factura"},outputs:{edit:"edit"},features:[t.TTD],decls:114,vars:163,consts:[[1,"row"],[1,"col-12"],[1,"card"],[1,"form-horizontal",3,"formGroup","ngSubmit"],[1,"field","grid"],["htmlFor","name3",1,"col-12","mb-1","md:col-1","md:mb-0","text-900"],[1,"col-12","md:col-3","mb-3"],["optionLabel","text","formControlName","punemi_nid","filterBy","text",3,"options","filter","virtualScroll","virtualScrollItemSize","onChange"],["optionLabel","text","formControlName","regfis_nid","filterBy","text",3,"options","filter","virtualScroll","virtualScrollItemSize"],["optionLabel","text","formControlName","mone_nid","filterBy","text",3,"options","filter","virtualScroll","virtualScrollItemSize","onChange"],["htmlFor","name3","class","col-12 mb-2 md:col-1 md:mb-0 text-900",4,"ngIf"],["class","col-12 md:col-3 mb-3",4,"ngIf"],["optionLabel","text","formControlName","fact_nvendedor","filterBy","text",3,"options","filter","virtualScroll","virtualScrollItemSize"],["optionLabel","text","formControlName","fact_ncobrador","filterBy","text",3,"options","filter","virtualScroll","virtualScrollItemSize"],["optionLabel","text","formControlName","cli_nid","filterBy","text",3,"options","filter","virtualScroll","virtualScrollItemSize"],["optionLabel","text","formControlName","forpag_nid","filterBy","text",3,"options","filter","virtualScroll","virtualScrollItemSize"],["optionLabel","text","formControlName","fact_ntipo","filterBy","text",3,"options","filter","virtualScroll","virtualScrollItemSize"],["htmlFor","name3",1,"col-12","mb-2","md:col-1","md:mb-0","text-900"],["pInputText","","formControlName","fact_dfecha","type","datetime-local",2,"text-transform","uppercase"],["class","col-12 md:col-1 mb-3",4,"ngIf"],["class","col-12 md:col-2 mb-3",4,"ngIf"],[1,"col-12","md:col-3","mt-1"],["htmlFor","name3",1,"text-900",2,"margin","4px !important"],["optionLabel","text","formControlName","mater_nid","filterBy","text",3,"options","filter","virtualScroll","virtualScrollItemSize","onChange"],[1,"col-12","md:col-2","mt-1"],["pInputText","","formControlName","facdet_fcosto","type","number",3,"change"],["pInputText","","formControlName","facdet_fcantidad","type","number",3,"change"],[1,"col-12","md:col-1","mt-1"],["pInputText","","formControlName","facdet_fdescuentosaplicados","type","number",3,"change"],["pInputText","","formControlName","facdet_fimpuestosaplicados","type","number",3,"change"],["pInputText","","formControlName","facdet_fsubtotal","type","number",3,"readonly"],[1,"col-12","md:col-1","mt-1","pt-2"],["pButton","","pRipple","","icon","pi pi-save","type","button",1,"p-button-success","btn-sm",3,"disabled","click"],["responsiveLayout","scroll",3,"value","rows","paginator","showCurrentPageReport","rowHover"],["dt",""],["pTemplate","header"],["pTemplate","body"],[1,"col-12","md:col-12","mt-1","pr-5"],[2,"float","right"],[2,"text-align","left"],[2,"text-align","rigth"],[1,"col-5"],[1,"p-buttonset"],["pButton","","pRipple","","icon","pi pi-save","type","submit",1,"p-button-success","mr-1","btn-sm",3,"disabled","loading","label"],["pButton","","pRipple","","label","Limpiar","icon","pi pi-trash","type","button",1,"p-button-danger","btn-sm",3,"click"],["pInputText","","formControlName","fact_nfactorcambio","type","number"],[1,"col-12","md:col-1","mb-3"],["pInputText","","formControlName","fact_dcredito","type","number",2,"text-transform","uppercase"],[1,"col-12","md:col-2","mb-3"],["pInputText","","formControlName","fact_dfechavencimiento","type","date",2,"text-transform","uppercase"],[1,"flex"],["pButton","","pRipple","","icon","pi pi-pencil","title","Editar","type","button",1,"p-button-success","mr-1"],["pButton","","pRipple","","icon","pi pi-trash","title","Eliminar","type","button",1,"p-button-danger"],[1,"p-column-title"]],template:function(i,e){1&i&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"form",3),t.NdJ("ngSubmit",function(){return e.save()}),t.TgZ(4,"div",4)(5,"label",5),t._uU(6,"Punto emisi\xf3n"),t.qZA(),t.TgZ(7,"div",6)(8,"p-dropdown",7),t.NdJ("onChange",function(){return e.getRegistrosFiscalesByPuntoEmision(),e.setFactorCambio()}),t.qZA()(),t.TgZ(9,"label",5),t._uU(10,"Registro fiscal"),t.qZA(),t.TgZ(11,"div",6),t._UZ(12,"p-dropdown",8),t.qZA(),t.TgZ(13,"label",5),t._uU(14,"Moneda"),t.qZA(),t.TgZ(15,"div",6)(16,"p-dropdown",9),t.NdJ("onChange",function(){return e.setFactorCambio()}),t.qZA()(),t.YNc(17,E,2,0,"label",10),t.YNc(18,M,2,0,"div",11),t.TgZ(19,"label",5),t._uU(20,"Agente venta"),t.qZA(),t.TgZ(21,"div",6),t._UZ(22,"p-dropdown",12),t.qZA(),t.TgZ(23,"label",5),t._uU(24,"Agente cobro"),t.qZA(),t.TgZ(25,"div",6),t._UZ(26,"p-dropdown",13),t.qZA(),t.TgZ(27,"label",5),t._uU(28,"Cliente"),t.qZA(),t.TgZ(29,"div",6),t._UZ(30,"p-dropdown",14),t.qZA(),t.TgZ(31,"label",5),t._uU(32,"Forma pago"),t.qZA(),t.TgZ(33,"div",6),t._UZ(34,"p-dropdown",15),t.qZA(),t.TgZ(35,"label",5),t._uU(36,"Tipo factura"),t.qZA(),t.TgZ(37,"div",6),t._UZ(38,"p-dropdown",16),t.qZA(),t.TgZ(39,"label",17),t._uU(40,"Fecha factura"),t.qZA(),t.TgZ(41,"div",6),t._UZ(42,"input",18),t.qZA(),t.YNc(43,B,2,0,"label",10),t.YNc(44,R,2,6,"div",19),t.YNc(45,j,2,0,"div",20),t.qZA(),t._UZ(46,"hr"),t.TgZ(47,"div",4)(48,"div",21)(49,"label",22),t._uU(50,"Material"),t.qZA(),t.TgZ(51,"p-dropdown",23),t.NdJ("onChange",function(o){return e.setMaterial(o.value)}),t.qZA()(),t.TgZ(52,"div",24)(53,"label",22),t._uU(54,"Precio"),t.qZA(),t.TgZ(55,"input",25),t.NdJ("change",function(){return e.calcularDetalle()}),t.qZA()(),t.TgZ(56,"div",24)(57,"label",22),t._uU(58,"Cantidad"),t.qZA(),t.TgZ(59,"input",26),t.NdJ("change",function(){return e.calcularDetalle()}),t.qZA()(),t.TgZ(60,"div",27)(61,"label",22),t._uU(62,"Descuento(%)"),t.qZA(),t.TgZ(63,"input",28),t.NdJ("change",function(){return e.calcularDetalle()}),t.qZA()(),t.TgZ(64,"div",27)(65,"label",22),t._uU(66,"ISV(%)"),t.qZA(),t.TgZ(67,"input",29),t.NdJ("change",function(){return e.calcularDetalle()}),t.qZA()(),t.TgZ(68,"div",24)(69,"label",22),t._uU(70,"SubTotal"),t.qZA(),t._UZ(71,"input",30),t.qZA(),t.TgZ(72,"div",31)(73,"button",32),t.NdJ("click",function(){return e.agregarDetalle()}),t.qZA()()(),t._UZ(74,"hr"),t.TgZ(75,"p-table",33,34),t.YNc(77,H,15,0,"ng-template",35),t.YNc(78,Q,29,6,"ng-template",36),t.qZA(),t._UZ(79,"hr"),t.TgZ(80,"div",4)(81,"div",37)(82,"table",38)(83,"tbody")(84,"tr")(85,"th",39),t._uU(86,"SubTotal"),t.qZA(),t.TgZ(87,"td",40),t._uU(88),t.ALo(89,"currency"),t.qZA()(),t.TgZ(90,"tr")(91,"th",39),t._uU(92,"Descuentos"),t.qZA(),t.TgZ(93,"td",40),t._uU(94),t.ALo(95,"currency"),t.qZA()(),t.TgZ(96,"tr")(97,"th",39),t._uU(98,"ISV"),t.qZA(),t.TgZ(99,"td",40),t._uU(100),t.ALo(101,"currency"),t.qZA()(),t.TgZ(102,"tr")(103,"th",39),t._uU(104,"Total"),t.qZA(),t.TgZ(105,"td",40),t._uU(106),t.ALo(107,"currency"),t.qZA()()()()()(),t._UZ(108,"hr"),t.TgZ(109,"div",4)(110,"div",41)(111,"span",42),t._UZ(112,"button",43),t.TgZ(113,"button",44),t.NdJ("click",function(){return e.limpiarForm()}),t.qZA()()()()()()()()),2&i&&(t.xp6(3),t.Q6J("formGroup",e.createForm),t.xp6(5),t.ekj("ng-invalid",(null==e.punemi_nid?null:e.punemi_nid.invalid)&&(null==e.punemi_nid?null:e.punemi_nid.touched))("ng-dirty",(null==e.punemi_nid?null:e.punemi_nid.invalid)&&(null==e.punemi_nid?null:e.punemi_nid.touched))("ng-valid",(null==e.punemi_nid?null:e.punemi_nid.valid)&&((null==e.punemi_nid?null:e.punemi_nid.touched)||(null==e.punemi_nid?null:e.punemi_nid.dirty))),t.Q6J("options",e.puntosEmision)("filter",!1)("virtualScroll",e.puntosEmision.length>5)("virtualScrollItemSize",38),t.xp6(4),t.ekj("ng-invalid",(null==e.regfis_nid?null:e.regfis_nid.invalid)&&(null==e.regfis_nid?null:e.regfis_nid.touched))("ng-dirty",(null==e.regfis_nid?null:e.regfis_nid.invalid)&&(null==e.regfis_nid?null:e.regfis_nid.touched))("ng-valid",(null==e.regfis_nid?null:e.regfis_nid.valid)&&((null==e.regfis_nid?null:e.regfis_nid.touched)||(null==e.regfis_nid?null:e.regfis_nid.dirty))),t.Q6J("options",e.registrosFiscales)("filter",!1)("virtualScroll",e.registrosFiscales.length>5)("virtualScrollItemSize",38),t.xp6(4),t.ekj("ng-invalid",(null==e.mone_nid?null:e.mone_nid.invalid)&&(null==e.mone_nid?null:e.mone_nid.touched))("ng-dirty",(null==e.mone_nid?null:e.mone_nid.invalid)&&(null==e.mone_nid?null:e.mone_nid.touched))("ng-valid",(null==e.mone_nid?null:e.mone_nid.valid)&&((null==e.mone_nid?null:e.mone_nid.touched)||(null==e.mone_nid?null:e.mone_nid.dirty))),t.Q6J("options",e.monedas)("filter",!1)("virtualScroll",e.monedas.length>5)("virtualScrollItemSize",38),t.xp6(1),t.Q6J("ngIf",(null==e.mone_nid?null:e.mone_nid.value)&&(null==e.mone_nid?null:e.mone_nid.value.id)>0&&(null==e.mone_nid?null:e.mone_nid.value.id)!==(null==e.mone_nidlocal?null:e.mone_nidlocal.value)),t.xp6(1),t.Q6J("ngIf",(null==e.mone_nid?null:e.mone_nid.value)&&(null==e.mone_nid?null:e.mone_nid.value.id)>0&&(null==e.mone_nid?null:e.mone_nid.value.id)!==(null==e.mone_nidlocal?null:e.mone_nidlocal.value)),t.xp6(4),t.ekj("ng-invalid",(null==e.fact_nvendedor?null:e.fact_nvendedor.invalid)&&(null==e.fact_nvendedor?null:e.fact_nvendedor.touched))("ng-dirty",(null==e.fact_nvendedor?null:e.fact_nvendedor.invalid)&&(null==e.fact_nvendedor?null:e.fact_nvendedor.touched))("ng-valid",(null==e.fact_nvendedor?null:e.fact_nvendedor.valid)&&((null==e.fact_nvendedor?null:e.fact_nvendedor.touched)||(null==e.fact_nvendedor?null:e.fact_nvendedor.dirty))),t.Q6J("options",e.agentesVenta)("filter",!1)("virtualScroll",e.agentesVenta.length>5)("virtualScrollItemSize",38),t.xp6(4),t.ekj("ng-invalid",(null==e.fact_nvendedor?null:e.fact_nvendedor.invalid)&&(null==e.fact_nvendedor?null:e.fact_nvendedor.touched))("ng-dirty",(null==e.fact_nvendedor?null:e.fact_nvendedor.invalid)&&(null==e.fact_nvendedor?null:e.fact_nvendedor.touched))("ng-valid",(null==e.fact_nvendedor?null:e.fact_nvendedor.valid)&&((null==e.fact_nvendedor?null:e.fact_nvendedor.touched)||(null==e.fact_nvendedor?null:e.fact_nvendedor.dirty))),t.Q6J("options",e.agentesCobro)("filter",!1)("virtualScroll",e.agentesCobro.length>5)("virtualScrollItemSize",38),t.xp6(4),t.ekj("ng-invalid",(null==e.cli_nid?null:e.cli_nid.invalid)&&(null==e.cli_nid?null:e.cli_nid.touched))("ng-dirty",(null==e.cli_nid?null:e.cli_nid.invalid)&&(null==e.cli_nid?null:e.cli_nid.touched))("ng-valid",(null==e.cli_nid?null:e.cli_nid.valid)&&((null==e.cli_nid?null:e.cli_nid.touched)||(null==e.cli_nid?null:e.cli_nid.dirty))),t.Q6J("options",e.clientes)("filter",!1)("virtualScroll",e.clientes.length>5)("virtualScrollItemSize",38),t.xp6(4),t.ekj("ng-invalid",(null==e.forpag_nid?null:e.forpag_nid.invalid)&&(null==e.forpag_nid?null:e.forpag_nid.touched))("ng-dirty",(null==e.forpag_nid?null:e.forpag_nid.invalid)&&(null==e.forpag_nid?null:e.forpag_nid.touched))("ng-valid",(null==e.forpag_nid?null:e.forpag_nid.valid)&&((null==e.forpag_nid?null:e.forpag_nid.touched)||(null==e.forpag_nid?null:e.forpag_nid.dirty))),t.Q6J("options",e.formasPagos)("filter",!1)("virtualScroll",e.clientes.length>5)("virtualScrollItemSize",38),t.xp6(4),t.ekj("ng-invalid",(null==e.fact_ntipo?null:e.fact_ntipo.invalid)&&(null==e.fact_ntipo?null:e.fact_ntipo.touched))("ng-dirty",(null==e.fact_ntipo?null:e.fact_ntipo.invalid)&&(null==e.fact_ntipo?null:e.fact_ntipo.touched))("ng-valid",(null==e.fact_ntipo?null:e.fact_ntipo.valid)&&((null==e.fact_ntipo?null:e.fact_ntipo.touched)||(null==e.fact_ntipo?null:e.fact_ntipo.dirty))),t.Q6J("options",e.tiposFacturas)("filter",!1)("virtualScroll",e.clientes.length>5)("virtualScrollItemSize",38),t.xp6(4),t.ekj("ng-invalid",(null==e.fact_dfecha?null:e.fact_dfecha.invalid)&&(null==e.fact_dfecha?null:e.fact_dfecha.touched))("ng-dirty",(null==e.fact_dfecha?null:e.fact_dfecha.invalid)&&(null==e.fact_dfecha?null:e.fact_dfecha.touched))("ng-valid",(null==e.fact_dfecha?null:e.fact_dfecha.valid)&&((null==e.fact_dfecha?null:e.fact_dfecha.touched)||(null==e.fact_dfecha?null:e.fact_dfecha.dirty))),t.xp6(1),t.Q6J("ngIf",(null==e.fact_ntipo?null:e.fact_ntipo.value)&&(null==e.fact_ntipo?null:e.fact_ntipo.value.id)>1),t.xp6(1),t.Q6J("ngIf",(null==e.fact_ntipo?null:e.fact_ntipo.value)&&(null==e.fact_ntipo?null:e.fact_ntipo.value.id)>1),t.xp6(1),t.Q6J("ngIf",(null==e.fact_ntipo?null:e.fact_ntipo.value)&&(null==e.fact_ntipo?null:e.fact_ntipo.value.id)>1),t.xp6(6),t.ekj("ng-invalid",(null==e.punemi_nid?null:e.punemi_nid.invalid)&&(null==e.punemi_nid?null:e.punemi_nid.touched))("ng-dirty",(null==e.punemi_nid?null:e.punemi_nid.invalid)&&(null==e.punemi_nid?null:e.punemi_nid.touched))("ng-valid",(null==e.punemi_nid?null:e.punemi_nid.valid)&&((null==e.punemi_nid?null:e.punemi_nid.touched)||(null==e.punemi_nid?null:e.punemi_nid.dirty))),t.Q6J("options",e.materiales)("filter",!1)("virtualScroll",e.puntosEmision.length>5)("virtualScrollItemSize",38),t.xp6(4),t.ekj("ng-invalid",(null==e.facdet_fcantidad?null:e.facdet_fcantidad.invalid)&&(null==e.facdet_fcantidad?null:e.facdet_fcantidad.touched))("ng-dirty",(null==e.facdet_fcantidad?null:e.facdet_fcantidad.invalid)&&(null==e.facdet_fcantidad?null:e.facdet_fcantidad.touched))("ng-valid",(null==e.facdet_fcantidad?null:e.facdet_fcantidad.valid)&&((null==e.facdet_fcantidad?null:e.facdet_fcantidad.touched)||(null==e.facdet_fcantidad?null:e.facdet_fcantidad.dirty))),t.xp6(4),t.ekj("ng-invalid",(null==e.facdet_fcantidad?null:e.facdet_fcantidad.invalid)&&(null==e.facdet_fcantidad?null:e.facdet_fcantidad.touched))("ng-dirty",(null==e.facdet_fcantidad?null:e.facdet_fcantidad.invalid)&&(null==e.facdet_fcantidad?null:e.facdet_fcantidad.touched))("ng-valid",(null==e.facdet_fcantidad?null:e.facdet_fcantidad.valid)&&((null==e.facdet_fcantidad?null:e.facdet_fcantidad.touched)||(null==e.facdet_fcantidad?null:e.facdet_fcantidad.dirty))),t.xp6(4),t.ekj("ng-invalid",(null==e.facdet_fdescuentosaplicados?null:e.facdet_fdescuentosaplicados.invalid)&&(null==e.facdet_fdescuentosaplicados?null:e.facdet_fdescuentosaplicados.touched))("ng-dirty",(null==e.facdet_fdescuentosaplicados?null:e.facdet_fdescuentosaplicados.invalid)&&(null==e.facdet_fdescuentosaplicados?null:e.facdet_fdescuentosaplicados.touched))("ng-valid",(null==e.facdet_fdescuentosaplicados?null:e.facdet_fdescuentosaplicados.valid)&&((null==e.facdet_fdescuentosaplicados?null:e.facdet_fdescuentosaplicados.touched)||(null==e.facdet_fdescuentosaplicados?null:e.facdet_fdescuentosaplicados.dirty))),t.xp6(4),t.ekj("ng-invalid",(null==e.facdet_fimpuestosaplicados?null:e.facdet_fimpuestosaplicados.invalid)&&(null==e.facdet_fimpuestosaplicados?null:e.facdet_fimpuestosaplicados.touched))("ng-dirty",(null==e.facdet_fimpuestosaplicados?null:e.facdet_fimpuestosaplicados.invalid)&&(null==e.facdet_fimpuestosaplicados?null:e.facdet_fimpuestosaplicados.touched))("ng-valid",(null==e.facdet_fimpuestosaplicados?null:e.facdet_fimpuestosaplicados.valid)&&((null==e.facdet_fimpuestosaplicados?null:e.facdet_fimpuestosaplicados.touched)||(null==e.facdet_fimpuestosaplicados?null:e.facdet_fimpuestosaplicados.dirty))),t.xp6(4),t.ekj("ng-invalid",(null==e.facdet_fsubtotal?null:e.facdet_fsubtotal.invalid)&&(null==e.facdet_fsubtotal?null:e.facdet_fsubtotal.touched))("ng-dirty",(null==e.facdet_fsubtotal?null:e.facdet_fsubtotal.invalid)&&(null==e.facdet_fsubtotal?null:e.facdet_fsubtotal.touched))("ng-valid",(null==e.facdet_fsubtotal?null:e.facdet_fsubtotal.valid)&&((null==e.facdet_fsubtotal?null:e.facdet_fsubtotal.touched)||(null==e.facdet_fsubtotal?null:e.facdet_fsubtotal.dirty))),t.Q6J("readonly",!0),t.xp6(2),t.Q6J("disabled",!1),t.xp6(2),t.Q6J("value",e.data)("rows",10)("rows",10)("paginator",!1)("showCurrentPageReport",!0)("rowHover",!0),t.xp6(13),t.Oqu(t.Dn7(89,147,e.subtotal," ","code")),t.xp6(6),t.Oqu(t.Dn7(95,151,e.descuento," ","code")),t.xp6(6),t.Oqu(t.Dn7(101,155,e.isv," ","code")),t.xp6(6),t.Oqu(t.Dn7(107,159,e.total," ","code")),t.xp6(6),t.Q6J("disabled",!e.createForm.valid)("loading",e.guardando)("label",e.factura&&e.factura.cli_nid?"Editar":"Guardar"))},dependencies:[_.O5,d._Y,d.Fj,d.wV,d.JJ,d.JL,d.sg,d.u,p.iA,f.jx,T.Hq,A.H,F.o,V.Lt,_.H9],styles:[".ng-valid[_ngcontent-%COMP%]{border-color:#2ecc71!important}"]})),l})();function O(l,s){1&l&&(t.TgZ(0,"div",21)(1,"h3",22),t._uU(2,"Listado de facturas"),t.qZA()())}function Y(l,s){if(1&l){const i=t.EpF();t._UZ(0,"p-fileUpload",23),t.TgZ(1,"button",24),t.NdJ("click",function(){t.CHM(i),t.oxw();const n=t.MAs(8);return t.KtG(n.exportCSV())}),t.qZA()}2&l&&t.Q6J("maxFileSize",1e6)}function L(l,s){if(1&l){const i=t.EpF();t.TgZ(0,"button",33),t.NdJ("click",function(){t.CHM(i);const n=t.oxw(2);return t.KtG(n.deleteSelectedItems())}),t.qZA()}if(2&l){const i=t.oxw(2);t.Q6J("disabled",!i.selectedData||!i.selectedData.length)}}function z(l,s){if(1&l){const i=t.EpF();t.TgZ(0,"button",34),t.NdJ("click",function(){t.CHM(i);const n=t.oxw(2);return t.KtG(n.restartSelectedItems())}),t.qZA()}if(2&l){const i=t.oxw(2);t.Q6J("disabled",!i.selectedData||!i.selectedData.length)}}const G=function(){return{float:"right"}};function K(l,s){if(1&l){const i=t.EpF();t.TgZ(0,"div",25)(1,"span",26)(2,"input",27),t.NdJ("input",function(n){t.CHM(i);const o=t.oxw(),c=t.MAs(8);return t.KtG(o.onGlobalFilter(c,n))}),t.qZA(),t.TgZ(3,"button",28),t.NdJ("click",function(){t.CHM(i);const n=t.oxw();return t.KtG(n.getData())}),t.qZA(),t.TgZ(4,"button",29),t.NdJ("click",function(){t.CHM(i);const n=t.oxw();return t.KtG(n.openNew())}),t.qZA(),t.YNc(5,L,1,1,"button",30),t.YNc(6,z,1,1,"button",31),t.TgZ(7,"p-selectButton",32),t.NdJ("ngModelChange",function(n){t.CHM(i);const o=t.oxw();return t.KtG(o.dataValue=n)})("click",function(){t.CHM(i);const n=t.oxw();return n.getData(),t.KtG(n.clearDataSelected())}),t.qZA()()()}if(2&l){const i=t.oxw();t.xp6(5),t.Q6J("ngIf",i.dataValue&&1===i.dataValue[0]),t.xp6(1),t.Q6J("ngIf",i.dataValue&&0===i.dataValue[0]),t.xp6(1),t.Q6J("options",i.dataOptions)("ngModel",i.dataValue)("ngStyle",t.DdM(5,G))}}function $(l,s){if(1&l&&(t.TgZ(0,"th",37),t._uU(1),t._UZ(2,"p-sortIcon",38),t.qZA()),2&l){const i=s.$implicit;t.ekj("rowStyle","ID"!==i.header)("rowStyleId","ID"===i.header),t.Q6J("pSortableColumn",i.field),t.xp6(1),t.hij(" ",i.header," "),t.xp6(1),t.Q6J("field",i.field)}}function X(l,s){if(1&l&&(t.TgZ(0,"tr")(1,"th",35),t._UZ(2,"p-tableHeaderCheckbox"),t.qZA(),t.TgZ(3,"th"),t._uU(4,"Acciones"),t.qZA(),t.YNc(5,$,3,7,"th",36),t.qZA()),2&l){const i=t.oxw();t.xp6(5),t.Q6J("ngForOf",i.cols)}}function W(l,s){if(1&l){const i=t.EpF();t.TgZ(0,"button",45),t.NdJ("click",function(){t.CHM(i);const n=t.oxw().$implicit,o=t.oxw();return t.KtG(o.editRow(n))}),t.qZA()}}function x(l,s){if(1&l){const i=t.EpF();t.TgZ(0,"button",46),t.NdJ("click",function(){t.CHM(i);const n=t.oxw().$implicit,o=t.oxw();return t.KtG(o.deleteRow(n))}),t.qZA()}}function tt(l,s){if(1&l){const i=t.EpF();t.TgZ(0,"button",47),t.NdJ("click",function(){t.CHM(i);const n=t.oxw().$implicit,o=t.oxw();return t.KtG(o.restartRow(n))}),t.qZA()}}function et(l,s){if(1&l&&(t.TgZ(0,"td")(1,"span",48),t._uU(2),t.qZA(),t._uU(3),t.qZA()),2&l){const i=s.$implicit,e=t.oxw().$implicit;t.xp6(2),t.Oqu(i.header),t.xp6(1),t.hij(" ",e[i.field]," ")}}function it(l,s){if(1&l&&(t.TgZ(0,"tr")(1,"td"),t._UZ(2,"p-tableCheckbox",39),t.qZA(),t.TgZ(3,"td")(4,"div",40),t.YNc(5,W,1,0,"button",41),t.YNc(6,x,1,0,"button",42),t.YNc(7,tt,1,0,"button",43),t.qZA()(),t.YNc(8,et,4,2,"td",44),t.qZA()),2&l){const i=s.$implicit,e=t.oxw();t.xp6(2),t.Q6J("value",i),t.xp6(3),t.Q6J("ngIf",i.cli_nsts>0),t.xp6(1),t.Q6J("ngIf",i.cli_nsts>0),t.xp6(1),t.Q6J("ngIf",i.cli_nsts<1),t.xp6(1),t.Q6J("ngForOf",e.cols)}}function nt(l,s){if(1&l&&(t.TgZ(0,"span"),t._uU(1,"Estas seguro que quieres eliminar "),t.TgZ(2,"b"),t._uU(3),t.qZA(),t._uU(4,"?"),t.qZA()),2&l){const i=t.oxw();t.xp6(3),t.Oqu(i.item.cli_vnombre)}}function lt(l,s){if(1&l){const i=t.EpF();t.TgZ(0,"button",49),t.NdJ("click",function(){t.CHM(i);const n=t.oxw();return t.KtG(n.deleteItemDialog=!1)}),t.qZA(),t.TgZ(1,"button",50),t.NdJ("click",function(){t.CHM(i);const n=t.oxw();return t.KtG(n.confirmDelete())}),t.qZA()}}function at(l,s){if(1&l){const i=t.EpF();t.TgZ(0,"button",49),t.NdJ("click",function(){t.CHM(i);const n=t.oxw();return t.KtG(n.deleteItemsDialog=!1)}),t.qZA(),t.TgZ(1,"button",50),t.NdJ("click",function(){t.CHM(i);const n=t.oxw();return t.KtG(n.confirmDeleteSelected())}),t.qZA()}}function ot(l,s){if(1&l&&(t.TgZ(0,"span"),t._uU(1,"Estas seguro que quieres restaurar "),t.TgZ(2,"b"),t._uU(3),t.qZA(),t._uU(4,"?"),t.qZA()),2&l){const i=t.oxw();t.xp6(3),t.Oqu(i.item.cli_vnombre)}}function st(l,s){if(1&l){const i=t.EpF();t.TgZ(0,"button",49),t.NdJ("click",function(){t.CHM(i);const n=t.oxw();return t.KtG(n.restartItemDialog=!1)}),t.qZA(),t.TgZ(1,"button",51),t.NdJ("click",function(){t.CHM(i);const n=t.oxw();return t.KtG(n.confirmRestart())}),t.qZA()}}function rt(l,s){if(1&l){const i=t.EpF();t.TgZ(0,"button",49),t.NdJ("click",function(){t.CHM(i);const n=t.oxw();return t.KtG(n.restartItemsDialog=!1)}),t.qZA(),t.TgZ(1,"button",51),t.NdJ("click",function(){t.CHM(i);const n=t.oxw();return t.KtG(n.confirmRestartSelected())}),t.qZA()}}const dt=function(){return[10,20,30]},ut=function(){return{width:"1300px"}},ct=function(){return{width:"750px"}},m=function(){return{width:"450px"}},pt=[{path:"",component:(()=>{class l{constructor(i,e,n,o){(0,a.Z)(this,"dbapi",void 0),(0,a.Z)(this,"messageService",void 0),(0,a.Z)(this,"authS",void 0),(0,a.Z)(this,"skNsCore",void 0),(0,a.Z)(this,"createDialog",!1),(0,a.Z)(this,"editDialog",!1),(0,a.Z)(this,"deleteItemDialog",!1),(0,a.Z)(this,"deleteItemsDialog",!1),(0,a.Z)(this,"restartItemDialog",!1),(0,a.Z)(this,"restartItemsDialog",!1),(0,a.Z)(this,"isLoadingTable",!1),(0,a.Z)(this,"data",[]),(0,a.Z)(this,"item",{}),(0,a.Z)(this,"selectedData",[]),(0,a.Z)(this,"submitted",!1),(0,a.Z)(this,"cols",[]),(0,a.Z)(this,"statuses",[]),(0,a.Z)(this,"dataOptions",[]),(0,a.Z)(this,"dataValue",[1]),(0,a.Z)(this,"rowsPerPageOptions",[5,10,20]),(0,a.Z)(this,"$destroy",new b.x),this.dbapi=i,this.messageService=e,this.authS=n,this.skNsCore=o,o.fromEvent("/ventas/clientes+"+this.authS.isValidCia(!1).toString()).pipe((0,g.R)(this.$destroy)).subscribe(c=>{this.skNsCore.socketId!=c&&(console.log("Event socket: clientes"),this.getData())}),n.\u00f8bserverCompanySelected.pipe((0,g.R)(this.$destroy)).subscribe(c=>{this.getData()}),this.cols=[{field:"fact_nid",header:"ID"},{field:"cli_vnombre",header:"Nombre completo"},{field:"cli_videntidad",header:"Identidad"},{field:"cli_vrtn",header:"RTN"},{field:"cli_vdireccion",header:"Direcci\xf3n"},{field:"cli_vtelefono",header:"Tel\xe9fono"},{field:"cli_vsts",header:"Estado"}],this.dataOptions=[{name:"ACTIVOS",value:[1]},{name:"ELIMINADOS",value:[0]},{name:"TODOS",value:[-1,0,1]}]}getData(){this.isLoadingTable=!0,this.dbapi.getAll(this.dataValue).pipe((0,q.U)(i=>(i.forEach(e=>{e.cia_vnombre=e.cias?e.cias.cia_vnombre:"",e.cli_vsts=1==e.fact_nsts?"ACTIVO":"ELIMINADO"}),i)),(0,u.q)(1)).subscribe({next:i=>{this.data=[...i],this.isLoadingTable=!1},error:i=>{console.log(i),this.editEvent({type:"error",title:"Ha ocurrido un error",message:i})}})}ngOnInit(){}openNew(){this.item={},this.submitted=!1,this.createDialog=!0}deleteSelectedData(){this.deleteItemsDialog=!0}editRow(i){this.item={...i},this.editDialog=!0}deleteRow(i){this.deleteItemDialog=!0,this.item={...i}}deleteSelectedItems(){this.deleteItemsDialog=!0}confirmDeleteSelected(){const i=[];this.selectedData.forEach(e=>{i.push({fact_nid:e.fact_nid,fact_nsts:0})}),this.dbapi.setBulkSts(i).pipe((0,u.q)(1)).subscribe({next:e=>{this.messageService.add({severity:e.type,summary:e.title,detail:e.message,life:3e3}),"success"==e.type&&(this.skNsCore.notificarUpsert("/ventas/clientes",this.authS.isValidCia(!1).toString(),this.authS.usuario.user_nid.toString()),this.deleteItemsDialog=!1,this.selectedData=[],this.getData())},error:e=>{console.log(e),this.editEvent({type:"error",title:"Ha ocurrido un error",message:e})}})}confirmDelete(){this.dbapi.setSts({fact_nid:this.item.fact_nid,fact_nsts:0}).pipe((0,u.q)(1)).subscribe({next:e=>{this.skNsCore.notificarUpsert("/ventas/clientes",this.authS.isValidCia(!1).toString(),this.authS.usuario.user_nid.toString()),this.messageService.add({severity:e.type,summary:e.title,detail:e.message,life:3e3}),this.deleteItemDialog=!1,this.item={},this.getData()},error:e=>{console.log(e),this.editEvent({type:"error",title:"Ha ocurrido un error",message:e})}})}restartRow(i){this.restartItemDialog=!0,this.item={...i}}restartSelectedItems(){this.restartItemsDialog=!0}confirmRestart(){this.dbapi.setSts({fact_nid:this.item.fact_nid,fact_nsts:1}).pipe((0,u.q)(1)).subscribe({next:e=>{this.skNsCore.notificarUpsert("/ventas/clientes",this.authS.isValidCia(!1).toString(),this.authS.usuario.user_nid.toString()),this.messageService.add({severity:e.type,summary:e.title,detail:e.message,life:3e3}),this.restartItemDialog=!1,this.item={},this.getData()},error:e=>{console.log(e),this.editEvent({type:"error",title:"Ha ocurrido un error",message:e})}})}confirmRestartSelected(){const i=[];this.selectedData.forEach(e=>{i.push({fact_nid:e.fact_nid,fact_nsts:1})}),this.dbapi.setBulkSts(i).pipe((0,u.q)(1)).subscribe({next:e=>{this.messageService.add({severity:e.type,summary:e.title,detail:e.message,life:3e3}),"success"==e.type&&(this.skNsCore.notificarUpsert("/ventas/clientes",this.authS.isValidCia(!1).toString(),this.authS.usuario.user_nid.toString()),this.restartItemsDialog=!1,this.selectedData=[],this.getData())},error:e=>{console.log(e),this.editEvent({type:"error",title:"Ha ocurrido un error",message:e})}})}clearDataSelected(){this.selectedData=[]}findIndexById(i){let e=-1;for(let n=0;n<this.data.length;n++)if(this.data[n].fact_nid===i){e=n;break}return e}onGlobalFilter(i,e){i.filterGlobal(e.target.value,"contains")}editEvent(i){this.messageService.add({severity:i.type,summary:i.title,detail:i.message,life:3e3}),"success"==i.type&&(this.getData(),this.createDialog=!1,this.editDialog=!1)}ngOnDestroy(){this.$destroy.next(),this.$destroy.complete()}}return(0,a.Z)(l,"\u0275fac",function(i){return new(i||l)(t.Y36(Z),t.Y36(f.ez),t.Y36(h.e),t.Y36(C.pP))}),(0,a.Z)(l,"\u0275cmp",t.Xpm({type:l,selectors:[["ng-component"]],features:[t._Bn([f.ez])],decls:37,vars:44,consts:[[1,"grid"],[1,"col-12"],[1,"card","px-6","py-6"],["position","bottom-right"],["styleClass","mb-4"],["pTemplate","left"],["pTemplate","right"],["responsiveLayout","scroll","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries","selectionMode","multiple","dataKey","cli_nid",3,"value","columns","rows","globalFilterFields","paginator","loading","rowsPerPageOptions","showCurrentPageReport","selection","rowHover","selectionChange"],["dt",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["header","Crear factura",1,"p-fluid",3,"visible","modal","visibleChange"],[3,"edit"],["header","Editar factura",1,"p-fluid",3,"visible","modal","visibleChange"],["header","Confirmar...",3,"visible","modal","visibleChange"],[1,"flex","align-items-center","justify-content-center"],[1,"pi","pi-exclamation-triangle","mr-3",2,"font-size","2rem"],[4,"ngIf"],["pTemplate","footer"],["header","Confirmar",3,"visible","modal","visibleChange"],[1,"my-2"],[1,"mb-2"],["mode","basic","accept","image/*","label","Import","chooseLabel","Import",1,"mr-2","inline-block",3,"maxFileSize"],["pButton","","pRipple","","label","Export","icon","pi pi-upload",1,"p-button-help",3,"click"],[1,"flex","flex-column","md:flex-row","md:justify-content-between","md:align-items-center"],[1,"block","mt-2","md:mt-0","p-input-icon-rigth"],["pInputText","","type","text","placeholder","Buscar...",1,"w-full","sm:w-auto","mr-1","mt-1",3,"input"],["pButton","","pRipple","","label","","icon","pi pi-sync",1,"p-button-secondary","mr-1","ml-1","mt-1",3,"click"],["pButton","","pRipple","","label","Crear","icon","pi pi-plus",1,"p-button-success","mr-1","ml-1","mt-1",3,"click"],["pButton","","pRipple","","label","Eliminar","icon","pi pi-trash","class","p-button-danger mr-1 ml-1 mt-1",3,"disabled","click",4,"ngIf"],["pButton","","pRipple","","label","Restaurar","icon","pi pi-replay","class","p-button-help mr-1 ml-1 mt-1",3,"disabled","click",4,"ngIf"],["optionLabel","name","optionValue","value",1,"ml-3","mt-1",3,"options","ngModel","ngStyle","ngModelChange","click"],["pButton","","pRipple","","label","Eliminar","icon","pi pi-trash",1,"p-button-danger","mr-1","ml-1","mt-1",3,"disabled","click"],["pButton","","pRipple","","label","Restaurar","icon","pi pi-replay",1,"p-button-help","mr-1","ml-1","mt-1",3,"disabled","click"],[2,"width","3rem"],[3,"pSortableColumn","rowStyle","rowStyleId",4,"ngFor","ngForOf"],[3,"pSortableColumn"],[3,"field"],[3,"value"],[1,"flex"],["pButton","","pRipple","","icon","pi pi-pencil","title","Editar","class","p-button-success mr-1",3,"click",4,"ngIf"],["pButton","","pRipple","","icon","pi pi-trash","title","Eliminar","class","p-button-danger",3,"click",4,"ngIf"],["pButton","","pRipple","","icon","pi pi-replay","title","Restaurar","class","p-button-help",3,"click",4,"ngIf"],[4,"ngFor","ngForOf"],["pButton","","pRipple","","icon","pi pi-pencil","title","Editar",1,"p-button-success","mr-1",3,"click"],["pButton","","pRipple","","icon","pi pi-trash","title","Eliminar",1,"p-button-danger",3,"click"],["pButton","","pRipple","","icon","pi pi-replay","title","Restaurar",1,"p-button-help",3,"click"],[1,"p-column-title"],["pButton","","pRipple","","icon","pi pi-times","label","No",1,"p-button-outlined","p-button-secondary",3,"click"],["pButton","","pRipple","","icon","pi pi-check","label","Si",1,"p-button-outlined","p-button-danger",3,"click"],["pButton","","pRipple","","icon","pi pi-check","label","Si",1,"p-button-outlined","p-button-help",3,"click"]],template:function(i,e){1&i&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2),t._UZ(3,"p-toast",3),t.TgZ(4,"p-toolbar",4),t.YNc(5,O,3,0,"ng-template",5),t.YNc(6,Y,2,1,"ng-template",6),t.qZA(),t.TgZ(7,"p-table",7,8),t.NdJ("selectionChange",function(o){return e.selectedData=o}),t.YNc(9,K,8,6,"ng-template",9),t.YNc(10,X,6,1,"ng-template",10),t.YNc(11,it,9,5,"ng-template",11),t.qZA()(),t.TgZ(12,"p-dialog",12),t.NdJ("visibleChange",function(o){return e.createDialog=o}),t.TgZ(13,"app-create-facturas",13),t.NdJ("edit",function(o){return e.editEvent(o)}),t.qZA()(),t.TgZ(14,"p-dialog",14),t.NdJ("visibleChange",function(o){return e.editDialog=o}),t.qZA(),t.TgZ(15,"p-dialog",15),t.NdJ("visibleChange",function(o){return e.deleteItemDialog=o}),t.TgZ(16,"div",16),t._UZ(17,"i",17),t.YNc(18,nt,5,1,"span",18),t.qZA(),t.YNc(19,lt,2,0,"ng-template",19),t.qZA(),t.TgZ(20,"p-dialog",20),t.NdJ("visibleChange",function(o){return e.deleteItemsDialog=o}),t.TgZ(21,"div",16),t._UZ(22,"i",17),t.TgZ(23,"span"),t._uU(24,"\xbfEst\xe1 seguro de que desea eliminar los elementos seleccionados?"),t.qZA()(),t.YNc(25,at,2,0,"ng-template",19),t.qZA(),t.TgZ(26,"p-dialog",15),t.NdJ("visibleChange",function(o){return e.restartItemDialog=o}),t.TgZ(27,"div",16),t._UZ(28,"i",17),t.YNc(29,ot,5,1,"span",18),t.qZA(),t.YNc(30,st,2,0,"ng-template",19),t.qZA(),t.TgZ(31,"p-dialog",20),t.NdJ("visibleChange",function(o){return e.restartItemsDialog=o}),t.TgZ(32,"div",16),t._UZ(33,"i",17),t.TgZ(34,"span"),t._uU(35,"\xbfEst\xe1 seguro de que desea restaurar los elementos seleccionados?"),t.qZA()(),t.YNc(36,rt,2,0,"ng-template",19),t.qZA()()()),2&i&&(t.xp6(7),t.Q6J("value",e.data)("columns",e.cols)("rows",10)("globalFilterFields",e.cols)("rows",10)("paginator",!0)("loading",e.isLoadingTable)("rowsPerPageOptions",t.DdM(37,dt))("showCurrentPageReport",!0)("selection",e.selectedData)("rowHover",!0),t.xp6(5),t.Akn(t.DdM(38,ut)),t.Q6J("visible",e.createDialog)("modal",!0),t.xp6(2),t.Akn(t.DdM(39,ct)),t.Q6J("visible",e.editDialog)("modal",!0),t.xp6(1),t.Akn(t.DdM(40,m)),t.Q6J("visible",e.deleteItemDialog)("modal",!0),t.xp6(3),t.Q6J("ngIf",e.item),t.xp6(2),t.Akn(t.DdM(41,m)),t.Q6J("visible",e.deleteItemsDialog)("modal",!0),t.xp6(6),t.Akn(t.DdM(42,m)),t.Q6J("visible",e.restartItemDialog)("modal",!0),t.xp6(3),t.Q6J("ngIf",e.item),t.xp6(2),t.Akn(t.DdM(43,m)),t.Q6J("visible",e.restartItemsDialog)("modal",!0))},dependencies:[_.sg,_.O5,_.PC,d.JJ,d.On,p.iA,f.jx,p.lQ,p.fz,p.UA,p.Mo,k.p,T.Hq,N.UN,A.H,U.FN,J.o,F.o,w.V,P],styles:[".rowStyle[_ngcontent-%COMP%]{width:14%;min-width:10rem}.rowStyleId[_ngcontent-%COMP%]{width:10%;min-width:6rem}"]})),l})()}];let _t=(()=>{class l{}return(0,a.Z)(l,"\u0275fac",function(i){return new(i||l)}),(0,a.Z)(l,"\u0275mod",t.oAB({type:l})),(0,a.Z)(l,"\u0275inj",t.cJS({imports:[S.m,y.Bz.forChild(pt)]})),l})()}}]);