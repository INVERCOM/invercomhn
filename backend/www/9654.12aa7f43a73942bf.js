"use strict";(self.webpackChunkmyadminhn=self.webpackChunkmyadminhn||[]).push([[9654],{9654:(j,h,a)=>{a.r(h),a.d(h,{ImpuestosModule:()=>K});var o=a(1180),y=a(7246),g=a(1380),c=a(805),D=a(7579),S=a(2722),x=a(4004),m=a(5698),t=a(4650),F=a(2340),N=a(529),v=a(629);let _=(()=>{class s{constructor(i,e,n){(0,o.Z)(this,"http",void 0),(0,o.Z)(this,"authS",void 0),(0,o.Z)(this,"router",void 0),(0,o.Z)(this,"_prefix",F.H+"/api/impuestos"),this.http=i,this.authS=e,this.router=n}getAll(){this.authS.refreshToken();const i={cia_nids:this.authS.isValidCia(!1)};return this.http.post(this._prefix+"/getall",i)}save(i){const e={...i,...this.authS.getUsuarioLog()};return this.http.post(this._prefix+"/save",e)}setSts(i){return this.http.post(this._prefix+"/setsts/"+i.isv_nid,{isv_nsts:i.isv_nsts,...this.authS.getUsuarioLog()})}setBulkSts(i){return this.http.post(this._prefix+"/setbullksts",{data:i,...this.authS.getUsuarioLog()})}getCompanias(){const i={cia_nids:this.authS.isValidCia(!1)};return this.http.post(this._prefix+"/getallcompanias",i)}}return(0,o.Z)(s,"\u0275fac",function(i){return new(i||s)(t.LFG(N.eN),t.LFG(v.e),t.LFG(g.F0))}),(0,o.Z)(s,"\u0275prov",t.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"})),s})();var f=a(1168),b=a(6895),u=a(99),k=a(3388),Z=a(5593),C=a(1795),w=a(2453),J=a(1383),T=a(1740),U=a(1493),p=a(4006);let M=(()=>{class s{constructor(i,e,n,l){(0,o.Z)(this,"dbapi",void 0),(0,o.Z)(this,"_builder",void 0),(0,o.Z)(this,"authS",void 0),(0,o.Z)(this,"skNsCore",void 0),(0,o.Z)(this,"createForm",void 0),(0,o.Z)(this,"guardando",!1),(0,o.Z)(this,"itemDialog",!1),(0,o.Z)(this,"submitted",!1),(0,o.Z)(this,"impuesto",{}),(0,o.Z)(this,"edit",new t.vpe),this.dbapi=i,this._builder=e,this.authS=n,this.skNsCore=l,this.createForm=e.group({isv_nid:[0],isv_vdescripcion:["",p.kI.required],isv_nvalor:["",p.kI.required],isv_nsts:[""]})}ngOnInit(){}ngOnChanges(){this.impuesto&&this.impuesto?.isv_nid&&this.impuesto?.isv_nid>0&&(this.isv_nid?.setValue(this.impuesto?.isv_nid),this.isv_vdescripcion?.setValue(this.impuesto?.isv_vdescripcion),this.isv_nvalor?.setValue(this.impuesto?.isv_nvalor),this.isv_nsts?.setValue(this.impuesto?.isv_nsts))}save(){if(this.createForm.valid&&!this.guardando){this.guardando=!0;const i={isv_nid:this.isv_nid?.value>0?this.isv_nid?.value:null,isv_vdescripcion:this.isv_vdescripcion?.value.trim().toUpperCase(),isv_nvalor:this.isv_nvalor?.value,isv_nsts:1};this.dbapi.save(i).pipe((0,m.q)(1)).subscribe({next:e=>{"success"==e.type&&(this.skNsCore.notificarUpsert("/inventario/impuestos",this.authS.isValidCia(!1).toString(),this.authS.usuario.user_nid.toString(),!0),this.limpiarForm()),this.edit.emit(e),this.guardando=!1},error:e=>{console.log(e),this.guardando=!1,this.edit.emit({type:"error",title:"Ha ocurrido un error",message:e})}})}}limpiarForm(){this.createForm.reset(),this.isv_nid?.setValue(0)}hideDialog(){this.itemDialog=!1,this.submitted=!1}searchById(i,e){for(let n=0;n<e.length;n++){const l=e[n];if(l.id==i)return l}return""}get isv_nid(){return this.createForm.get("isv_nid")}get isv_vdescripcion(){return this.createForm.get("isv_vdescripcion")}get isv_nvalor(){return this.createForm.get("isv_nvalor")}get isv_nsts(){return this.createForm.get("isv_nsts")}}return(0,o.Z)(s,"\u0275fac",function(i){return new(i||s)(t.Y36(_),t.Y36(p.qu),t.Y36(v.e),t.Y36(f.pP))}),(0,o.Z)(s,"\u0275cmp",t.Xpm({type:s,selectors:[["app-create-impuestos"]],inputs:{impuesto:"impuesto"},outputs:{edit:"edit"},features:[t.TTD],decls:20,vars:16,consts:[[1,"row"],[1,"col-12"],[1,"card"],[1,"form-horizontal",3,"formGroup","ngSubmit"],[1,"field","grid"],["htmlFor","name3",1,"col-12","mb-2","md:col-2","md:mb-0","text-900"],[1,"col-12","md:col-10"],["pInputText","","formControlName","isv_vdescripcion","type","text","required","",2,"text-transform","uppercase"],["pInputText","","formControlName","isv_nvalor","type","number","required",""],[1,"col-5"],[1,"p-buttonset"],["pButton","","pRipple","","icon","pi pi-save","type","submit",1,"p-button-success","mr-1","btn-sm",3,"disabled","loading","label"],["pButton","","pRipple","","label","Limpiar","icon","pi pi-trash","type","button",1,"p-button-danger","btn-sm",3,"click"]],template:function(i,e){1&i&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"form",3),t.NdJ("ngSubmit",function(){return e.save()}),t.TgZ(4,"div",4)(5,"label",5),t._uU(6,"Descripci\xf3n"),t.qZA(),t.TgZ(7,"div",6),t._UZ(8,"input",7),t.qZA()(),t.TgZ(9,"div",4)(10,"label",5),t._uU(11,"Valor"),t.qZA(),t.TgZ(12,"div",6),t._UZ(13,"input",8),t.qZA()(),t._UZ(14,"hr"),t.TgZ(15,"div",4)(16,"div",9)(17,"span",10),t._UZ(18,"button",11),t.TgZ(19,"button",12),t.NdJ("click",function(){return e.limpiarForm()}),t.qZA()()()()()()()()),2&i&&(t.xp6(3),t.Q6J("formGroup",e.createForm),t.xp6(5),t.ekj("ng-invalid",(null==e.isv_vdescripcion?null:e.isv_vdescripcion.invalid)&&(null==e.isv_vdescripcion?null:e.isv_vdescripcion.touched))("ng-dirty",(null==e.isv_vdescripcion?null:e.isv_vdescripcion.invalid)&&(null==e.isv_vdescripcion?null:e.isv_vdescripcion.touched))("ng-valid",(null==e.isv_vdescripcion?null:e.isv_vdescripcion.valid)&&((null==e.isv_vdescripcion?null:e.isv_vdescripcion.touched)||(null==e.isv_vdescripcion?null:e.isv_vdescripcion.dirty))),t.xp6(5),t.ekj("ng-invalid",(null==e.isv_nvalor?null:e.isv_nvalor.invalid)&&(null==e.isv_nvalor?null:e.isv_nvalor.touched))("ng-dirty",(null==e.isv_nvalor?null:e.isv_nvalor.invalid)&&(null==e.isv_nvalor?null:e.isv_nvalor.touched))("ng-valid",(null==e.isv_nvalor?null:e.isv_nvalor.valid)&&((null==e.isv_nvalor?null:e.isv_nvalor.touched)||(null==e.isv_nvalor?null:e.isv_nvalor.dirty))),t.xp6(5),t.Q6J("disabled",!e.createForm.valid)("loading",e.guardando)("label",e.impuesto&&e.impuesto.isv_nid?"Editar":"Guardar"))},dependencies:[p._Y,p.Fj,p.wV,p.JJ,p.JL,p.Q7,p.sg,p.u,Z.Hq,C.H,T.o],styles:[".ng-valid[_ngcontent-%COMP%]{border-color:#2ecc71!important}"]})),s})();function q(s,r){1&s&&(t.TgZ(0,"div",22)(1,"h3",23),t._uU(2,"Listado de impuestos"),t.qZA()())}function E(s,r){if(1&s){const i=t.EpF();t._UZ(0,"p-fileUpload",24),t.TgZ(1,"button",25),t.NdJ("click",function(){t.CHM(i),t.oxw();const n=t.MAs(8);return t.KtG(n.exportCSV())}),t.qZA()}2&s&&t.Q6J("maxFileSize",1e6)}function H(s,r){if(1&s){const i=t.EpF();t.TgZ(0,"div",26)(1,"span",27)(2,"input",28),t.NdJ("input",function(n){t.CHM(i);const l=t.oxw(),d=t.MAs(8);return t.KtG(l.onGlobalFilter(d,n))}),t.qZA(),t.TgZ(3,"button",29),t.NdJ("click",function(){t.CHM(i);const n=t.oxw();return t.KtG(n.getData())}),t.qZA(),t.TgZ(4,"button",30),t.NdJ("click",function(){t.CHM(i);const n=t.oxw();return t.KtG(n.openNew())}),t.qZA(),t.TgZ(5,"button",31),t.NdJ("click",function(){t.CHM(i);const n=t.oxw();return t.KtG(n.deleteSelectedItems())}),t.qZA()()()}if(2&s){const i=t.oxw();t.xp6(5),t.Q6J("disabled",!i.selectedData||!i.selectedData.length)}}function G(s,r){if(1&s&&(t.TgZ(0,"th",34),t._uU(1),t._UZ(2,"p-sortIcon",35),t.qZA()),2&s){const i=r.$implicit;t.ekj("rowStyle","ID"!==i.header)("rowStyleId","ID"===i.header),t.Q6J("pSortableColumn",i.field),t.xp6(1),t.hij(" ",i.header," "),t.xp6(1),t.Q6J("field",i.field)}}function Y(s,r){if(1&s&&(t.TgZ(0,"tr")(1,"th",32),t._UZ(2,"p-tableHeaderCheckbox"),t.qZA(),t.TgZ(3,"th"),t._uU(4,"Acciones"),t.qZA(),t.YNc(5,G,3,7,"th",33),t.qZA()),2&s){const i=t.oxw();t.xp6(5),t.Q6J("ngForOf",i.cols)}}function B(s,r){if(1&s&&(t.TgZ(0,"td")(1,"span",41),t._uU(2),t.qZA(),t._uU(3),t.qZA()),2&s){const i=r.$implicit,e=t.oxw().$implicit;t.xp6(2),t.Oqu(i.header),t.xp6(1),t.hij(" ",e[i.field]," ")}}function O(s,r){if(1&s){const i=t.EpF();t.TgZ(0,"tr")(1,"td"),t._UZ(2,"p-tableCheckbox",36),t.qZA(),t.TgZ(3,"td")(4,"div",37)(5,"button",38),t.NdJ("click",function(){const l=t.CHM(i).$implicit,d=t.oxw();return t.KtG(d.editRow(l))}),t.qZA(),t.TgZ(6,"button",39),t.NdJ("click",function(){const l=t.CHM(i).$implicit,d=t.oxw();return t.KtG(d.deleteRow(l))}),t.qZA()()(),t.YNc(7,B,4,2,"td",40),t.qZA()}if(2&s){const i=r.$implicit,e=t.oxw();t.xp6(2),t.Q6J("value",i),t.xp6(5),t.Q6J("ngForOf",e.cols)}}function R(s,r){if(1&s&&(t.TgZ(0,"span"),t._uU(1,"Estas seguro que quieres eliminar "),t.TgZ(2,"b"),t._uU(3),t.qZA(),t._uU(4,"?"),t.qZA()),2&s){const i=t.oxw();t.xp6(3),t.Oqu(i.item.isv_vdescripcion)}}function Q(s,r){if(1&s){const i=t.EpF();t.TgZ(0,"button",42),t.NdJ("click",function(){t.CHM(i);const n=t.oxw();return t.KtG(n.deleteItemDialog=!1)}),t.qZA(),t.TgZ(1,"button",43),t.NdJ("click",function(){t.CHM(i);const n=t.oxw();return t.KtG(n.confirmDelete())}),t.qZA()}}function L(s,r){if(1&s){const i=t.EpF();t.TgZ(0,"button",42),t.NdJ("click",function(){t.CHM(i);const n=t.oxw();return t.KtG(n.deleteItemsDialog=!1)}),t.qZA(),t.TgZ(1,"button",43),t.NdJ("click",function(){t.CHM(i);const n=t.oxw();return t.KtG(n.confirmDeleteSelected())}),t.qZA()}}const V=function(){return[10,20,30]},I=function(){return{width:"750px"}},A=function(){return{width:"450px"}},P=[{path:"",component:(()=>{class s{constructor(i,e,n,l){(0,o.Z)(this,"dbapi",void 0),(0,o.Z)(this,"messageService",void 0),(0,o.Z)(this,"authS",void 0),(0,o.Z)(this,"skNsCore",void 0),(0,o.Z)(this,"createDialog",!1),(0,o.Z)(this,"editDialog",!1),(0,o.Z)(this,"deleteItemDialog",!1),(0,o.Z)(this,"deleteItemsDialog",!1),(0,o.Z)(this,"isLoadingTable",!1),(0,o.Z)(this,"data",[]),(0,o.Z)(this,"item",{}),(0,o.Z)(this,"selectedData",[]),(0,o.Z)(this,"submitted",!1),(0,o.Z)(this,"cols",[]),(0,o.Z)(this,"statuses",[]),(0,o.Z)(this,"rowsPerPageOptions",[5,10,20]),(0,o.Z)(this,"$destroy",new D.x),this.dbapi=i,this.messageService=e,this.authS=n,this.skNsCore=l,l.fromEvent("/inventario/impuestos").pipe((0,S.R)(this.$destroy)).subscribe(d=>{this.skNsCore.socketId!=d&&(console.log("Event socket: impuestos"),this.getData())}),this.cols=[{field:"isv_nid",header:"ID"},{field:"isv_vdescripcion",header:"Descripci\xf3n"},{field:"isv_nvalor",header:"Valor"},{field:"isv_vsts",header:"Estado"}],this.getData()}getData(){this.isLoadingTable=!0,this.dbapi.getAll().pipe((0,x.U)(i=>(i.forEach(e=>{e.cia_vnombre=e.cias?e.cias.cia_vnombre:"",e.isv_vsts=1==e.isv_nsts?"ACTIVO":"ELIMINADO"}),i)),(0,m.q)(1)).subscribe({next:i=>{this.data=[...i],this.isLoadingTable=!1},error:i=>{console.log(i),this.isLoadingTable=!1,this.editEvent({type:"error",title:"Ha ocurrido un error",message:i})}})}ngOnInit(){}openNew(){this.item={},this.submitted=!1,this.createDialog=!0}deleteSelectedData(){this.deleteItemsDialog=!0}editRow(i){this.item={...i},this.editDialog=!0}deleteRow(i){this.deleteItemDialog=!0,this.item={...i}}confirmDeleteSelected(){const i=[];this.selectedData.forEach(e=>{i.push({isv_nid:e.isv_nid,isv_nsts:0})}),this.dbapi.setBulkSts(i).pipe((0,m.q)(1)).subscribe({next:e=>{this.messageService.add({severity:e.type,summary:e.title,detail:e.message,life:3e3}),"success"==e.type&&(this.skNsCore.notificarUpsert("/inventario/impuestos",this.authS.isValidCia(!1).toString(),this.authS.usuario.user_nid.toString(),!0),this.deleteItemsDialog=!1,this.selectedData=[],this.getData())},error:e=>{console.log(e),this.editEvent({type:"error",title:"Ha ocurrido un error",message:e})}})}confirmDelete(){this.dbapi.setSts({isv_nid:this.item.isv_nid,isv_nsts:0}).pipe((0,m.q)(1)).subscribe({next:e=>{this.skNsCore.notificarUpsert("/inventario/impuestos",this.authS.isValidCia(!1).toString(),this.authS.usuario.user_nid.toString(),!0),this.messageService.add({severity:e.type,summary:e.title,detail:e.message,life:3e3}),this.deleteItemDialog=!1,this.item={},this.getData()},error:e=>{console.log(e),this.editEvent({type:"error",title:"Ha ocurrido un error",message:e})}})}findIndexById(i){let e=-1;for(let n=0;n<this.data.length;n++)if(this.data[n].isv_nid===i){e=n;break}return e}onGlobalFilter(i,e){i.filterGlobal(e.target.value,"contains")}deleteSelectedItems(){this.deleteItemsDialog=!0}editEvent(i){this.messageService.add({severity:i.type,summary:i.title,detail:i.message,life:3e3}),"success"==i.type&&(this.getData(),this.createDialog=!1,this.editDialog=!1)}ngOnDestroy(){this.$destroy.next(),this.$destroy.complete()}}return(0,o.Z)(s,"\u0275fac",function(i){return new(i||s)(t.Y36(_),t.Y36(c.ez),t.Y36(v.e),t.Y36(f.pP))}),(0,o.Z)(s,"\u0275cmp",t.Xpm({type:s,selectors:[["ng-component"]],features:[t._Bn([c.ez])],decls:27,vars:34,consts:[[1,"grid"],[1,"col-12"],[1,"card","px-6","py-6"],["position","bottom-right"],["styleClass","mb-4"],["pTemplate","left"],["pTemplate","right"],["responsiveLayout","scroll","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries","selectionMode","multiple","dataKey","isv_nid",3,"value","columns","rows","globalFilterFields","paginator","loading","rowsPerPageOptions","showCurrentPageReport","selection","rowHover","selectionChange"],["dt",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["header","Crear impuesto",1,"p-fluid",3,"visible","modal","visibleChange"],[3,"edit"],["header","Editar impuesto",1,"p-fluid",3,"visible","modal","visibleChange"],[3,"impuesto","edit"],["header","Confirmar...",3,"visible","modal","visibleChange"],[1,"flex","align-items-center","justify-content-center"],[1,"pi","pi-exclamation-triangle","mr-3",2,"font-size","2rem"],[4,"ngIf"],["pTemplate","footer"],["header","Confirmar",3,"visible","modal","visibleChange"],[1,"my-2"],[1,"mb-2"],["mode","basic","accept","image/*","label","Import","chooseLabel","Import",1,"mr-2","inline-block",3,"maxFileSize"],["pButton","","pRipple","","label","Export","icon","pi pi-upload",1,"p-button-help",3,"click"],[1,"flex","flex-column","md:flex-row","md:justify-content-between","md:align-items-center"],[1,"block","mt-2","md:mt-0","p-input-icon-rigth"],["pInputText","","type","text","placeholder","Buscar...",1,"w-full","sm:w-auto","mr-1",3,"input"],["pButton","","pRipple","","label","","icon","pi pi-sync",1,"p-button-secondary","mr-1","ml-1",3,"click"],["pButton","","pRipple","","label","Crear","icon","pi pi-plus",1,"p-button-success","mr-1","ml-1",3,"click"],["pButton","","pRipple","","label","Eliminar","icon","pi pi-trash",1,"p-button-danger","mr-1","ml-1",3,"disabled","click"],[2,"width","3rem"],["style","width: 100rem",3,"pSortableColumn","rowStyle","rowStyleId",4,"ngFor","ngForOf"],[2,"width","100rem",3,"pSortableColumn"],[3,"field"],[3,"value"],[1,"flex"],["pButton","","pRipple","","icon","pi pi-pencil",1,"p-button-success","mr-1",3,"click"],["pButton","","pRipple","","icon","pi pi-trash",1,"p-button-danger",3,"click"],[4,"ngFor","ngForOf"],[1,"p-column-title"],["pButton","","pRipple","","icon","pi pi-times","label","No",1,"p-button-outlined","p-button-secondary",3,"click"],["pButton","","pRipple","","icon","pi pi-check","label","Si",1,"p-button-outlined","p-button-danger",3,"click"]],template:function(i,e){1&i&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2),t._UZ(3,"p-toast",3),t.TgZ(4,"p-toolbar",4),t.YNc(5,q,3,0,"ng-template",5),t.YNc(6,E,2,1,"ng-template",6),t.qZA(),t.TgZ(7,"p-table",7,8),t.NdJ("selectionChange",function(l){return e.selectedData=l}),t.YNc(9,H,6,1,"ng-template",9),t.YNc(10,Y,6,1,"ng-template",10),t.YNc(11,O,8,2,"ng-template",11),t.qZA()(),t.TgZ(12,"p-dialog",12),t.NdJ("visibleChange",function(l){return e.createDialog=l}),t.TgZ(13,"app-create-impuestos",13),t.NdJ("edit",function(l){return e.editEvent(l)}),t.qZA()(),t.TgZ(14,"p-dialog",14),t.NdJ("visibleChange",function(l){return e.editDialog=l}),t.TgZ(15,"app-create-impuestos",15),t.NdJ("edit",function(l){return e.editEvent(l)}),t.qZA()(),t.TgZ(16,"p-dialog",16),t.NdJ("visibleChange",function(l){return e.deleteItemDialog=l}),t.TgZ(17,"div",17),t._UZ(18,"i",18),t.YNc(19,R,5,1,"span",19),t.qZA(),t.YNc(20,Q,2,0,"ng-template",20),t.qZA(),t.TgZ(21,"p-dialog",21),t.NdJ("visibleChange",function(l){return e.deleteItemsDialog=l}),t.TgZ(22,"div",17),t._UZ(23,"i",18),t.TgZ(24,"span"),t._uU(25,"\xbfEst\xe1 seguro de que desea eliminar los elementos seleccionados?"),t.qZA()(),t.YNc(26,L,2,0,"ng-template",20),t.qZA()()()),2&i&&(t.xp6(7),t.Q6J("value",e.data)("columns",e.cols)("rows",10)("globalFilterFields",e.cols)("rows",10)("paginator",!0)("loading",e.isLoadingTable)("rowsPerPageOptions",t.DdM(29,V))("showCurrentPageReport",!0)("selection",e.selectedData)("rowHover",!0),t.xp6(5),t.Akn(t.DdM(30,I)),t.Q6J("visible",e.createDialog)("modal",!0),t.xp6(2),t.Akn(t.DdM(31,I)),t.Q6J("visible",e.editDialog)("modal",!0),t.xp6(1),t.Q6J("impuesto",e.item),t.xp6(1),t.Akn(t.DdM(32,A)),t.Q6J("visible",e.deleteItemDialog)("modal",!0),t.xp6(3),t.Q6J("ngIf",e.item),t.xp6(2),t.Akn(t.DdM(33,A)),t.Q6J("visible",e.deleteItemsDialog)("modal",!0))},dependencies:[b.sg,b.O5,u.iA,c.jx,u.lQ,u.fz,u.UA,u.Mo,k.p,Z.Hq,C.H,w.FN,J.o,T.o,U.V,M],styles:[".rowStyle[_ngcontent-%COMP%]{width:14%;min-width:10rem}.rowStyleId[_ngcontent-%COMP%]{width:10%;min-width:6rem}"]})),s})()}];let K=(()=>{class s{}return(0,o.Z)(s,"\u0275fac",function(i){return new(i||s)}),(0,o.Z)(s,"\u0275mod",t.oAB({type:s})),(0,o.Z)(s,"\u0275inj",t.cJS({imports:[y.m,g.Bz.forChild(P)]})),s})()}}]);