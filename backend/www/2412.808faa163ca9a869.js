"use strict";(self.webpackChunkmyadminhn=self.webpackChunkmyadminhn||[]).push([[2412],{2412:(ie,C,s)=>{s.r(C),s.d(C,{CompaniasModule:()=>ee});var a=s(1180),Z=s(1380),u=s(805),T=s(4004),p=s(5698),e=s(4650),y=s(2340),M=s(529),w=s(629);let _=(()=>{class o{constructor(t,i,n){(0,a.Z)(this,"http",void 0),(0,a.Z)(this,"authS",void 0),(0,a.Z)(this,"router",void 0),(0,a.Z)(this,"_prefix",y.H+"/api/companias"),this.http=t,this.authS=i,this.router=n}getAll(){return this.authS.refreshToken(),this.http.post(this._prefix+"/getall",{})}save(t){const i={...t,...this.authS.getUsuarioLog()};return this.http.post(this._prefix+"/save",i)}setSts(t){return this.http.post(this._prefix+"/setsts/"+t.cia_nid,{cia_nsts:t.cia_nsts,...this.authS.getUsuarioLog()})}setBulkSts(t){return this.http.post(this._prefix+"/setbullksts",{data:t,...this.authS.getUsuarioLog()})}getMonedas(){return this.http.post(this._prefix+"/getallmonedas",{})}getAsigModulosCias(t){return this.http.post(this._prefix+"/asigciasmodulos/getall/"+t,{})}saveAsigModulosCias(t,i){const n={asig:i,...this.authS.getUsuarioLog()};return this.http.post(this._prefix+"/asigciasmodulos/save/"+t,n)}getModulos(){return this.http.post(this._prefix+"/getallmodulos",{})}}return(0,a.Z)(o,"\u0275fac",function(t){return new(t||o)(e.LFG(M.eN),e.LFG(w.e),e.LFG(Z.F0))}),(0,a.Z)(o,"\u0275prov",e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"})),o})();var g=s(6895),m=s(99),k=s(3388),h=s(5593),v=s(1795),D=s(2453),q=s(1383),f=s(1740),F=s(1493),c=s(433),N=s(2210);let I=(()=>{class o{constructor(t,i){(0,a.Z)(this,"dbapi",void 0),(0,a.Z)(this,"_builder",void 0),(0,a.Z)(this,"createForm",void 0),(0,a.Z)(this,"monedas",[]),(0,a.Z)(this,"guardando",!1),(0,a.Z)(this,"itemDialog",!1),(0,a.Z)(this,"submitted",!1),(0,a.Z)(this,"compania",{}),(0,a.Z)(this,"edit",new e.vpe),this.dbapi=t,this._builder=i,this.createForm=i.group({cia_nid:[0],cia_vnombre:["",c.kI.required],cia_vnombrecomercial:["",c.kI.required],cia_vdireccion:["",c.kI.required],cia_vtelefono:["",c.kI.required],cia_vrtn:["",c.kI.required],cia_vcorreo:[""],mone_nid:["",c.kI.required],cia_nsts:[""]}),this.getMonedas()}ngOnInit(){}ngOnChanges(){this.compania&&this.compania?.cia_nid&&this.compania?.cia_nid>0&&(this.cia_nid?.setValue(this.compania?.cia_nid),this.cia_vnombre?.setValue(this.compania?.cia_vnombre),this.cia_vnombrecomercial?.setValue(this.compania?.cia_vnombrecomercial),this.cia_vdireccion?.setValue(this.compania?.cia_vdireccion),this.cia_vtelefono?.setValue(this.compania?.cia_vtelefono),this.cia_vrtn?.setValue(this.compania?.cia_vrtn),this.cia_vcorreo?.setValue(this.compania?.cia_vcorreo),this.mone_nid?.setValue(this.searchById(this.compania?.mone_nid,this.monedas)))}getMonedas(){this.monedas=[{id:"",text:"...",obj:{}}],this.mone_nid?.setValue(""),this.dbapi.getMonedas().pipe((0,p.q)(1)).subscribe({next:t=>{if(t&&null!=t&&""!==t)for(const i in t)this.monedas=[...this.monedas,{id:t[i].mone_nid,text:t[i].mone_vnombre,obj:t[i]}];else console.log("Error consultando unidades de medida")},error:t=>{console.log(t),this.edit.emit({type:"error",title:"Ha ocurrido un error",message:t})}})}save(){if(this.createForm.valid&&!this.guardando){this.guardando=!0;const t={cia_nid:this.cia_nid?.value>0?this.cia_nid?.value:null,cia_vnombre:this.cia_vnombre?.value.trim().toUpperCase(),cia_vnombrecomercial:this.cia_vnombrecomercial?.value.trim().toUpperCase(),cia_vdireccion:this.cia_vdireccion?.value.trim().toUpperCase(),cia_vtelefono:this.cia_vtelefono?.value,cia_vrtn:this.cia_vrtn?.value,cia_vcorreo:this.cia_vcorreo?.value.trim().toLowerCase(),mone_nid:this.mone_nid?.value.id,cia_nsts:1};this.dbapi.save(t).pipe((0,p.q)(1)).subscribe({next:i=>{"success"==i.type&&this.limpiarForm(),this.guardando=!1,this.edit.emit(i)},error:i=>{console.log(i),this.guardando=!1,this.edit.emit({type:"error",title:"Ha ocurrido un error",message:i})}})}}limpiarForm(){this.createForm.reset(),this.cia_nid?.setValue(0)}hideDialog(){this.itemDialog=!1,this.submitted=!1}searchById(t,i){for(let n=0;n<i.length;n++){const l=i[n];if(l.id==t)return l}return""}get cia_nid(){return this.createForm.get("cia_nid")}get cia_vnombre(){return this.createForm.get("cia_vnombre")}get cia_vnombrecomercial(){return this.createForm.get("cia_vnombrecomercial")}get cia_vdireccion(){return this.createForm.get("cia_vdireccion")}get cia_vtelefono(){return this.createForm.get("cia_vtelefono")}get cia_vrtn(){return this.createForm.get("cia_vrtn")}get cia_vcorreo(){return this.createForm.get("cia_vcorreo")}get mone_nid(){return this.createForm.get("mone_nid")}get cia_nsts(){return this.createForm.get("cia_nsts")}}return(0,a.Z)(o,"\u0275fac",function(t){return new(t||o)(e.Y36(_),e.Y36(c.qu))}),(0,a.Z)(o,"\u0275cmp",e.Xpm({type:o,selectors:[["app-create-companias"]],inputs:{compania:"compania"},outputs:{edit:"edit"},features:[e.TTD],decls:45,vars:50,consts:[[1,"row"],[1,"col-12"],[1,"card"],[1,"form-horizontal",3,"formGroup","ngSubmit"],[1,"field","grid"],["htmlFor","name3",1,"col-12","mb-2","md:col-2","md:mb-0","text-900"],[1,"col-12","md:col-10"],["pInputText","","formControlName","cia_vnombre","type","text","required","",2,"text-transform","uppercase"],["pInputText","","formControlName","cia_vnombrecomercial","type","text","required","",2,"text-transform","uppercase"],["optionLabel","text","formControlName","mone_nid","filterBy","text",3,"options","filter","virtualScroll","virtualScrollItemSize"],["pInputText","","formControlName","cia_vdireccion","type","text","required","",2,"text-transform","uppercase"],["pInputText","","formControlName","cia_vtelefono","type","number","required",""],["pInputText","","formControlName","cia_vrtn","type","number","required",""],["pInputText","","formControlName","cia_vcorreo","type","text",2,"text-transform","lowercase"],[1,"col-5"],[1,"p-buttonset"],["pButton","","pRipple","","icon","pi pi-save","type","submit",1,"p-button-success","mr-1","btn-sm",3,"disabled","loading","label"],["pButton","","pRipple","","label","Limpiar","icon","pi pi-trash","type","button",1,"p-button-danger","btn-sm",3,"click"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"form",3),e.NdJ("ngSubmit",function(){return i.save()}),e.TgZ(4,"div",4)(5,"label",5),e._uU(6,"Nombre"),e.qZA(),e.TgZ(7,"div",6),e._UZ(8,"input",7),e.qZA()(),e.TgZ(9,"div",4)(10,"label",5),e._uU(11,"Nombre comercial"),e.qZA(),e.TgZ(12,"div",6),e._UZ(13,"input",8),e.qZA()(),e.TgZ(14,"div",4)(15,"label",5),e._uU(16,"Moneda"),e.qZA(),e.TgZ(17,"div",6),e._UZ(18,"p-dropdown",9),e.qZA()(),e.TgZ(19,"div",4)(20,"label",5),e._uU(21,"Direcci\xf3n"),e.qZA(),e.TgZ(22,"div",6),e._UZ(23,"input",10),e.qZA()(),e.TgZ(24,"div",4)(25,"label",5),e._uU(26,"Tel\xe9fono"),e.qZA(),e.TgZ(27,"div",6),e._UZ(28,"input",11),e.qZA()(),e.TgZ(29,"div",4)(30,"label",5),e._uU(31,"RTN"),e.qZA(),e.TgZ(32,"div",6),e._UZ(33,"input",12),e.qZA()(),e.TgZ(34,"div",4)(35,"label",5),e._uU(36,"Correo"),e.qZA(),e.TgZ(37,"div",6),e._UZ(38,"input",13),e.qZA()(),e._UZ(39,"hr"),e.TgZ(40,"div",4)(41,"div",14)(42,"span",15),e._UZ(43,"button",16),e.TgZ(44,"button",17),e.NdJ("click",function(){return i.limpiarForm()}),e.qZA()()()()()()()()),2&t&&(e.xp6(3),e.Q6J("formGroup",i.createForm),e.xp6(5),e.ekj("ng-invalid",(null==i.cia_vnombre?null:i.cia_vnombre.invalid)&&(null==i.cia_vnombre?null:i.cia_vnombre.touched))("ng-dirty",(null==i.cia_vnombre?null:i.cia_vnombre.invalid)&&(null==i.cia_vnombre?null:i.cia_vnombre.touched))("ng-valid",(null==i.cia_vnombre?null:i.cia_vnombre.valid)&&((null==i.cia_vnombre?null:i.cia_vnombre.touched)||(null==i.cia_vnombre?null:i.cia_vnombre.dirty))),e.xp6(5),e.ekj("ng-invalid",(null==i.cia_vnombrecomercial?null:i.cia_vnombrecomercial.invalid)&&(null==i.cia_vnombrecomercial?null:i.cia_vnombrecomercial.touched))("ng-dirty",(null==i.cia_vnombrecomercial?null:i.cia_vnombrecomercial.invalid)&&(null==i.cia_vnombrecomercial?null:i.cia_vnombrecomercial.touched))("ng-valid",(null==i.cia_vnombrecomercial?null:i.cia_vnombrecomercial.valid)&&((null==i.cia_vnombrecomercial?null:i.cia_vnombrecomercial.touched)||(null==i.cia_vnombrecomercial?null:i.cia_vnombrecomercial.dirty))),e.xp6(5),e.ekj("ng-invalid",(null==i.mone_nid?null:i.mone_nid.invalid)&&(null==i.mone_nid?null:i.mone_nid.touched))("ng-dirty",(null==i.mone_nid?null:i.mone_nid.invalid)&&(null==i.mone_nid?null:i.mone_nid.touched))("ng-valid",(null==i.mone_nid?null:i.mone_nid.valid)&&((null==i.mone_nid?null:i.mone_nid.touched)||(null==i.mone_nid?null:i.mone_nid.dirty))),e.Q6J("options",i.monedas)("filter",!0)("virtualScroll",i.monedas.length>5)("virtualScrollItemSize",38),e.xp6(5),e.ekj("ng-invalid",(null==i.cia_vdireccion?null:i.cia_vdireccion.invalid)&&(null==i.cia_vdireccion?null:i.cia_vdireccion.touched))("ng-dirty",(null==i.cia_vdireccion?null:i.cia_vdireccion.invalid)&&(null==i.cia_vdireccion?null:i.cia_vdireccion.touched))("ng-valid",(null==i.cia_vdireccion?null:i.cia_vdireccion.valid)&&((null==i.cia_vdireccion?null:i.cia_vdireccion.touched)||(null==i.cia_vdireccion?null:i.cia_vdireccion.dirty))),e.xp6(5),e.ekj("ng-invalid",(null==i.cia_vtelefono?null:i.cia_vtelefono.invalid)&&(null==i.cia_vtelefono?null:i.cia_vtelefono.touched))("ng-dirty",(null==i.cia_vtelefono?null:i.cia_vtelefono.invalid)&&(null==i.cia_vtelefono?null:i.cia_vtelefono.touched))("ng-valid",(null==i.cia_vtelefono?null:i.cia_vtelefono.valid)&&((null==i.cia_vtelefono?null:i.cia_vtelefono.touched)||(null==i.cia_vtelefono?null:i.cia_vtelefono.dirty))),e.xp6(5),e.ekj("ng-invalid",(null==i.cia_vrtn?null:i.cia_vrtn.invalid)&&(null==i.cia_vrtn?null:i.cia_vrtn.touched))("ng-dirty",(null==i.cia_vrtn?null:i.cia_vrtn.invalid)&&(null==i.cia_vrtn?null:i.cia_vrtn.touched))("ng-valid",(null==i.cia_vrtn?null:i.cia_vrtn.valid)&&((null==i.cia_vrtn?null:i.cia_vrtn.touched)||(null==i.cia_vrtn?null:i.cia_vrtn.dirty))),e.xp6(5),e.ekj("ng-invalid",(null==i.cia_vcorreo?null:i.cia_vcorreo.invalid)&&(null==i.cia_vcorreo?null:i.cia_vcorreo.touched))("ng-dirty",(null==i.cia_vcorreo?null:i.cia_vcorreo.invalid)&&(null==i.cia_vcorreo?null:i.cia_vcorreo.touched))("ng-valid",(null==i.cia_vcorreo?null:i.cia_vcorreo.valid)&&((null==i.cia_vcorreo?null:i.cia_vcorreo.touched)||(null==i.cia_vcorreo?null:i.cia_vcorreo.dirty))),e.xp6(5),e.Q6J("disabled",!i.createForm.valid)("loading",i.guardando)("label",i.compania&&i.compania.cia_nid?"Editar":"Guardar"))},dependencies:[c._Y,c.Fj,c.wV,c.JJ,c.JL,c.Q7,c.sg,c.u,h.Hq,v.H,f.o,N.Lt],styles:[".ng-valid[_ngcontent-%COMP%]{border-color:#2ecc71!important}"]})),o})();function J(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"div",12)(1,"span",13)(2,"input",14),e.NdJ("input",function(n){e.CHM(t);const l=e.oxw(),d=e.MAs(4);return e.KtG(l.onGlobalFilter(d,n))}),e.qZA(),e.TgZ(3,"button",15),e.NdJ("click",function(n){e.CHM(t);const l=e.oxw();return e.KtG(l.cambiarBtn(n,1))}),e.qZA(),e.TgZ(4,"button",16),e.NdJ("click",function(n){e.CHM(t);const l=e.oxw();return e.KtG(l.cambiarBtn(n,0))}),e.qZA(),e.TgZ(5,"button",17),e.NdJ("click",function(n){e.CHM(t);const l=e.oxw();return e.KtG(l.cambiarBtn(n,-1))}),e.qZA(),e.TgZ(6,"button",18),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.getModulos())}),e.qZA()()()}}function S(o,r){if(1&o&&(e.TgZ(0,"th",22),e._uU(1),e._UZ(2,"p-sortIcon",20),e.qZA()),2&o){const t=r.$implicit;e.ekj("rowStyle","ID"!==t.header)("rowStyleId","ID"===t.header),e.Q6J("pSortableColumn",t.field),e.xp6(1),e.hij(" ",t.header," "),e.xp6(1),e.Q6J("field",t.field)}}function U(o,r){if(1&o&&(e.TgZ(0,"tr")(1,"th",19),e._uU(2," CHK "),e._UZ(3,"p-sortIcon",20),e.qZA(),e.YNc(4,S,3,7,"th",21),e.qZA()),2&o){const t=e.oxw();e.xp6(3),e.Q6J("field","checked"),e.xp6(1),e.Q6J("ngForOf",t.cols)}}function H(o,r){if(1&o&&(e.TgZ(0,"td")(1,"span",27),e._uU(2),e.qZA(),e._uU(3),e.qZA()),2&o){const t=r.$implicit,i=e.oxw().$implicit;e.xp6(2),e.Oqu(t.header),e.xp6(1),e.hij(" ",i[t.field]," ")}}function E(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"tr")(1,"td")(2,"div",23)(3,"label")(4,"input",24),e.NdJ("ngModelChange",function(n){const d=e.CHM(t).$implicit;return e.KtG(d.checked=n)}),e.qZA(),e._UZ(5,"span",25),e.qZA()()(),e.YNc(6,H,4,2,"td",26),e.qZA()}if(2&o){const t=r.$implicit,i=e.oxw();e.xp6(4),e.Q6J("ngModel",t.checked),e.xp6(2),e.Q6J("ngForOf",i.cols)}}const x=function(){return[10,20,30]};let B=(()=>{class o{constructor(t){(0,a.Z)(this,"dbapi",void 0),(0,a.Z)(this,"guardando",!1),(0,a.Z)(this,"isLoadingTable",!1),(0,a.Z)(this,"selectedData",[]),(0,a.Z)(this,"data",[]),(0,a.Z)(this,"cols",[]),(0,a.Z)(this,"compania",{}),(0,a.Z)(this,"edit",new e.vpe),this.dbapi=t,this.cols=[{field:"modu_nid",header:"ID"},{field:"modu_vnombre",header:"Nombre"},{field:"modu_vdescripcion",header:"Descripci\xf3n"}],this.getModulos()}getModulos(){this.isLoadingTable=!0,this.dbapi.getModulos().pipe((0,T.U)(t=>(t.forEach(i=>{i.checked=!1}),t)),(0,p.q)(1)).subscribe({next:t=>{this.data=[...t],this.getAsigModulosCias(),this.isLoadingTable=!1},error:t=>{console.log(t),this.isLoadingTable=!1,this.edit.emit({type:"error",title:"Ha ocurrido un error",message:t})}})}ngOnInit(){}findIndexById(t){let i=-1;for(let n=0;n<this.data.length;n++)if(this.data[n].cia_nid===t){i=n;break}return i}onGlobalFilter(t,i){t.filterGlobal(i.target.value,"contains")}cambiarBtn(t,i){t&&t.preventDefault(),i=1*i||0,this.data.forEach(n=>{n.checked=-1==i?!n.checked:1==i})}ngOnChanges(){this.getAsigModulosCias()}getAsigModulosCias(){this.compania&&this.compania?.cia_nid&&this.compania?.cia_nid>0&&(this.data.forEach(t=>{t.checked=!1}),this.dbapi.getAsigModulosCias(this.compania.cia_nid).pipe((0,p.q)(1)).subscribe({next:t=>{this.data.forEach(i=>{t.forEach(n=>{i.modu_nid===n.modu_nid&&(i.checked=!0)})})},error:t=>{console.log(t),this.edit.emit({type:"error",title:"Ha ocurrido un error",message:t})}}))}saveAsignacion(){const t=[],i=this.compania.cia_nid?this.compania.cia_nid:0;this.data.forEach(n=>{n.checked&&t.push({cia_nid:i,modu_nid:n.modu_nid})}),this.dbapi.saveAsigModulosCias(i,t).pipe((0,p.q)(1)).subscribe({next:n=>{this.edit.emit(n)},error:n=>{console.log(n),this.edit.emit({type:"error",title:"Ha ocurrido un error",message:n})}})}}return(0,a.Z)(o,"\u0275fac",function(t){return new(t||o)(e.Y36(_))}),(0,a.Z)(o,"\u0275cmp",e.Xpm({type:o,selectors:[["app-asig-modulos-companias"]],inputs:{compania:"compania"},outputs:{edit:"edit"},features:[e.TTD],decls:13,vars:14,consts:[[1,"grid"],[1,"col-12"],[1,"card","px-6","py-6"],["responsiveLayout","scroll","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries","selectionMode","multiple","dataKey","modu_nid",3,"value","columns","rows","globalFilterFields","paginator","loading","rowsPerPageOptions","showCurrentPageReport","selection","rowHover","selectionChange"],["dt",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],[1,"field","grid"],[1,"col-3"],[1,"p-buttonset"],["pButton","","pRipple","","icon","pi pi-save","type","button",1,"p-button-success","mr-1","btn-sm",3,"loading","label","click"],[1,"flex","flex-column","md:flex-row","md:justify-content-between","md:align-items-center"],[1,"block","mt-2","md:mt-0","p-input-icon-rigth"],["pInputText","","type","text","placeholder","Buscar...",1,"w-full","sm:w-auto","mr-1",3,"input"],["pButton","","pRipple","","title","Todos","icon","pi pi-check",1,"p-button-primary","ml-1",3,"click"],["pButton","","pRipple","","title","Ninguno","icon","pi pi-times",1,"p-button-primary",3,"click"],["pButton","","pRipple","","title","Invertir","icon","pi pi-circle",1,"p-button-primary",3,"click"],["pButton","","pRipple","","title","Recargar","icon","pi pi-sync",1,"p-button-secondary","ml-1",3,"click"],[2,"width","3rem"],[3,"field"],["style","width: 100rem",3,"pSortableColumn","rowStyle","rowStyleId",4,"ngFor","ngForOf"],[2,"width","100rem",3,"pSortableColumn"],[1,"checkbox","c-checkbox"],["type","checkbox","name","nada",3,"ngModel","ngModelChange"],[1,"fa","fa-check"],[4,"ngFor","ngForOf"],[1,"p-column-title"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"p-table",3,4),e.NdJ("selectionChange",function(l){return i.selectedData=l}),e.YNc(5,J,7,0,"ng-template",5),e.YNc(6,U,5,2,"ng-template",6),e.YNc(7,E,7,2,"ng-template",7),e.qZA(),e._UZ(8,"hr"),e.TgZ(9,"div",8)(10,"div",9)(11,"span",10)(12,"button",11),e.NdJ("click",function(){return i.saveAsignacion()}),e.qZA()()()()()()()),2&t&&(e.xp6(3),e.Q6J("value",i.data)("columns",i.cols)("rows",10)("globalFilterFields",i.cols)("rows",10)("paginator",!0)("loading",i.isLoadingTable)("rowsPerPageOptions",e.DdM(13,x))("showCurrentPageReport",!0)("selection",i.selectedData)("rowHover",!0),e.xp6(9),e.Q6J("loading",i.guardando)("label","Guardar"))},dependencies:[g.sg,c.Wl,c.JJ,c.On,m.iA,u.jx,m.lQ,m.fz,h.Hq,v.H,f.o],styles:[".rowStyle[_ngcontent-%COMP%]{width:14%;min-width:10rem}.rowStyleId[_ngcontent-%COMP%]{width:10%;min-width:6rem}"]})),o})();function G(o,r){1&o&&(e.TgZ(0,"div",23)(1,"h3",24),e._uU(2,"Listado de compa\xf1\xedas"),e.qZA()())}function R(o,r){if(1&o){const t=e.EpF();e._UZ(0,"p-fileUpload",25),e.TgZ(1,"button",26),e.NdJ("click",function(){e.CHM(t),e.oxw();const n=e.MAs(8);return e.KtG(n.exportCSV())}),e.qZA()}2&o&&e.Q6J("maxFileSize",1e6)}function O(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"div",27)(1,"span",28)(2,"input",29),e.NdJ("input",function(n){e.CHM(t);const l=e.oxw(),d=e.MAs(8);return e.KtG(l.onGlobalFilter(d,n))}),e.qZA(),e.TgZ(3,"button",30),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.getData())}),e.qZA(),e.TgZ(4,"button",31),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.openNew())}),e.qZA(),e.TgZ(5,"button",32),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.deleteSelectedItems())}),e.qZA()()()}if(2&o){const t=e.oxw();e.xp6(5),e.Q6J("disabled",!t.selectedData||!t.selectedData.length)}}function Q(o,r){if(1&o&&(e.TgZ(0,"th",35),e._uU(1),e._UZ(2,"p-sortIcon",36),e.qZA()),2&o){const t=r.$implicit;e.ekj("rowStyle","ID"!==t.header)("rowStyleId","ID"===t.header),e.Q6J("pSortableColumn",t.field),e.xp6(1),e.hij(" ",t.header," "),e.xp6(1),e.Q6J("field",t.field)}}function L(o,r){if(1&o&&(e.TgZ(0,"tr")(1,"th",33),e._UZ(2,"p-tableHeaderCheckbox"),e.qZA(),e.TgZ(3,"th"),e._uU(4,"Acciones"),e.qZA(),e.YNc(5,Q,3,7,"th",34),e.qZA()),2&o){const t=e.oxw();e.xp6(5),e.Q6J("ngForOf",t.cols)}}function j(o,r){if(1&o&&(e.TgZ(0,"td")(1,"span",43),e._uU(2),e.qZA(),e._uU(3),e.qZA()),2&o){const t=r.$implicit,i=e.oxw().$implicit;e.xp6(2),e.Oqu(t.header),e.xp6(1),e.hij(" ",i[t.field]," ")}}function P(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"tr")(1,"td"),e._UZ(2,"p-tableCheckbox",37),e.qZA(),e.TgZ(3,"td")(4,"div",38)(5,"button",39),e.NdJ("click",function(){const l=e.CHM(t).$implicit,d=e.oxw();return e.KtG(d.editRow(l))}),e.qZA(),e.TgZ(6,"button",40),e.NdJ("click",function(){const l=e.CHM(t).$implicit,d=e.oxw();return e.KtG(d.mostrarModal(l))}),e.qZA(),e.TgZ(7,"button",41),e.NdJ("click",function(){const l=e.CHM(t).$implicit,d=e.oxw();return e.KtG(d.deleteRow(l))}),e.qZA()()(),e.YNc(8,j,4,2,"td",42),e.qZA()}if(2&o){const t=r.$implicit,i=e.oxw();e.xp6(2),e.Q6J("value",t),e.xp6(6),e.Q6J("ngForOf",i.cols)}}function Y(o,r){if(1&o&&(e.TgZ(0,"span"),e._uU(1,"Estas seguro que quieres eliminar "),e.TgZ(2,"b"),e._uU(3),e.qZA(),e._uU(4,"?"),e.qZA()),2&o){const t=e.oxw();e.xp6(3),e.Oqu(t.item.cia_vnombre)}}function K(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"button",44),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.deleteItemDialog=!1)}),e.qZA(),e.TgZ(1,"button",45),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.confirmDelete())}),e.qZA()}}function V(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"button",44),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.deleteItemsDialog=!1)}),e.qZA(),e.TgZ(1,"button",45),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.confirmDeleteSelected())}),e.qZA()}}const z=function(){return[10,20,30]},b=function(){return{width:"750px"}},A=function(){return{width:"450px"}};let $=(()=>{class o{constructor(t,i){(0,a.Z)(this,"dbapi",void 0),(0,a.Z)(this,"messageService",void 0),(0,a.Z)(this,"createDialog",!1),(0,a.Z)(this,"editDialog",!1),(0,a.Z)(this,"asigModulosDialog",!1),(0,a.Z)(this,"deleteItemDialog",!1),(0,a.Z)(this,"deleteItemsDialog",!1),(0,a.Z)(this,"isLoadingTable",!1),(0,a.Z)(this,"data",[]),(0,a.Z)(this,"item",{}),(0,a.Z)(this,"itemAsigModulos",{}),(0,a.Z)(this,"selectedData",[]),(0,a.Z)(this,"submitted",!1),(0,a.Z)(this,"cols",[]),(0,a.Z)(this,"statuses",[]),(0,a.Z)(this,"rowsPerPageOptions",[5,10,20]),this.dbapi=t,this.messageService=i,this.cols=[{field:"cia_nid",header:"ID"},{field:"cia_vnombre",header:"Nombre"},{field:"cia_vnombrecomercial",header:"Comercial"},{field:"cia_vdireccion",header:"Direcci\xf3n"},{field:"cia_vtelefono",header:"Tel\xe9fono"},{field:"cia_vrtn",header:"RTN"},{field:"cia_vcorreo",header:"Correo"},{field:"mone_vnombre",header:"Moneda"},{field:"cia_vsts",header:"Estado"}],this.getData()}mostrarModal(t){this.itemAsigModulos={...t},this.asigModulosDialog=!0}getData(){this.isLoadingTable=!0,this.dbapi.getAll().pipe((0,T.U)(t=>(t.forEach(i=>{i.mone_vnombre=i.mones?i.mones.mone_vnombre:"",i.cia_vsts=1==i.cia_nsts?"ACTIVO":"ELIMINADO"}),t)),(0,p.q)(1)).subscribe({next:t=>{this.data=[...t],this.isLoadingTable=!1},error:t=>{console.log(t),this.isLoadingTable=!1,this.editEvent({type:"error",title:"Ha ocurrido un error",message:t})}})}ngOnInit(){}openNew(){this.item={},this.submitted=!1,this.createDialog=!0}deleteSelectedData(){this.deleteItemsDialog=!0}editRow(t){this.item={...t},this.editDialog=!0}deleteRow(t){this.deleteItemDialog=!0,this.item={...t}}confirmDeleteSelected(){const t=[];this.selectedData.forEach(i=>{t.push({cia_nid:i.cia_nid,cia_nsts:0})}),this.dbapi.setBulkSts(t).pipe((0,p.q)(1)).subscribe({next:i=>{this.messageService.add({severity:i.type,summary:i.title,detail:i.message,life:3e3}),"success"==i.type&&(this.deleteItemsDialog=!1,this.selectedData=[],this.getData())},error:i=>{console.log(i),this.editEvent({type:"error",title:"Ha ocurrido un error",message:i})}})}confirmDelete(){this.dbapi.setSts({cia_nid:this.item.cia_nid,cia_nsts:0}).pipe((0,p.q)(1)).subscribe({next:i=>{this.messageService.add({severity:i.type,summary:i.title,detail:i.message,life:3e3}),this.deleteItemDialog=!1,this.item={},this.getData()},error:i=>{console.log(i),this.editEvent({type:"error",title:"Ha ocurrido un error",message:i})}})}findIndexById(t){let i=-1;for(let n=0;n<this.data.length;n++)if(this.data[n].cia_nid===t){i=n;break}return i}onGlobalFilter(t,i){t.filterGlobal(i.target.value,"contains")}deleteSelectedItems(){this.deleteItemsDialog=!0}editEvent(t){this.messageService.add({severity:t.type,summary:t.title,detail:t.message,life:3e3}),"success"==t.type&&(this.getData(),this.createDialog=!1,this.editDialog=!1,this.asigModulosDialog=!1)}}return(0,a.Z)(o,"\u0275fac",function(t){return new(t||o)(e.Y36(_),e.Y36(u.ez))}),(0,a.Z)(o,"\u0275cmp",e.Xpm({type:o,selectors:[["ng-component"]],features:[e._Bn([u.ez])],decls:29,vars:40,consts:[[1,"grid"],[1,"col-12"],[1,"card","px-6","py-6"],["position","bottom-right"],["styleClass","mb-4"],["pTemplate","left"],["pTemplate","right"],["responsiveLayout","scroll","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries","selectionMode","multiple","dataKey","cia_nid",3,"value","columns","rows","globalFilterFields","paginator","loading","rowsPerPageOptions","showCurrentPageReport","selection","rowHover","selectionChange"],["dt",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["header","Crear compa\xf1\xeda",1,"p-fluid",3,"visible","modal","visibleChange"],[3,"edit"],["header","Editar compa\xf1\xeda",1,"p-fluid",3,"visible","modal","visibleChange"],[3,"compania","edit"],["header","Asignar modulos",1,"p-fluid",3,"visible","modal","visibleChange"],["header","Confirmar...",3,"visible","modal","visibleChange"],[1,"flex","align-items-center","justify-content-center"],[1,"pi","pi-exclamation-triangle","mr-3",2,"font-size","2rem"],[4,"ngIf"],["pTemplate","footer"],["header","Confirmar",3,"visible","modal","visibleChange"],[1,"my-2"],[1,"mb-2"],["mode","basic","accept","image/*","label","Import","chooseLabel","Import",1,"mr-2","inline-block",3,"maxFileSize"],["pButton","","pRipple","","label","Export","icon","pi pi-upload",1,"p-button-help",3,"click"],[1,"flex","flex-column","md:flex-row","md:justify-content-between","md:align-items-center"],[1,"block","mt-2","md:mt-0","p-input-icon-rigth"],["pInputText","","type","text","placeholder","Buscar...",1,"w-full","sm:w-auto","mr-1",3,"input"],["pButton","","pRipple","","label","","icon","pi pi-sync",1,"p-button-secondary","mr-1","ml-1",3,"click"],["pButton","","pRipple","","label","Crear","icon","pi pi-plus",1,"p-button-success","mr-1","ml-1",3,"click"],["pButton","","pRipple","","label","Eliminar","icon","pi pi-trash",1,"p-button-danger","mr-1","ml-1",3,"disabled","click"],[2,"width","3rem"],[3,"pSortableColumn","rowStyle","rowStyleId",4,"ngFor","ngForOf"],[3,"pSortableColumn"],[3,"field"],[3,"value"],[1,"flex"],["pButton","","title","Editar","pRipple","","icon","pi pi-pencil",1,"p-button-success","mr-1",3,"click"],["pButton","","title","Asignar m\xf3dulos","pRipple","","icon","pi pi-box",1,"p-button-info","mr-1",3,"click"],["pButton","","title","Eliminar","pRipple","","icon","pi pi-trash",1,"p-button-danger",3,"click"],[4,"ngFor","ngForOf"],[1,"p-column-title"],["pButton","","pRipple","","icon","pi pi-times","label","No",1,"p-button-outlined","p-button-secondary",3,"click"],["pButton","","pRipple","","icon","pi pi-check","label","Si",1,"p-button-outlined","p-button-danger",3,"click"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e._UZ(3,"p-toast",3),e.TgZ(4,"p-toolbar",4),e.YNc(5,G,3,0,"ng-template",5),e.YNc(6,R,2,1,"ng-template",6),e.qZA(),e.TgZ(7,"p-table",7,8),e.NdJ("selectionChange",function(l){return i.selectedData=l}),e.YNc(9,O,6,1,"ng-template",9),e.YNc(10,L,6,1,"ng-template",10),e.YNc(11,P,9,2,"ng-template",11),e.qZA()(),e.TgZ(12,"p-dialog",12),e.NdJ("visibleChange",function(l){return i.createDialog=l}),e.TgZ(13,"app-create-companias",13),e.NdJ("edit",function(l){return i.editEvent(l)}),e.qZA()(),e.TgZ(14,"p-dialog",14),e.NdJ("visibleChange",function(l){return i.editDialog=l}),e.TgZ(15,"app-create-companias",15),e.NdJ("edit",function(l){return i.editEvent(l)}),e.qZA()(),e.TgZ(16,"p-dialog",16),e.NdJ("visibleChange",function(l){return i.asigModulosDialog=l}),e.TgZ(17,"app-asig-modulos-companias",15),e.NdJ("edit",function(l){return i.editEvent(l)}),e.qZA()(),e.TgZ(18,"p-dialog",17),e.NdJ("visibleChange",function(l){return i.deleteItemDialog=l}),e.TgZ(19,"div",18),e._UZ(20,"i",19),e.YNc(21,Y,5,1,"span",20),e.qZA(),e.YNc(22,K,2,0,"ng-template",21),e.qZA(),e.TgZ(23,"p-dialog",22),e.NdJ("visibleChange",function(l){return i.deleteItemsDialog=l}),e.TgZ(24,"div",18),e._UZ(25,"i",19),e.TgZ(26,"span"),e._uU(27,"\xbfEst\xe1 seguro de que desea eliminar los elementos seleccionados?"),e.qZA()(),e.YNc(28,V,2,0,"ng-template",21),e.qZA()()()),2&t&&(e.xp6(7),e.Q6J("value",i.data)("columns",i.cols)("rows",10)("globalFilterFields",i.cols)("rows",10)("paginator",!0)("loading",i.isLoadingTable)("rowsPerPageOptions",e.DdM(34,z))("showCurrentPageReport",!0)("selection",i.selectedData)("rowHover",!0),e.xp6(5),e.Akn(e.DdM(35,b)),e.Q6J("visible",i.createDialog)("modal",!0),e.xp6(2),e.Akn(e.DdM(36,b)),e.Q6J("visible",i.editDialog)("modal",!0),e.xp6(1),e.Q6J("compania",i.item),e.xp6(1),e.Akn(e.DdM(37,b)),e.Q6J("visible",i.asigModulosDialog)("modal",!0),e.xp6(1),e.Q6J("compania",i.itemAsigModulos),e.xp6(1),e.Akn(e.DdM(38,A)),e.Q6J("visible",i.deleteItemDialog)("modal",!0),e.xp6(3),e.Q6J("ngIf",i.item),e.xp6(2),e.Akn(e.DdM(39,A)),e.Q6J("visible",i.deleteItemsDialog)("modal",!0))},dependencies:[g.sg,g.O5,m.iA,u.jx,m.lQ,m.fz,m.UA,m.Mo,k.p,h.Hq,v.H,D.FN,q.o,f.o,F.V,I,B],styles:[".rowStyle[_ngcontent-%COMP%]{width:14%;min-width:10rem}.rowStyleId[_ngcontent-%COMP%]{width:10%;min-width:6rem}"]})),o})();var X=s(7246);const W=[{path:"",component:$}];let ee=(()=>{class o{}return(0,a.Z)(o,"\u0275fac",function(t){return new(t||o)}),(0,a.Z)(o,"\u0275mod",e.oAB({type:o})),(0,a.Z)(o,"\u0275inj",e.cJS({imports:[X.m,Z.Bz.forChild(W)]})),o})()}}]);